"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[728,917],{3918:function(e,t,n){n.d(t,{a:function(){return v}});var a=n(1436),l=n(7814),r=n(7294),i=n(7977),s=n(5147),o=n(5293),c=n(3489),m=n(4012),u=n(8509),d=n(8425),p=n(5855),E=n(9905);function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},h.apply(this,arguments)}let v;!function(e){e[e.CompileJobs=0]="CompileJobs",e[e.Watchdog=1]="Watchdog"}(v||(v={}));class g extends r.Component{constructor(e){super(e),this.state={openTestMergesId:null}}render(){return r.createElement("div",null,r.createElement(d.t,{obj:this.props.viewData}),r.createElement("h3",{className:"text-center"},r.createElement(m.Z,{id:"view.instance.server.deployment_info"})),this.props.viewData?this.renderViewData(this.props.viewData):r.createElement(p.Z,{text:"loading.compile_jobs"}))}renderViewData(e){let t,n=!1;const a=e,l=e;switch(e.viewDataType){case v.Watchdog:n=!a.activeCompileJob,t=()=>this.renderWatchdog(a);break;case v.CompileJobs:n=!!l.compileJobs&&0===l.compileJobs.length,t=()=>this.renderDeployments(l);break;default:throw new Error("Invalid enum value for ViewDataType!")}return n?r.createElement("h1",null,r.createElement(i.Z,{variant:"warning"},r.createElement(m.Z,{id:"view.utils.deployment_viewer.no_jobs"}))):t()}renderTable(e){return r.createElement(s.Z,{className:"table table-hover"},r.createElement("thead",null,r.createElement("th",null),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.id"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.byond"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.started_at"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.completed_at"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.started_by"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.project"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.revision"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.origin"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.security"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.dmapi"}))),r.createElement("tbody",null,e))}renderWatchdog(e){return this.renderTable(r.createElement(r.Fragment,null,r.createElement("tr",null,r.createElement("td",{colSpan:11},r.createElement("h3",null,r.createElement(i.Z,{pill:!0,variant:"success"},r.createElement(m.Z,{id:"view.instance.server.deployment_info.active"}))))),this.renderCompileJob(e.activeCompileJob),e.stagedCompileJob?r.createElement(r.Fragment,null,r.createElement("tr",null,r.createElement("td",{colSpan:11},r.createElement("h3",null,r.createElement(i.Z,{pill:!0,variant:"warning"},r.createElement(m.Z,{id:"view.instance.server.deployment_info.staged"}))))),this.renderCompileJob(e.stagedCompileJob)):r.createElement(r.Fragment,null)))}renderDeployments(e){return r.createElement(r.Fragment,null,this.renderTable(r.createElement(r.Fragment,null,e.compileJobs.map((e=>this.renderCompileJob(e))))),r.createElement(E.Z,{className:"mt-4",selectPage:t=>{e.paging.loadPage(t)},totalPages:e.paging.totalPages,currentPage:e.paging.currentPage}))}renderCompileJob(e){let t=e.byondVersion;t.endsWith(".0")&&(t=t.substring(0,t.length-2));const n={day:"2-digit",year:"numeric",month:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1,timeZoneName:"short"},i=e.revisionInformation.activeTestMerges&&e.revisionInformation.activeTestMerges.length>0,d=this.state.openTestMergesId===e.id;return r.createElement(r.Fragment,null,r.createElement("tr",{className:"nowrap",onClick:()=>{d?this.setState({openTestMergesId:null}):i&&this.setState({openTestMergesId:e.id})}},r.createElement("td",null,i?r.createElement("h5",null,r.createElement(o.Z,{overlay:r.createElement(c.Z,{id:`${e.id}-tooltip-test-merges`},r.createElement(m.Z,{id:"view.utils.deployment_viewer.test_merges_hint."+(d?"hide":"show")}))},(({ref:e,...t})=>r.createElement("span",h({ref:e},t),r.createElement(l.G,{icon:d?a.eW2:a.I4f}))))):r.createElement(r.Fragment,null)),r.createElement("td",null,e.id),r.createElement("td",null,t),r.createElement("td",null,new Date(e.job.startedAt).toLocaleString("en-CA",n)),r.createElement("td",null,new Date(e.job.stoppedAt).toLocaleString("en-CA",n)),r.createElement("td",null,e.job.startedBy.name),r.createElement("td",null,e.dmeName),r.createElement("td",null,e.revisionInformation.commitSha.substring(0,7)),r.createElement("td",null,e.revisionInformation.originCommitSha.substring(0,7)),r.createElement("td",null,null!=e.minimumSecurityLevel?Object.keys(u.ns).filter((e=>isNaN(Number(e))))[e.minimumSecurityLevel]:r.createElement("i",null,r.createElement(m.Z,{id:"generic.not_applicable"}))),r.createElement("td",null,e.dmApiVersion)),d?r.createElement("tr",null,r.createElement("td",{colSpan:10},r.createElement(s.Z,null,r.createElement("thead",null,r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.pr.number"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.pr.title"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.revision"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.pr.merged_by"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.pr.merged_at"})),r.createElement("th",null,r.createElement(m.Z,{id:"view.utils.deployment_viewer.table.pr.comment"}))),r.createElement("tbody",null,e.revisionInformation.activeTestMerges.map((t=>r.createElement("tr",{key:`test-merge-#${t.number}-cj-${e.id}`},r.createElement("td",null,r.createElement("a",{href:t.url},"#",t.number)),r.createElement("td",null,r.createElement("a",{href:t.url},t.titleAtMerge)),r.createElement("td",null,t.targetCommitSha.substring(0,7)),r.createElement("td",null,t.mergedBy.name),r.createElement("td",null,new Date(t.mergedAt).toLocaleString("en-CA",n)),r.createElement("td",null,t.comment?t.comment:r.createElement("i",null,r.createElement(m.Z,{id:"generic.not_applicable"})))))))))):r.createElement(r.Fragment,null))}}t.Z=g},9049:function(e,t,n){n.d(t,{fS:function(){return p},Pg:function(){return b},ZP:function(){return y}});var a=n(1436),l=n(7814),r=n(7294),i=n(5005),s=n(2258),o=n(2318),c=n(5293),m=n(3489),u=n(4012);function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},d.apply(this,arguments)}let p;!function(e){e.Boolean="boolean",e.Number="number",e.String="string",e.Password="password",e.Enum="enum"}(p||(p={}));const E=r.forwardRef((function(e,t){return r.createElement(s.Z.Control,{value:e.value,onChange:t=>e.onChange(t.target.value),disabled:e.disabled,ref:t})})),h=r.forwardRef((function(e,t){return r.createElement(s.Z.Control,{value:e.value,onChange:t=>e.onChange(t.target.value),disabled:e.disabled,type:"password",ref:t})})),v=r.forwardRef((function(e,t){const n=Math.random().toString();return r.createElement("label",{htmlFor:n,className:"d-flex m-0 flex-grow-1 justify-content-center align-content-center"},r.createElement(s.Z.Check,{id:n,checked:e.value,onChange:t=>e.onChange(t.target.checked),type:"switch",className:"m-auto",disabled:e.disabled,ref:t}))})),g=r.forwardRef((function(e,t){return r.createElement(s.Z.Control,{value:e.value,onChange:t=>e.onChange(isNaN(t.target.valueAsNumber)?t.target.value:t.target.valueAsNumber),disabled:e.disabled,min:e.min,max:e.max,type:"number",ref:t})})),f=r.forwardRef((function(e,t){return r.createElement(s.Z.Control,{value:e.value,onChange:t=>e.onChange(parseInt(t.target.value)),disabled:e.disabled,as:"select",custom:!0,ref:t},Object.entries(e.enum).filter((([e])=>isNaN(parseInt(e)))).map((([t,n])=>e.noLocalize?r.createElement("option",{key:n,value:n},t):r.createElement(u.Z,{id:`${e.name}.${t}`,key:t},(e=>r.createElement("option",{key:n,value:n},e))))))})),b={[p.Enum]:0,[p.Number]:0,[p.Boolean]:!1,[p.String]:"",[p.Password]:""};function y(e){const[t,n]=(0,r.useState)(e.defaultValue??b[e.type]),s=(0,r.useRef)(null);(0,r.useEffect)((()=>{n(e.defaultValue??b[e.type])}),[e.defaultValue]),(0,r.useEffect)((()=>{switch(s.current&&(s.current.checkValidity()?s.current.classList.remove("is-invalid"):s.current.classList.add("is-invalid")),e.type){case p.Boolean:case p.Enum:case p.Number:case p.String:case p.Password:return void e.onChange(t,s.current?.checkValidity()??!0)}}),[t]);const y={string:E,password:h,boolean:v,[p.Number]:void 0,[p.Enum]:void 0},w=t!=(e.defaultValue??b[e.type]);return r.createElement(o.Z,null,r.createElement(c.Z,{overlay:(Z=e.tooltip,Z?r.createElement(m.Z,{id:Z},r.createElement(u.Z,{id:Z})):r.createElement(r.Fragment,null)),show:!!e.tooltip&&void 0},(({ref:t,...n})=>r.createElement(o.Z.Prepend,{className:"w-50 w-xl-40"},r.createElement(o.Z.Text,d({className:"flex-grow-1"},n),r.createElement("span",{className:w?"font-weight-bold":""},r.createElement(u.Z,{id:e.name})),r.createElement("div",{className:"ml-auto"},e.disabled?r.createElement(u.Z,{id:"generic.readonly"}):null,r.createElement("div",{ref:t,className:"d-inline-block ml-2",style:{visibility:e.tooltip?"unset":"hidden"}},r.createElement(l.G,{icon:a.YHc}))))))),e.type===p.Number?r.createElement(g,{value:t,onChange:e=>n(e),name:e.name,disabled:e.disabled,max:e.max,min:e.min,ref:s}):e.type===p.Enum?r.createElement(f,{value:t,onChange:e=>n(e),name:e.name,enum:e.enum,noLocalize:e.noLocalize,disabled:e.disabled}):r.createElement(y[e.type],{value:t,onChange:e=>n(e),disabled:e.disabled,name:e.type,ref:s}),r.createElement(o.Z.Append,null,r.createElement(i.Z,{style:{visibility:!w||e.disabled?"hidden":void 0},variant:"danger",onClick:()=>n(e.defaultValue??b[e.type])},r.createElement(l.G,{icon:"undo"}))));var Z}},5619:function(e,t,n){n.d(t,{Z:function(){return m}});var a=n(7294),l=n(5005),r=n(5293),i=n(3489),s=n(4012),o=n(9049);function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c.apply(this,arguments)}function m(e){const t=new Map,n=new Map,[m,u]=(0,a.useState)({});(0,a.useEffect)((()=>{Object.keys(e.fields).forEach((e=>{u((t=>({...t,[e]:{}})))}))}),[]);for(const[l,r]of Object.entries(e.fields))n.set(l,r),t.set(r,(0,a.useState)(r.defaultValue??o.Pg[r.type]));let d=!1,p=!1;for(const[e,a]of n){const[n]=t.get(a),l=m[e];if((a.defaultValue??o.Pg[a.type])!=n&&(d=!0),l?.invalid&&(p=!0),d&&p)break}return e.hideDisabled&&!Object.values(e.fields).some((e=>!e.disabled))?a.createElement(a.Fragment,null):a.createElement("div",null,Object.entries(e.fields).map((([n,l])=>{const{disabled:r,...i}=l;return e.hideDisabled&&r?null:a.createElement(o.ZP,c({key:n},i,{disabled:e.readOnly||r,onChange:(e,a)=>{t.get(l)[1](e),u((e=>({...e,[n]:{...e[n],invalid:!a}})))}}))})),a.createElement("div",{className:"text-center mt-2"},a.createElement(r.Z,{overlay:a.createElement(i.Z,{id:"form-invalid"},a.createElement(s.Z,{id:"generic.invalid_form"})),show:!!p&&void 0},a.createElement(l.Z,{variant:e.readOnly||p?"danger":"success",disabled:e.readOnly||!d||p,onClick:()=>{const a={};for(const[l,r]of n){const[n]=t.get(r);(r.alwaysInclude||n!=(r.defaultValue??o.Pg[r.type])||e.includeAll)&&(a[l]=n)}e.onSave(a)}},a.createElement(s.Z,{id:e.saveMessageId??"generic.save"})))))}},8425:function(e,t,n){n.d(t,{t:function(){return o}});var a=n(7294),l=n(5171),r=n.n(l),i=n(7961);function s(e){return a.createElement(r(),{src:e.obj,name:"JSON",theme:"tube",iconStyle:"triangle",collapsed:!0,displayDataTypes:!1})}function o(e){return i.ZP.showjson.value?a.createElement("div",{className:"text-left"},a.createElement(s,{obj:e.obj})):a.createElement(a.Fragment,null)}},9905:function(e,t,n){n.d(t,{Z:function(){return T}});var a=n(7814),l=n(7294),r=n(5005),i=n(2258),s=n(5293),o=n(7462),c=n(3366),m=n(4184),u=n.n(m),d=n(6792),p=n(8358),E=["active","disabled","className","style","activeLabel","children"],h=["children"],v=l.forwardRef((function(e,t){var n=e.active,a=e.disabled,r=e.className,i=e.style,s=e.activeLabel,m=e.children,d=(0,c.Z)(e,E),h=n||a?"span":p.Z;return l.createElement("li",{ref:t,style:i,className:u()(r,"page-item",{active:n,disabled:a})},l.createElement(h,(0,o.Z)({className:"page-link",disabled:a},d),m,n&&s&&l.createElement("span",{className:"sr-only"},s)))}));v.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},v.displayName="PageItem";var g=v;function f(e,t,n){function a(e){var a=e.children,r=(0,c.Z)(e,h);return l.createElement(v,r,l.createElement("span",{"aria-hidden":"true"},a||t),l.createElement("span",{className:"sr-only"},n))}return void 0===n&&(n=e),a.displayName=e,a}var b=f("First","\xab"),y=f("Prev","\u2039","Previous"),w=f("Ellipsis","\u2026","More"),Z=f("Next","\u203a"),P=f("Last","\xbb"),N=["bsPrefix","className","children","size"],C=l.forwardRef((function(e,t){var n=e.bsPrefix,a=e.className,r=e.children,i=e.size,s=(0,c.Z)(e,N),m=(0,d.vE)(n,"pagination");return l.createElement("ul",(0,o.Z)({ref:t},s,{className:u()(a,m,i&&m+"-"+i)}),r)}));C.First=b,C.Prev=y,C.Ellipsis=w,C.Item=g,C.Next=Z,C.Last=P;var _=C,x=(n(5638),["as","bsPrefix","className","children"]),k=l.forwardRef((function(e,t){var n=e.as,a=void 0===n?"div":n,r=e.bsPrefix,i=e.className,s=e.children,m=(0,c.Z)(e,x);return r=(0,d.vE)(r,"popover-header"),l.createElement(a,(0,o.Z)({ref:t},m,{className:u()(r,i)}),s)})),j=["as","bsPrefix","className","children"],S=l.forwardRef((function(e,t){var n=e.as,a=void 0===n?"div":n,r=e.bsPrefix,i=e.className,s=e.children,m=(0,c.Z)(e,j);return r=(0,d.vE)(r,"popover-body"),l.createElement(a,(0,o.Z)({ref:t},m,{className:u()(i,r)}),s)})),I=["bsPrefix","placement","className","style","children","content","arrowProps","popper","show"],O=l.forwardRef((function(e,t){var n=e.bsPrefix,a=e.placement,r=e.className,i=e.style,s=e.children,m=e.content,p=e.arrowProps,E=(e.popper,e.show,(0,c.Z)(e,I)),h=(0,d.vE)(n,"popover"),v=((null==a?void 0:a.split("-"))||[])[0];return l.createElement("div",(0,o.Z)({ref:t,role:"tooltip",style:i,"x-placement":v,className:u()(r,h,v&&"bs-popover-"+v)},E),l.createElement("div",(0,o.Z)({className:"arrow"},p)),m?l.createElement(S,null,s):s)}));O.defaultProps={placement:"right"},O.Title=k,O.Content=S;var M=O,V=n(4012);function D(){return D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},D.apply(this,arguments)}class T extends l.PureComponent{constructor(e){super(e),this.state={showGoto:!1,gotoValue:e.currentPage}}render(){const e=[],t=Math.max(this.props.totalPages-this.props.currentPage-1,0),n=Math.max(this.props.currentPage-2,0),o=Math.max(this.props.currentPage-Math.max(5-Number(this.props.currentPage!==this.props.totalPages)-t,2),2),c=Math.min(this.props.currentPage+Math.max(5-Number(1!==this.props.currentPage)-n,2),this.props.totalPages-1);for(let t=o;t<=c;t++)e.push(l.createElement(_.Item,{key:t,active:t===this.props.currentPage,onClick:()=>this.props.selectPage(t)},t));const m=this.props.totalPages>7?l.createElement(_.Ellipsis,{disabled:!0}):null,u=l.createElement(M,{id:"popover-gotopage"},l.createElement(M.Title,null,l.createElement(V.Z,{id:"generic.goto.title"})),l.createElement(M.Content,null,l.createElement("form",{className:"d-flex",onSubmit:e=>{e.preventDefault(),this.props.selectPage(this.state.gotoValue),this.setState({showGoto:!1})}},l.createElement(i.Z.Control,{className:"mr-2",type:"number",min:1,max:this.props.totalPages,value:this.state.gotoValue,onChange:e=>this.setState({gotoValue:parseInt(e.target.value)}),custom:!0}),l.createElement(r.Z,{type:"submit"},l.createElement(V.Z,{id:"generic.goto"}))))),{selectPage:d,totalPages:p,currentPage:E,...h}=this.props;return l.createElement("div",D({className:"text-center",style:{position:"sticky",bottom:"1.5em"}},h),l.createElement(_,{className:"justify-content-center"},l.createElement(_.Prev,{disabled:this.props.currentPage<=1,onClick:()=>this.props.selectPage(Math.max(this.props.currentPage-1,1))}),l.createElement(_.Item,{active:this.props.currentPage<=1,onClick:()=>this.props.selectPage(1)},"1"),m,e,m,this.props.totalPages>=2?l.createElement(_.Item,{active:this.props.currentPage>=this.props.totalPages,onClick:()=>this.props.selectPage(this.props.totalPages)},this.props.totalPages):null,this.props.totalPages>7?l.createElement(s.Z,{show:this.state.showGoto,placement:"top",overlay:u},l.createElement(_.Item,{onClick:()=>this.setState((e=>({showGoto:!e.showGoto})))},l.createElement(a.G,{icon:"search"}))):null,l.createElement(_.Next,{disabled:this.props.currentPage>=this.props.totalPages,onClick:()=>this.props.selectPage(Math.min(this.props.currentPage+1,this.props.totalPages))})))}}},6190:function(e,t,n){n.d(t,{g:function(){return a}});const a=n(7294).createContext(void 0)}}]);
//# sourceMappingURL=728.93d4d79f5c86d30a69d2.bundle.js.map