"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[182],{161:function(e,t,a){a.r(t);var n=a(7814),s=a(7294),i=a(5005),r=a(2258),o=a(4716),l=a(2318),c=a(5293),d=a(3489),m=a(4012),u=a(6222),p=a(8509),h=a(6846),f=a(3803),S=a(6190),y=a(6964),g=a(1320),v=a(3e3),E=a(9635),b=a(8425),w=a(5855),Z=a(9929);function x(){return x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},x.apply(this,arguments)}class P extends s.Component{constructor(e){super(e),this.state={versions:[],errors:[],activeVersion:"",latestVersion:"",selectedVersion:"",loading:!0,page:g.Mq.byondlistpage??1}}addError(e){this.setState((t=>{const a=Array.from(t.errors);return a.push(e),{errors:a}}))}async loadVersions(){if((0,y.n5)(this.context.instancePermissionSet,p.D8.ListInstalled)){const e=await u.Z.listAllVersions(this.context.instance.id,{page:this.state.page});if(e.code===f.G.OK){if(this.state.page>e.payload.totalPages&&0!==e.payload.totalPages)return void this.setState({page:1});this.setState({versions:e.payload.content,maxPage:e.payload.totalPages})}else this.addError(e.error)}if((0,y.n5)(this.context.instancePermissionSet,p.D8.ReadActive)){const e=await u.Z.getActiveVersion(this.context.instance.id);e.code===f.G.OK?this.setState({activeVersion:e.payload.version}):this.addError(e.error)}}async componentDidUpdate(e,t){t.page!==this.state.page&&(g.Mq.byondlistpage=this.state.page,await this.loadVersions())}async componentDidMount(){await this.loadVersions(),fetch("https://secure.byond.com/download/version.txt").then((e=>e.text())).then((e=>e.split("\n"))).then((e=>e[0])).then((e=>{this.setState({latestVersion:e,selectedVersion:e,loading:!1})})).catch((e=>{this.addError(new h.ZP(h.jK.APP_FAIL,{jsError:Error(e)})),this.setState({loading:!1})}))}render(){if(this.state.loading)return s.createElement(w.Z,{text:"loading.byond"});const e=(0,y.n5)(this.context.instancePermissionSet,p.D8.ListInstalled),t=(0,y.n5)(this.context.instancePermissionSet,p.D8.ReadActive),a=(0,y.n5)(this.context.instancePermissionSet,p.D8.InstallCustomVersion),h=(0,y.n5)(this.context.instancePermissionSet,p.D8.InstallOfficialOrChangeActiveVersion),S=e=>e?s.createElement(d.Z,{id:e},s.createElement(m.Z,{id:e})):s.createElement(s.Fragment,null);return s.createElement("div",{className:"text-center"},s.createElement(b.t,{obj:this.state.versions}),s.createElement("h1",null,s.createElement(m.Z,{id:"view.instance.byond"})),this.state.errors.map(((e,t)=>{if(e)return s.createElement(v.ZP,{key:t,error:e,onClose:()=>this.setState((e=>{const a=Array.from(e.errors);return a[t]=void 0,{errors:a}}))})})),e?s.createElement(s.Fragment,null,t?null:s.createElement(E.Z,{title:"view.instance.byond.current_denied"}),s.createElement("div",{onChange:async e=>{this.setState({loading:!0});const t=await u.Z.switchActive(this.context.instance.id,e.target.value);t.code===f.G.OK?await this.loadVersions():this.addError(t.error),this.setState({loading:!1})}},this.state.versions.map((e=>s.createElement(l.Z,{className:"w-md-25 mb-1 mx-auto d-flex",key:e.version},h||t?s.createElement(l.Z.Prepend,null,s.createElement(l.Z.Radio,{name:"byond",id:e.version,value:e.version,disabled:!h,defaultChecked:e.version===this.state.activeVersion})):null,s.createElement("label",{className:"flex-grow-1 m-0",htmlFor:e.version},s.createElement(c.Z,{overlay:S("view.instance.byond.custom"),show:!e.version.endsWith(".0")&&void 0},(({ref:t,...a})=>s.createElement(l.Z.Text,x({className:"w-100"},a),e.version.endsWith(".0")?e.version.substr(0,e.version.length-2):e.version,e.version.endsWith(".0")?null:s.createElement("div",{className:"ml-auto",ref:t},s.createElement(n.G,{fixedWidth:!0,icon:"info"})))))))))),s.createElement(Z.Z,{className:"mt-4",selectPage:e=>this.setState({page:e}),totalPages:this.state.maxPage??1,currentPage:this.state.page})):t?s.createElement(s.Fragment,null,s.createElement(E.Z,{title:"view.instance.byond.list_denied"}),s.createElement(m.Z,{id:"view.instance.byond.current_version",values:{version:this.state.activeVersion}})):s.createElement(E.Z,{title:"view.instance.byond.current_and_list_denied"}),s.createElement("hr",null),s.createElement("h4",null,s.createElement(m.Z,{id:"view.instance.byond.add"})),s.createElement(l.Z,{className:"w-md-50 w-lg-25 mb-3 mx-auto"},s.createElement(o.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[0],onChange:e=>{this.setState((t=>{const a=t.selectedVersion.split(".");return a[0]=e.target.value,{selectedVersion:a.join(".")}}))}}),s.createElement(l.Z.Text,{className:"rounded-0"},"."),s.createElement(o.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[1],onChange:e=>{this.setState((t=>{const a=t.selectedVersion.split(".");return a[1]=e.target.value,{selectedVersion:a.join(".")}}))}}),s.createElement(l.Z.Append,null,s.createElement(c.Z,{overlay:S("generic.no_perm"),show:!h&&void 0},s.createElement(i.Z,{variant:h?"success":"danger",disabled:!h,onClick:async()=>{this.setState({loading:!0});const e=await u.Z.switchActive(this.context.instance.id,this.state.selectedVersion,this.state.customFile?await this.state.customFile.arrayBuffer():void 0);e.code===f.G.ERROR?this.addError(e.error):(this.setState({customFile:null}),await this.loadVersions()),this.setState({loading:!1})}},s.createElement(n.G,{icon:"plus"}))))),s.createElement(r.Z,null,s.createElement(c.Z,{overlay:S("generic.no_perm"),show:!a&&void 0},s.createElement(r.Z.File,{custom:!0,id:"test",disabled:!a,className:"w-md-50 w-lg-25 text-left",label:this.state.customFile?this.state.customFile.name:s.createElement(m.Z,{id:"view.instance.byond.upload"}),accept:".zip",onChange:e=>{this.setState({customFile:e.target.files?e.target.files[0]:null})}}))))}}P.contextType=S.g,t.default=P},2685:function(e,t,a){a.r(t);var n=a(7294),s=a(4012),i=a(5977),r=a(8509),o=a(6352),l=a(3803),c=a(6190),d=a(6964),m=a(3e3),u=a(9049),p=a(5619),h=a(8425);class f extends n.Component{constructor(e){super(e),this.editInstance=this.editInstance.bind(this),this.state={errors:[]}}addError(e){this.setState((t=>{const a=Array.from(t.errors);return a.push(e),{errors:a}}))}async editInstance(e){const t=await o.Z.editInstance({...e,id:this.context.instance.id});t.code===l.G.OK?this.context.reloadInstance():this.addError(t.error)}render(){const e=e=>(0,d.D0)((0,d.Zg)(this.context.user),e),t={name:{name:"fields.instance.name",type:u.fS.String,defaultValue:this.context.instance.name,disabled:!e(r.c2.Rename)},path:{name:"fields.instance.path",type:u.fS.String,defaultValue:this.context.instance.path,disabled:!e(r.c2.Relocate)},chatBotLimit:{name:"fields.instance.chatbotlimit",type:u.fS.Number,min:0,defaultValue:this.context.instance.chatBotLimit,disabled:!e(r.c2.SetChatBotLimit)},autoUpdateInterval:{name:"fields.instance.autoupdate",type:u.fS.Number,min:0,defaultValue:this.context.instance.autoUpdateInterval,disabled:!e(r.c2.SetAutoUpdate)},configurationType:{name:"fields.instance.filemode",type:u.fS.Enum,enum:r.c7,defaultValue:this.context.instance.configurationType,disabled:!e(r.c2.SetConfiguration)}};return n.createElement("div",{className:"text-center"},n.createElement("h1",null,n.createElement(s.Z,{id:"view.instance.info"})),n.createElement(h.t,{obj:this.context}),this.state.errors.map(((e,t)=>{if(e)return n.createElement(m.ZP,{key:t,error:e,onClose:()=>this.setState((e=>{const a=Array.from(e.errors);return a[t]=void 0,{errors:a}}))})})),n.createElement(p.Z,{fields:t,onSave:this.editInstance}))}}f.contextType=c.g,t.default=(0,i.EN)(f)},4298:function(e,t,a){a.r(t),a.d(t,{Deployment:function(){return E}});var n=a(7294),s=a(5005),i=a(4012),r=a(5856),o=a(8509),l=a(3803),c=a(9521),d=a(6190),m=a(6964),u=a(3918),p=a(3e3),h=a(9635),f=a(9049),S=a(5619),y=a(8425),g=a(5855),v=a(2741);function E(){const e=(0,n.useContext)(d.g),t=(0,n.useState)([]),[a,E]=(0,n.useState)(!0),[b,w]=(0,n.useState)(null),[Z,x]=(0,n.useState)(null),[P,R]=(0,n.useState)(1),[C,V]=(0,n.useState)(0),[N,A]=(0,n.useState)(5),I=(0,m.$A)(e.instancePermissionSet,o.xb.Read),O=(0,m.$A)(e.instancePermissionSet,o.xb.Compile),D=(0,m.$A)(e.instancePermissionSet,o.xb.CompileJobs);async function T(){if(!I)return E(!1);E(!0);const a=await r.Z.getDeployInfo(e.instance.id);E(!1),a.code===l.G.OK?w(a.payload):(0,p.iT)(t,a.error)}async function _(a){if(!D)return;x(null);const n=await r.Z.listCompileJobs(e.instance.id,{page:a,pageSize:N});n.code===l.G.OK?(N||A(n.payload.pageSize),V(n.payload.totalPages),R(a),x(n.payload.content)):(0,p.iT)(t,n.error)}let k;(0,n.useEffect)((()=>{T(),_(1)}),[e.instance.id]);const j=/(?:(?<days>\d+)\.)?(?<hours>\d+):(?<minutes>\d+):(?<seconds>\d+)/.exec(b?.timeout??"");if(j){const e=j.groups;k=60*(24*parseInt(e.days??0)+parseInt(e.hours))+parseInt(e.minutes)+parseInt(e.seconds)/60}const G={projectName:{type:f.fS.String,name:"fields.instance.deploy.projectname",tooltip:"fields.instance.deploy.projectname.desc",defaultValue:b?.projectName,disabled:!(0,m.$A)(e.instancePermissionSet,o.xb.SetDme)},timeout:{type:f.fS.Number,name:"fields.instance.deploy.timeout",tooltip:"fields.instance.deploy.timeout.desc",defaultValue:k,disabled:!(0,m.$A)(e.instancePermissionSet,o.xb.SetTimeout)},apiValidationPort:{type:f.fS.Number,min:1,max:65535,name:"fields.instance.deploy.apiport",tooltip:"fields.instance.deploy.apiport.desc",defaultValue:b?.apiValidationPort,disabled:!(0,m.$A)(e.instancePermissionSet,o.xb.SetApiValidationPort)},apiValidationSecurityLevel:{type:f.fS.Enum,enum:o.ns,name:"fields.instance.deploy.seclevel",tooltip:"fields.instance.deploy.seclevel.desc",defaultValue:b?.apiValidationSecurityLevel,disabled:!(0,m.$A)(e.instancePermissionSet,o.xb.SetSecurityLevel)},requireDMApiValidation:{type:f.fS.Boolean,name:"fields.instance.deploy.validateapi",tooltip:"fields.instance.deploy.validateapi.desc",defaultValue:b?.requireDMApiValidation,disabled:!(0,m.$A)(e.instancePermissionSet,o.xb.SetApiValidationRequirement)}};let M=null;const $={currentPage:P,totalPages:C,loadPage:_,pageSize:N??0};return D?Z&&(M={viewDataType:u.a.CompileJobs,compileJobs:Z,paging:$}):M={viewDataType:u.a.CompileJobs,paging:$},n.createElement("div",{className:"text-center"},n.createElement(y.t,{obj:{deployInfo:b}}),(0,p.hP)(t),D?n.createElement(u.Z,{viewData:M}):n.createElement(h.Z,{title:"view.instance.no_compile_jobs"}),n.createElement("hr",null),n.createElement("h3",null,n.createElement(i.Z,{id:"view.instance.deploy.title"})),I?null:n.createElement(h.Z,{title:"view.instance.no_metadata"}),a?n.createElement(g.Z,{text:"loading.deployments"}):n.createElement(n.Fragment,null,n.createElement(S.Z,{hideDisabled:!I,fields:G,onSave:async a=>{let n;if(a.timeout){const e=Math.floor(a.timeout/1440);a.timeout-=1440*e;const t=Math.floor(a.timeout/60);a.timeout-=60*t;const s=Math.floor(a.timeout);a.timeout-=s;const i=Math.floor(60*a.timeout);n=e?`${e}.${t}:${s}:${i}`:`${t}:${s}:${i}`}const s={...a,timeout:n};E(!0);const i=await r.Z.updateDeployInfo(e.instance.id,s);i.code===l.G.ERROR?(0,p.iT)(t,i.error):await T(),E(!1)}}),n.createElement("hr",null),n.createElement(v.Z,{tooltipid:"generic.no_perm",show:!O&&void 0},n.createElement(s.Z,{disabled:!O,onClick:async()=>{const a=await r.Z.startCompile(e.instance.id);a.code===l.G.ERROR?(0,p.iT)(t,a.error):(c.Z.registerJob(a.payload,e.instance.id),c.Z.fastmode=5)}},n.createElement(i.Z,{id:"view.instance.deploy.deploy"})))))}},5921:function(e,t,a){a.r(t),a.d(t,{default:function(){return h}});var n=a(7294),s=a(3204),i=a(3803),r=a(9521),o=a(6190),l=a(1320),c=a(3e3),d=a(3128),m=a(8425),u=a(5855),p=a(9929);function h(){const e=n.useContext(o.g),[t,a]=(0,n.useState)([]),[h,f]=(0,n.useState)([]),[S,y]=(0,n.useState)(!0),[g,v]=(0,n.useState)(l.Mq.jobhistorypage.get(e.instance.id)??1),[E,b]=(0,n.useState)(void 0);function w(e){f((t=>{const a=Array.from(t);return a.push(e),a}))}async function Z(e){const t=await s.Z.deleteJob(e.instanceid,e.id);t.code===i.G.OK?r.Z.fastmode=5:w(t.error)}return(0,n.useEffect)((()=>{l.Mq.jobhistorypage.set(e.instance.id,g),y(!0),async function(){const t=await s.Z.listJobs(e.instance.id,{page:g});t.code===i.G.OK?(g>t.payload.totalPages&&0!==t.payload.totalPages&&v(1),a(t.payload.content),b(t.payload.totalPages)):w(t.error),y(!1)}()}),[g,e.instance.id]),(0,n.useEffect)((()=>{}),[h]),S?n.createElement(u.Z,{text:"loading.instance.jobs.list"}):n.createElement("div",null,n.createElement(m.t,{obj:t}),h.map(((e,t)=>{if(e)return n.createElement(c.ZP,{key:t,error:e,onClose:()=>f((e=>{const a=Array.from(e);return a[t]=void 0,a}))})})),t.sort(((e,t)=>t.id-e.id)).filter((e=>!!e.stoppedAt)).map((e=>n.createElement(d.Z,{job:e,key:e.id,onCancel:Z}))),n.createElement(p.Z,{selectPage:e=>v(e),totalPages:E??1,currentPage:g}))}},6046:function(e,t,a){a.r(t),a.d(t,{default:function(){return Z}});var n,s=a(7294),i=a(7977),r=a(5005),o=a(5293),l=a(3489),c=a(4012),d=a(7179),m=a(8509),u=a(3803),p=a(9521),h=a(6190),f=a(6964),S=a(3918),y=a(3e3),g=a(9635),v=a(9049),E=a(5619),b=a(8425),w=a(5855);function Z(){const e=(0,s.useContext)(h.g),[t,a]=(0,s.useState)(),[Z,x]=(0,s.useState)(!1),P=(0,s.useState)([]);async function R(){if(!(0,f.mg)(e.instancePermissionSet,m.py.ReadMetadata))return a({});const t=await d.Z.getWatchdogStatus(e.instance.id);t.code===u.G.ERROR?(0,y.iT)(P,t.error):a(t.payload)}async function C(t){x(!0);const a=await d.Z.updateWatchdogStatus(e.instance.id,t);a.code===u.G.ERROR&&(0,y.iT)(P,a.error),await R(),x(!1)}if((0,s.useEffect)((()=>{R()}),[e.instance.id]),!t)return s.createElement(s.Fragment,null,(0,y.hP)(P));if(Z)return s.createElement(w.Z,null);const V={autoStart:{type:v.fS.Boolean,name:"fields.instance.watchdog.autostart",defaultValue:t.autoStart,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetAutoStart)},startProfiler:{type:v.fS.Boolean,name:"fields.instance.watchdog.autostartprofiler",defaultValue:t.startProfiler,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetProfiler)},port:{type:v.fS.Number,name:"fields.instance.watchdog.port",defaultValue:t.port,min:0,max:65535,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetPort)},visibility:{type:v.fS.Enum,name:"fields.instance.watchdog.visibility",defaultValue:t.visibility,enum:m.Ye,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetVisibility)},securityLevel:{type:v.fS.Enum,name:"fields.instance.watchdog.securitylevel",defaultValue:t.securityLevel,enum:m.ns,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetSecurity)},startupTimeout:{type:v.fS.Number,name:"fields.instance.watchdog.timeout.startup",defaultValue:t.startupTimeout,min:0,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetStartupTimeout)},topicRequestTimeout:{type:v.fS.Number,name:"fields.instance.watchdog.timeout.topic",defaultValue:t.topicRequestTimeout,min:0,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetTopicTimeout)},heartbeatSeconds:{type:v.fS.Number,name:"fields.instance.watchdog.heartbeat",defaultValue:t.heartbeatSeconds,min:0,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetHeartbeatInterval)},dumpOnHeartbeatRestart:{type:v.fS.Boolean,name:"fields.instance.watchdog.dumpOnHeartbeatRestart",defaultValue:t.dumpOnHeartbeatRestart,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.CreateDump)},allowWebClient:{type:v.fS.Boolean,name:"fields.instance.watchdog.allowwebclient",defaultValue:t.allowWebClient,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetWebClient)},additionalParameters:{type:v.fS.String,name:"fields.instance.watchdog.additionalparams",defaultValue:t.additionalParameters,disabled:!(0,f.mg)(e.instancePermissionSet,m.py.SetAdditionalParameters)}},N=Object.values(V).some((e=>!e.disabled)),A=s.createElement(l.Z,{id:"generic.no_perm"},s.createElement(c.Z,{id:"generic.no_perm"})),I=(0,f.mg)(e.instancePermissionSet,m.py.Start),O=(0,f.mg)(e.instancePermissionSet,m.py.Shutdown),D=(0,f.mg)(e.instancePermissionSet,m.py.Restart),T=(0,f.mg)(e.instancePermissionSet,m.py.CreateDump),_=(0,f.mg)(e.instancePermissionSet,m.py.ReadMetadata),k=(0,f.mg)(e.instancePermissionSet,m.py.SoftShutdown)||(0,f.mg)(e.instancePermissionSet,m.py.SoftRestart),j=I||O||D||T,G=(0,f.mg)(e.instancePermissionSet,m.py.ReadRevision);let M=null;return t&&(M={viewDataType:S.a.Watchdog,activeCompileJob:t.activeCompileJob,stagedCompileJob:t.stagedCompileJob}),s.createElement("div",{className:"text-center"},s.createElement(b.t,{obj:t}),(0,y.hP)(P),s.createElement("h2",{className:"text-center"},s.createElement(c.Z,{id:"view.instance.server.status"}),s.createElement(i.Z,{pill:!0,variant:t.status===m.Ni.Online?"success":t.status===m.Ni.Offline?"danger":"warning"},s.createElement(c.Z,{id:`view.instance.server.status.${m.Ni[t.status]}`}))),s.createElement("hr",null),G?s.createElement(S.Z,{viewData:M}):s.createElement(g.Z,{title:"view.instance.no_compile_jobs"}),s.createElement("hr",null),s.createElement("h3",{className:"text-center"},s.createElement(c.Z,{id:"view.instance.server.settings"})),_?null:N?s.createElement(g.Z,{title:"view.instance.no_metadata"}):s.createElement(g.Z,{title:"view.instance.server.no_metadata_and_no_settings"}),s.createElement(E.Z,{fields:V,onSave:C,hideDisabled:!_}),s.createElement("hr",null),s.createElement("h3",{className:"text-center"},s.createElement(c.Z,{id:"view.instance.server.actions"})),j?s.createElement(s.Fragment,null,_?null:s.createElement(g.Z,{title:"view.instance.server.no_metadata_actions"}),s.createElement("div",{className:"text-center mb-3"},s.createElement(o.Z,{overlay:A,show:!I&&void 0},s.createElement(r.Z,{variant:"success",className:"mx-2",onClick:async function(){x(!0);const t=await d.Z.startWatchdog(e.instance.id);t.code===u.G.ERROR?(0,y.iT)(P,t.error):(p.Z.registerCallback(t.payload.id,(()=>{R()})),p.Z.fastmode=5,await R()),x(!1)},disabled:_&&t.status!=m.Ni.Offline||!I},s.createElement(c.Z,{id:"view.instance.server.start"}))),s.createElement(o.Z,{overlay:A,show:!O&&void 0},s.createElement(r.Z,{variant:"danger",className:"mx-2",onClick:async function(){x(!0);const t=await d.Z.stopWatchdog(e.instance.id);t.code===u.G.ERROR?(0,y.iT)(P,t.error):await R(),x(!1)},disabled:_&&t.status!=m.Ni.Online||!O},s.createElement(c.Z,{id:"view.instance.server.stop"}))),s.createElement(o.Z,{overlay:A,show:!D&&void 0},s.createElement(r.Z,{variant:"warning",className:"mx-2",onClick:async function(){x(!0);const t=await d.Z.restartWatchdog(e.instance.id);t.code===u.G.ERROR?(0,y.iT)(P,t.error):(p.Z.registerCallback(t.payload.id,(()=>{R()})),p.Z.fastmode=5,await R()),x(!1)},disabled:_&&t.status!=m.Ni.Online||!D},s.createElement(c.Z,{id:"view.instance.server.restart"}))),s.createElement(o.Z,{overlay:A,show:!T&&void 0},s.createElement(r.Z,{variant:"info",className:"mx-2",onClick:async function(){x(!0);const t=await d.Z.dumpWatchdog(e.instance.id);t.code===u.G.ERROR?(0,y.iT)(P,t.error):p.Z.fastmode=5,x(!1)},disabled:_&&t.status!=m.Ni.Online||!T},s.createElement(c.Z,{id:"view.instance.server.dump"}))))):s.createElement(g.Z,{title:"view.instance.server.no_actions"}),!_&&k?s.createElement(g.Z,{title:"view.instance.server.no_metadata_graceful"}):null,_||k?s.createElement("div",{className:"w-75 mx-auto"},s.createElement(v.ZP,{name:"view.instance.graceful",type:v.fS.Enum,enum:n,tooltip:"view.instance.graceful.desc",defaultValue:t.softRestart?n.Restart:t.softShutdown?n.Stop:n.None,disabled:!k,onChange:e=>{switch(e){case n.None:if(!t?.softRestart&&!t?.softShutdown)return;C({softShutdown:!t.softShutdown&&void 0,softRestart:!t.softRestart&&void 0});break;case n.Stop:if(t?.softShutdown)return;C({softShutdown:!0});break;case n.Restart:if(t?.softRestart)return;C({softRestart:!0})}}})):j?s.createElement(g.Z,{title:"view.instance.server.no_graceful"}):null)}!function(e){e[e.None=0]="None",e[e.Stop=1]="Stop",e[e.Restart=2]="Restart"}(n||(n={}))},9182:function(e,t,a){a.r(t);var n=a(7814),s=a(7294),i=a(5881),r=a(3361),o=a(6841),l=a(4012),c=a(5977),d=a(8509),m=a(6352),u=a(5870),p=a(3803),h=a(7961),f=a(4615),S=a(6190),y=a(1320),g=a(7888),v=a(5855),E=a(6642),b=a(161),w=a(740),Z=a(2685),x=a(4298),P=a(926),R=a(7345),C=a(5921),V=a(8264),N=a(6046);const A=d.D8.ReadActive|d.D8.ListInstalled|d.D8.InstallOfficialOrChangeActiveVersion|d.D8.InstallCustomVersion,I=d.py.SetPort|d.py.SetAutoStart|d.py.SetSecurity|d.py.ReadMetadata|d.py.SetWebClient|d.py.SoftRestart|d.py.SoftShutdown|d.py.Restart|d.py.Shutdown|d.py.Start|d.py.SetStartupTimeout|d.py.SetHeartbeatInterval|d.py.CreateDump|d.py.SetTopicTimeout|d.py.SetAdditionalParameters|d.py.SetVisibility,O=d.nX.SetOrigin|d.nX.SetSha|d.nX.MergePullRequest|d.nX.UpdateBranch|d.nX.ChangeCommitter|d.nX.ChangeTestMergeCommits|d.nX.ChangeCredentials|d.nX.SetReference|d.nX.Read|d.nX.ChangeAutoUpdateSettings|d.nX.Delete|d.nX.ChangeSubmoduleUpdate,D=d.xb.Read|d.xb.Compile|d.xb.SetApiValidationPort|d.xb.SetDme|d.xb.SetApiValidationRequirement|d.xb.SetTimeout|d.xb.SetSecurityLevel,T=d.xr.Read|d.xr.Create,_=d.TI.Read|d.TI.List|d.TI.Write;class k extends s.Component{constructor(e){super(e),this.reloadInstance=this.reloadInstance.bind(this),this.deleteContextError=this.deleteContextError.bind(this),y.Mq.selectedinstanceid=parseInt(this.props.match.params.id),this.state={tab:e.match.params.tab??k.tabs[0][0],errors:new Set,instance:null,instancePermissionSet:null,reloadInstance:this.reloadInstance,deleteError:this.deleteContextError,instanceid:parseInt(this.props.match.params.id)}}deleteContextError(e){this.setState((t=>{const a=new Set(t.errors);return a.delete(e),{errors:a}}))}async componentDidMount(){await this.reloadInstance()}componentDidUpdate(e){this.props.match.params.tab&&e.match.params.tab!=this.props.match.params.tab&&this.setState({tab:this.props.match.params.tab})}async reloadInstance(){this.setState({instance:null,instancePermissionSet:null});const e=await m.Z.getInstance(this.state.instanceid);if(e.code===p.G.OK){this.setState({instance:e.payload});const t=await u.Z.getCurrentInstancePermissionSet(this.state.instanceid,!0);t.code===p.G.OK?this.setState({instancePermissionSet:t.payload}):this.setState((e=>{const a=new Set(e.errors);return a.add(t.error),{instancePermissionSet:null,errors:a}}))}else this.setState((t=>{const a=new Set(t.errors);return a.add(e.error),{instance:null,errors:a}}))}render(){if(!this.state.instance||!this.state.instancePermissionSet)return s.createElement(v.Z,{text:"loading.instance"});return s.createElement(S.g.Provider,{value:Object.assign({user:this.context.user,serverInfo:this.context.serverInfo},this.state)},s.createElement(i.Z,{className:"behind-nav"},s.createElement(i.Z.Header,{className:"text-center mb-2 sticky-top"},s.createElement("h3",null,s.createElement(l.Z,{id:"view.instanceedit.title",values:{instanceid:this.props.match.params.id,instancename:this.state.instance.name}})),s.createElement("h5",{className:"text-white-50"},s.createElement(l.Z,{id:`view.instanceedit.tabs.${this.state.tab}`}))),s.createElement(o.Z.Container,{mountOnEnter:!0,unmountOnExit:!0,id:"instanceedit",activeKey:this.state.tab},s.createElement("div",{className:"d-flex flex-row z-front"},s.createElement(i.Z.Body,{className:"flex-grow-0"},(()=>s.createElement(r.Z,{defaultActiveKey:this.state.tab,onSelect:e=>{e=e??k.tabs[0][0],y.Mq.selectedinstanceedittab=e,this.props.history.push(y.$w.instanceedit.link??y.$w.instanceedit.route),this.setState({tab:e??k.tabs[0][0]})},fill:!0,variant:"pills",activeKey:this.state.tab,className:"flex-nowrap text-nowrap flex-column hover-bar sticky-top "+(h.ZP.instanceeditsidebar.value===h.mf.COLLAPSE?"pin-close":h.ZP.instanceeditsidebar.value===h.mf.EXPAND?"pin-open":""),style:{top:"8em"}},k.tabs.map((([e,t,a,i])=>{if(!this.state.instancePermissionSet)throw Error("this.state.instancePermissionSet is null in instanceedit nav map");const o=!i,c=!a(this.state.instancePermissionSet,this.context);return s.createElement(r.Z.Item,{key:e},s.createElement(r.Z.Link,{eventKey:e,bsPrefix:"nav-link instanceedittab",className:(o?"no-access text-white":"")+(c?"no-access text-white font-italic":"")+" text-left"},s.createElement(s.Fragment,null,s.createElement(n.G,{icon:c?"lock":t,fixedWidth:!0}),s.createElement("div",{className:"tab-text d-inline-block "+(c?"font-weight-lighter":"")},s.createElement("span",{className:"pl-1"},s.createElement(l.Z,{id:`view.instanceedit.tabs.${e}`}))))))}))))()),s.createElement(i.Z.Body,{className:"bg-body"},s.createElement(o.Z.Content,null,k.tabs.map((([e,,t,a])=>{if(!this.state.instancePermissionSet)throw Error("this.state.instancePermissionSet is null in render card map");return s.createElement(o.Z.Pane,{eventKey:e,key:e},a?t(this.state.instancePermissionSet,this.context)?s.createElement(a,null):s.createElement(g.Z,null):s.createElement(E.Z,null))}))))))))}}k.tabs=[["info","info",()=>!0,Z.default],["repository","code-branch",e=>!!(e.repositoryRights&O),V.default],["byond","list-ul",e=>!!(e.byondRights&A),b.default],["deployment","hammer",e=>!!(e.dreamMakerRights&D),x.Deployment],["dreamdaemon","server",e=>!!(e.dreamDaemonRights&I),N.default],["chatbots","comments",e=>!!(e.chatBotRights&T),w.default],["files","folder-open",e=>!!(e.configurationRights&_),P.default],["users","users",()=>!0,R.default],["jobs","stream",()=>!0,C.default]],k.contextType=f.f,t.default=(0,c.EN)(k)}}]);
//# sourceMappingURL=182.c35f395fa2d72e0483ff.bundle.js.map