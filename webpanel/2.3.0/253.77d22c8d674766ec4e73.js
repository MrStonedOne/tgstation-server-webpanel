"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[253],{28253:function(e,t,n){n.r(t),n.d(t,{default:function(){return ve}});var r=n(40098),a=n(42619),i=n(67814),s=n(67294),o=n(88375),l=n(27977),c=n(35005),u=n(31555),d=n(32258),m=n(94716),p=n(62318),f=n(15293),v=n(34051),h=n(56841),E=n(87462),g=n(63366),y=(n(55638),n(14289)),Z=n(13361),b=n(23982),O=n(41244),w=n(97184),x=n(28752),N=n(75103),C=n(53439),S=["id","onSelect","transition","mountOnEnter","unmountOnExit","children","activeKey"];function P(e){var t=e.props,n=t.title,r=t.eventKey,a=t.disabled,i=t.tabClassName,o=t.id;return null==n?null:s.createElement(O.Z,{as:b.Z,eventKey:r,disabled:a,id:o,className:i},n)}var j=function(e){var t=(0,y.Ch)(e,{activeKey:"onSelect"}),n=t.id,r=t.onSelect,a=t.transition,i=t.mountOnEnter,o=t.unmountOnExit,l=t.children,c=t.activeKey,u=void 0===c?function(e){var t;return(0,C.E)(e,(function(e){null==t&&(t=e.props.eventKey)})),t}(l):c,d=(0,g.Z)(t,S);return s.createElement(w.Z,{id:n,activeKey:u,onSelect:r,transition:a,mountOnEnter:i,unmountOnExit:o},s.createElement(Z.Z,(0,E.Z)({},d,{role:"tablist",as:"nav"}),(0,C.U)(l,P)),s.createElement(x.Z,null,(0,C.U)(l,(function(e){var t=(0,E.Z)({},e.props);return delete t.title,delete t.disabled,delete t.tabClassName,s.createElement(N.Z,t)}))))};j.defaultProps={variant:"tabs",mountOnEnter:!1,unmountOnExit:!1},j.displayName="Tabs";var k=j,A=n(43489),G=n(44012),I=n(48272),R=n(5977),K=n(73727),U=n(48155),_=n(36800),T=n(38592),F=n(69644),L=n(23098),M=n(32826),D={},z=n(42540),V=n(3429),$=n(43307),B=n(71739);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}var W=["ref"],H=["ref"],J=["ref"],Q=["ref"];function X(){return X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},X.apply(this,arguments)}function Y(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);s=!0);}catch(e){o=!0,a=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw a}}return i}}(e,t)||ie(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ae(e){return function(e){if(Array.isArray(e))return se(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ie(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ie(e,t){if(e){if("string"==typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?se(e,t):void 0}}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oe(e,t,n,r,a,i,s){try{var o=e[i](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(r,a)}function le(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){oe(i,r,a,s,o,"next",e)}function o(e){oe(i,r,a,s,o,"throw",e)}s(void 0)}))}}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ue(e,t){return ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ue(e,t)}function de(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return me(e)}function me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e){return pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},pe(e)}var fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(N,e);var t,n,E,g,y,Z,b,O,w,x=(O=N,w=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=pe(O);if(w){var n=pe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return de(this,e)});function N(e,t){var n,r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,N),(r=x.call(this,e)).createGroup=r.createGroup.bind(me(r)),r.changeGroup=r.changeGroup.bind(me(r)),!t.user)throw Error("UserEdit: this.context.user is null!");return r.state={errors:[],loading:!0,saving:!1,permsadmin:{},permsinstance:{},tab:null!==(n=e.match.params.tab)&&void 0!==n?n:"info",groups:t.user.group?[Object.assign({users:[]},t.user.group)]:[],createGroupName:"",newOAuthConnections:[]},V.Mq.selecteduserid=parseInt(e.match.params.id),V.Mq.selectedusertab=e.match.params.tab,r}return t=N,n=[{key:"canEdit",get:function(){return!!((0,z.Zg)(this.context.user).administrationRights&U.oj.WriteUsers)}},{key:"canRead",get:function(){return!!((0,z.Zg)(this.context.user).administrationRights&U.oj.ReadUsers)}},{key:"canEditOwnPassword",get:function(){var e=parseInt(this.props.match.params.id);return!!((0,z.Zg)(this.context.user).administrationRights&U.oj.EditOwnPassword)&&this.context.user.id===e}},{key:"canEditOwnOAuth",get:function(){var e=parseInt(this.props.match.params.id);return!!((0,z.Zg)(this.context.user).administrationRights&U.oj.EditOwnOAuthConnections)&&this.context.user.id===e}},{key:"componentDidUpdate",value:function(e){var t;e.match.params.tab!==this.props.match.params.tab&&this.setState({tab:null!==(t=this.props.match.params.tab)&&void 0!==t?t:"info"})}},{key:"componentDidMount",value:(b=le((function*(){var e=parseInt(this.props.match.params.id),t=yield F.Z.getUser(e);switch(t.code){case T.G.ERROR:this.addError(t.error);break;case T.G.OK:this.loadUser(t.payload)}yield this.loadGroups(),this.setState({loading:!1})})),function(){return b.apply(this,arguments)})},{key:"loadGroups",value:(Z=le((function*(){if(this.canRead){var e=yield L.Z.listGroups({page:1,pageSize:100});if(e.code===T.G.OK){for(var t=ae(e.payload.content),n=2;n<=e.payload.totalPages;n++){var r=yield L.Z.listGroups({page:n,pageSize:100});if(r.code===T.G.ERROR)return void this.addError(r.error);t.push.apply(t,ae(r.payload.content))}this.setState({groups:t})}else this.addError(e.error)}})),function(){return Z.apply(this,arguments)})},{key:"loadUser",value:function(e){this.setState({user:e,newOAuthConnections:e.oAuthConnections?Array.from(e.oAuthConnections):[]}),this.loadEnums()}},{key:"loadEnums",value:function(){var e=this;Object.entries(U.oj).forEach((function(t){var n=re(t,2),r=n[0],a=n[1];if(isNaN(parseInt(r))){var i=r.toLowerCase(),s=a;if("none"!=i){var o=!!((0,z.Zg)(e.state.user).administrationRights&s);e.setState((function(e){return{permsadmin:te(te({},e.permsadmin),{},ne({},i,{currentVal:o,bitflag:s}))}}))}}})),Object.entries(U.c2).forEach((function(t){var n=re(t,2),r=n[0],a=n[1];if(isNaN(parseInt(r))){var i=r.toLowerCase(),s=a;if("none"!=i){var o=!!((0,z.Zg)(e.state.user).instanceManagerRights&s);e.setState((function(e){return{permsinstance:te(te({},e.permsinstance),{},ne({},i,{currentVal:o,bitflag:s}))}}))}}}))}},{key:"addError",value:function(e){this.setState((function(t){var n=Array.from(t.errors);return n.push(e),{errors:n}}))}},{key:"render",value:function(){var e,t,n=this;return this.state.loading?s.createElement(B.Z,{text:"loading.user.load"}):this.state.saving?s.createElement(B.Z,{text:"loading.user.save"}):s.createElement("div",{className:"text-center"},this.state.errors.map((function(e,t){if(e)return s.createElement($.Z,{key:t,error:e,onClose:function(){return n.setState((function(e){var n=Array.from(e.errors);return n[t]=void 0,{errors:n}}))}})})),this.state.user?s.createElement(s.Fragment,null,this.canEdit?"":s.createElement(o.Z,{className:"clearfix",variant:"error"},s.createElement(G.Z,{id:"view.user.edit.cantedit"})),this.state.user.systemIdentifier?s.createElement(l.Z,{variant:"primary",className:"mx-1"},s.createElement(G.Z,{id:"generic.system.short"})):s.createElement(l.Z,{variant:"primary",className:"mx-1"},s.createElement(G.Z,{id:"generic.tgs"})),this.state.user.enabled?s.createElement(l.Z,{variant:"success",className:"mx-1"},s.createElement(G.Z,{id:"generic.enabled"})):s.createElement(l.Z,{variant:"danger",className:"mx-1"},s.createElement(G.Z,{id:"generic.disabled"})),this.state.user.group?s.createElement(l.Z,{variant:"warning",className:"mx-1"},s.createElement(G.Z,{id:"generic.grouped"})):null,s.createElement("h3",{className:"text-capitalize"},this.state.user.name),s.createElement(c.Z,{as:K.rU,to:null!==(e=V.$w.userlist.link)&&void 0!==e?e:V.$w.userlist.route},s.createElement(G.Z,{id:"generic.goback"})),s.createElement(k,{activeKey:this.state.tab,onSelect:function(e){var t;e&&(V.Mq.selectedusertab=e,D.setupMode||n.props.history.push(null!==(t=V.$w.useredit.link)&&void 0!==t?t:V.$w.useredit.route),n.setState({tab:e}))},id:"test",className:"justify-content-center mb-3 mt-4 flex-column flex-md-row"},s.createElement(h.Z,{eventKey:"info",title:s.createElement(G.Z,{id:"generic.info"})},s.createElement(u.Z,{lg:5,className:"text-center text-md-left mx-auto"},s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(G.Z,{id:"generic.userid"}))),s.createElement(u.Z,{className:"text-capitalize mb-2"},this.state.user.id)),this.state.user.systemIdentifier?s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(G.Z,{id:"generic.systemidentifier"}))),s.createElement(u.Z,{className:"mb-2 text-sm-break"},this.state.user.systemIdentifier)):"",s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(G.Z,{id:"generic.enabled"}))),s.createElement(u.Z,{className:"text-capitalize mb-2"},this.state.user.enabled.toString())),s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(G.Z,{id:"generic.created"}))),s.createElement(f.Z,{overlay:s.createElement(A.Z,{id:"".concat(this.state.user.name,"-tooltip")},new Date(this.state.user.createdAt).toLocaleString())},(function(e){var t=e.ref,r=Y(e,W);return s.createElement(u.Z,X({className:"text-capitalize mb-2"},r),s.createElement("span",{ref:t},s.createElement(I.Z,{value:(new Date(n.state.user.createdAt).getTime()-Date.now())/1e3,numeric:"auto",updateIntervalInSeconds:1})))}))),s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(G.Z,{id:"generic.createdby"}))),s.createElement(f.Z,{overlay:s.createElement(A.Z,{id:"".concat(this.state.user.name,"-tooltip-createdby")},s.createElement(G.Z,{id:"generic.userid"}),this.state.user.createdBy.id)},(function(e){var t=e.ref,r=Y(e,H);return s.createElement(u.Z,X({className:"text-capitalize mb-2"},r),s.createElement("span",{ref:t},n.state.user.createdBy.name))}))),s.createElement("div",{className:"text-center mt-3"},this.canEdit||this.canEditOwnPassword?s.createElement(c.Z,{className:"mr-2",as:K.rU,to:(null!==(t=V.$w.passwd.link)&&void 0!==t?t:V.$w.passwd.route)+this.state.user.id.toString()},s.createElement(G.Z,{id:"routes.passwd"})):"",this.canEdit?s.createElement(c.Z,{variant:this.state.user.enabled?"danger":"success",onClick:le((function*(){n.setState({saving:!0});var e=yield F.Z.editUser({enabled:!n.state.user.enabled,id:n.state.user.id});e.code==T.G.OK?n.loadUser(e.payload):n.addError(e.error),n.setState({saving:!1})}))},s.createElement(G.Z,{id:this.state.user.enabled?"generic.disable":"generic.enable"})):""))),s.createElement(h.Z,{eventKey:"adminperms",title:s.createElement(G.Z,{id:"perms.admin"})},this.renderPerms("permsadmin","admin")),s.createElement(h.Z,{eventKey:"instanceperms",title:s.createElement(G.Z,{id:"perms.instance"})},this.renderPerms("permsinstance","instance")),s.createElement(h.Z,{eventKey:"group",title:s.createElement(G.Z,{id:"perms.group"})},this.renderGroups()),this.renderOAuth())):"")}},{key:"renderOAuth",value:function(){var e,t,n,r,o,l=this,u=this.context.serverInfo.oAuthProviderInfos,f=null!==(e=this.state.newOAuthConnections)&&void 0!==e?e:null===(t=this.state.user)||void 0===t?void 0:t.oAuthConnections;if("admin"===(null===(n=this.state.user)||void 0===n?void 0:n.name.toLowerCase())||null==f||!u||!Object.keys(u).length)return null;var v=function(){var e=le((function*(){if(l.setState({saving:!0}),l.state.user){var e=yield F.Z.editUser({id:l.state.user.id,oAuthConnections:l.state.newOAuthConnections});e.code==T.G.OK?l.loadUser(e.payload):l.addError(e.error),l.setState({saving:!1})}else l.addError(new _.ZP(_.jK.APP_FAIL,{jsError:Error("this.state.user is null in user edit save")}))}));return function(){return e.apply(this,arguments)}}(),E=this.canEdit||this.canEditOwnOAuth;return s.createElement(h.Z,{eventKey:"oauth",title:s.createElement(G.Z,{id:"view.user.edit.oauth.connections"})},s.createElement("h3",{className:"mb-3"},s.createElement(G.Z,{id:"view.user.edit.oauth.current"})),s.createElement("div",null,this.state.newOAuthConnections.map((function(e,t){return s.createElement("div",{className:"justify-content-center d-flex",key:t},s.createElement(p.Z,{className:"w-75 mb-1"},s.createElement(p.Z.Prepend,null,s.createElement(p.Z.Text,null,s.createElement("span",null,s.createElement(G.Z,{id:"view.user.edit.oauth.provider"})))),s.createElement(d.Z.Control,{className:"flex-grow-1 flex-md-grow-0 w-50 w-md-auto ",as:"select",custom:!0,disabled:!E,onChange:function(e){var n=e.target.value;l.setState((function(e){return{newOAuthConnections:e.newOAuthConnections.map((function(e,r){return r!==t?e:te(te({},e),{},{provider:n})}))}}))}},Object.keys(u).map((function(t){return s.createElement(G.Z,{key:t,id:"view.user.edit.oauth.provider.".concat(t.toLowerCase())},(function(n){return s.createElement("option",{value:t,selected:e.provider===t},n)}))}))),s.createElement(p.Z.Text,{className:"rounded-0"},s.createElement(G.Z,{id:"view.user.edit.oauth.id"})),s.createElement(m.Z,{className:"",value:e.externalUserId,onChange:function(e){var n=e.target.value;l.setState((function(e){return{newOAuthConnections:e.newOAuthConnections.map((function(e,r){return r!==t?e:te(te({},e),{},{externalUserId:n})}))}}))},disabled:!E}),s.createElement(p.Z.Append,{className:""},s.createElement(c.Z,{variant:"danger",className:"text-darker",hidden:!E,onClick:function(){l.setState((function(e){return{newOAuthConnections:e.newOAuthConnections.filter((function(e,n){return t!==n}))}}))}},s.createElement("div",null,s.createElement(i.G,{icon:a.$}))))))}))),E?s.createElement("div",{className:"text-center mt-3"},s.createElement(c.Z,{className:"mr-2",onClick:function(){l.setState((function(e){return{newOAuthConnections:[].concat(ae(e.newOAuthConnections),[{provider:Object.keys(u)[0],externalUserId:""}])}}))}},s.createElement(G.Z,{id:"view.user.edit.oauth.add"})),s.createElement(c.Z,{onClick:v,variant:"success",disabled:this.state.newOAuthConnections.some((function(e){return 0===e.externalUserId.trim().length}))||this.state.newOAuthConnections.every((function(e,t){var n,r,a,i,s,o;return e.externalUserId===(null===(n=(null!==(r=null===(a=l.state.user)||void 0===a?void 0:a.oAuthConnections)&&void 0!==r?r:[])[t])||void 0===n?void 0:n.externalUserId)&&e.provider===(null===(i=(null!==(s=null===(o=l.state.user)||void 0===o?void 0:o.oAuthConnections)&&void 0!==s?s:[])[t])||void 0===i?void 0:i.provider)}))&&this.state.newOAuthConnections.length===(null===(r=this.state.user)||void 0===r||null===(o=r.oAuthConnections)||void 0===o?void 0:o.length)},s.createElement(G.Z,{id:"generic.savepage"}))):"")}},{key:"renderGroups",value:function(){var e,t=this;return this.state.user&&this.state.groups?s.createElement("div",null,this.canRead?null:s.createElement(o.Z,{className:"clearfix",variant:"error"},s.createElement(G.Z,{id:"perms.group.cantlist"})),s.createElement("h3",{className:"mb-3"},s.createElement(G.Z,{id:"perms.group.current"}),this.state.user.group?this.state.user.group.name:s.createElement(G.Z,{id:"perms.group.none"})),s.createElement("div",{onChange:this.changeGroup},s.createElement(p.Z,{className:"justify-content-center mb-3",as:"label",htmlFor:"group_none"},s.createElement(p.Z.Prepend,null,s.createElement(p.Z.Radio,{id:"group_none",name:"group",defaultChecked:void 0===(null===(e=this.state.user.group)||void 0===e?void 0:e.id),disabled:!this.canEdit})),s.createElement(p.Z.Append,{className:"w-40 overflow-auto"},s.createElement(p.Z.Text,{className:"flex-fill"},s.createElement(G.Z,{id:"perms.group.none"})))),this.state.groups.map((function(e){var n,r,o,l;return s.createElement(p.Z,{className:"justify-content-center mb-1",key:e.id},s.createElement(p.Z.Prepend,null,s.createElement(p.Z.Radio,{id:"group-"+e.id.toString(),name:"group",defaultChecked:(null===(n=t.state.user.group)||void 0===n?void 0:n.id)===e.id,disabled:!t.canEdit})),s.createElement(p.Z.Append,{className:"w-40 overflow-auto"},s.createElement(p.Z.Text,{className:"flex-fill",as:"label",htmlFor:"group-"+e.id.toString()},s.createElement("span",null,e.name),s.createElement("div",{className:"text-right ml-auto"},s.createElement(G.Z,{id:"generic.numusers",values:{count:t.canRead?null===(r=e.users)||void 0===r?void 0:r.length:"???"}}))),s.createElement(f.Z,{overlay:s.createElement(A.Z,{id:"".concat(e.id,"-tooltip")},s.createElement(G.Z,{id:"perms.group.delete.warning"})),show:!!(null!==(o=e.users)&&void 0!==o&&o.length&&t.canEdit||e.id===(null===(l=t.state.user.group)||void 0===l?void 0:l.id))&&void 0},(function(n){var r,o,l=n.ref,u=Y(n,J);return s.createElement(c.Z,X({variant:"danger",className:"text-darker",disabled:!(null===(r=e.users)||void 0===r||!r.length)||!t.canEdit||e.id===(null===(o=t.state.user.group)||void 0===o?void 0:o.id),onClick:function(){t.deleteGroup(e.id)}},u),s.createElement("div",{ref:l},s.createElement(i.G,{icon:a.$})))}))))}))),s.createElement(p.Z,{className:"justify-content-center mb-1 mt-5"},s.createElement(p.Z.Prepend,null,s.createElement(c.Z,{variant:"primary",onClick:this.createGroup,disabled:!this.canEdit||!this.state.createGroupName.length},s.createElement(i.G,{icon:r.r8}))),s.createElement(m.Z,{className:"w-40 overflow-auto flex-grow-0",value:this.state.createGroupName,onChange:function(e){t.setState({createGroupName:e.target.value})},disabled:!this.canEdit}))):s.createElement($.Z,{error:new _.ZP(_.jK.APP_FAIL,{jsError:Error("Assertion failed, user or group is null")})})}},{key:"changeGroup",value:(y=le((function*(e){if(this.state.user){this.setState({loading:!0});var t=e.target.id;if("group_none"===t){var n=yield F.Z.editUser({id:this.state.user.id,permissionSet:(0,z.Zg)(this.state.user)});n.code===T.G.OK?(yield this.loadGroups(),this.loadUser(n.payload)):this.addError(n.error)}else{var r=parseInt(t.substr(6)),a=yield F.Z.editUser({id:this.state.user.id,group:{id:r}});a.code===T.G.OK?(yield this.loadGroups(),this.loadUser(a.payload)):this.addError(a.error)}this.setState({loading:!1})}else this.addError(new _.ZP(_.jK.APP_FAIL,{jsError:Error("this.state.user is null in changegroup")}))})),function(e){return y.apply(this,arguments)})},{key:"deleteGroup",value:(g=le((function*(e){this.setState({loading:!0});var t=yield L.Z.deleteGroup(e);t.code===T.G.OK?this.setState((function(t){return{groups:t.groups.filter((function(t){return t.id!==e}))}})):this.addError(t.error),this.setState({loading:!1})})),function(e){return g.apply(this,arguments)})},{key:"createGroup",value:(E=le((function*(){this.setState({loading:!0});var e=yield L.Z.createGroup(this.state.createGroupName,(0,z.Zg)(this.state.user));e.code===T.G.OK?this.setState((function(t){return{groups:t.groups.concat([e.payload])}})):this.addError(e.error),this.setState({loading:!1})})),function(){return E.apply(this,arguments)})},{key:"renderPerms",value:function(e,t){var n,r=this,a={},l=function(e,t,n){e.current&&t.current&&(e.current.checked!==n?t.current.classList.add("font-weight-bold"):t.current.classList.remove("font-weight-bold"))},m=function(t){return function(){for(var n=0,i=Object.entries(a);n<i.length;n++){var s=re(i[n],2),o=s[0],c=s[1];if(!c.input.current)return;c.input.current.checked=t,l(c.input,c.field,r.state[e][o].currentVal)}}},v=function(){var t=le((function*(){r.setState({saving:!0});for(var t=0,n=0,i=Object.entries(a);n<i.length;n++){var s=re(i[n],2),o=s[0],l=s[1];l.input.current&&(t+=l.input.current.checked?r.state[e][o].bitflag:0)}if(r.state.user){if(r.state.user.group){var c=Object.assign(Object.assign({},r.state.user.group.permissionSet),ne({},"permsadmin"==e?"AdministrationRights":"InstanceManagerRights",t)),u=yield L.Z.updateGroup({id:r.state.user.group.id,permissionSet:c});if(u.code==T.G.OK){var d=yield F.Z.getUser(r.state.user.id);d.code==T.G.OK?r.loadUser(d.payload):r.addError(d.error)}else r.addError(u.error)}else{var m=Object.assign(Object.assign({},r.state.user.permissionSet),ne({},"permsadmin"==e?"AdministrationRights":"InstanceManagerRights",t)),p=yield F.Z.editUser({id:r.state.user.id,permissionSet:m});p.code==T.G.OK?r.loadUser(p.payload):r.addError(p.error)}r.setState({saving:!1})}else r.addError(new _.ZP(_.jK.APP_FAIL,{jsError:Error("this.state.user is null in user edit save")}))}));return function(){return t.apply(this,arguments)}}();return s.createElement(s.Fragment,null,null!==(n=this.state.user)&&void 0!==n&&n.group?s.createElement(o.Z,{variant:"warning"},s.createElement(G.Z,{id:"perms.group.warning",values:{group:"".concat(this.state.user.group.name," (").concat(this.state.user.group.id,")")}})):null,this.canEdit?s.createElement(s.Fragment,null,s.createElement("h5",null,s.createElement(G.Z,{id:"generic.setall"})),s.createElement(c.Z,{onClick:m(!0)},s.createElement(G.Z,{id:"generic.true"}))," ",s.createElement(c.Z,{onClick:m(!1)},s.createElement(G.Z,{id:"generic.false"}))," ",s.createElement(c.Z,{onClick:function(){for(var t=0,n=Object.entries(a);t<n.length;t++){var i=re(n[t],2),s=i[0],o=i[1];o.input.current&&(o.input.current.checked=r.state[e][s].currentVal,l(o.input,o.field,r.state[e][s].currentVal))}}},s.createElement(G.Z,{id:"generic.reset"}))):"",s.createElement(u.Z,{md:8,lg:7,xl:6,className:"mx-auto"},s.createElement("hr",null),Object.entries(this.state[e]).map((function(e){var n=re(e,2),o=n[0],c=n[1],u=s.createRef(),m=s.createRef();return a[o]={input:u,field:m},s.createElement(p.Z,{key:o,as:"label",htmlFor:o,className:"mb-0"},s.createElement(p.Z.Prepend,{className:"flex-grow-1 overflow-auto"},s.createElement(f.Z,{overlay:s.createElement(A.Z,{id:"perms.".concat(t,".").concat(o,".desc")},s.createElement(G.Z,{id:"perms.".concat(t,".").concat(o,".desc")}))},(function(e){var n=e.ref,a=Y(e,Q);return s.createElement(p.Z.Text,{className:"flex-fill",ref:m},s.createElement("div",a,s.createElement(G.Z,{id:"perms.".concat(t,".").concat(o)})),s.createElement("div",{className:"ml-auto d-flex align-items-center"},s.createElement(d.Z.Check,{inline:!0,type:"switch",custom:!0,id:o,className:"d-flex justify-content-center align-content-center mx-2",label:"",ref:u,disabled:!r.canEdit,defaultChecked:c.currentVal,onChange:function(){l(u,m,c.currentVal)}}),s.createElement("div",X({},a,{ref:n}),s.createElement(i.G,{fixedWidth:!0,icon:"info"}))))}))))})),s.createElement("hr",null)),this.canEdit?s.createElement(c.Z,{onClick:v},s.createElement(G.Z,{id:"generic.savepage"})):"")}}],n&&ce(t.prototype,n),N}(s.Component);fe.contextType=M.f;var ve=(0,R.EN)(fe)},27977:function(e,t,n){var r=n(87462),a=n(63366),i=n(94184),s=n.n(i),o=n(67294),l=n(76792),c=["bsPrefix","variant","pill","className","as"],u=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.variant,u=e.pill,d=e.className,m=e.as,p=void 0===m?"span":m,f=(0,a.Z)(e,c),v=(0,l.vE)(n,"badge");return o.createElement(p,(0,r.Z)({ref:t},f,{className:s()(d,v,u&&v+"-pill",i&&v+"-"+i)}))}));u.displayName="Badge",u.defaultProps={pill:!1},t.Z=u},62318:function(e,t,n){var r=n(63366),a=n(87462),i=n(94184),s=n.n(i),o=n(67294),l=n(44680),c=n(76792),u=["bsPrefix","size","hasValidation","className","as"],d=(0,l.Z)("input-group-append"),m=(0,l.Z)("input-group-prepend"),p=(0,l.Z)("input-group-text",{Component:"span"}),f=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.size,l=e.hasValidation,d=e.className,m=e.as,p=void 0===m?"div":m,f=(0,r.Z)(e,u);return n=(0,c.vE)(n,"input-group"),o.createElement(p,(0,a.Z)({ref:t},f,{className:s()(d,n,i&&n+"-"+i,l&&"has-validation")}))}));f.displayName="InputGroup",f.Text=p,f.Radio=function(e){return o.createElement(p,null,o.createElement("input",(0,a.Z)({type:"radio"},e)))},f.Checkbox=function(e){return o.createElement(p,null,o.createElement("input",(0,a.Z)({type:"checkbox"},e)))},f.Append=d,f.Prepend=m,t.Z=f},34051:function(e,t,n){var r=n(87462),a=n(63366),i=n(94184),s=n.n(i),o=n(67294),l=n(76792),c=["bsPrefix","className","noGutters","as"],u=["xl","lg","md","sm","xs"],d=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.className,d=e.noGutters,m=e.as,p=void 0===m?"div":m,f=(0,a.Z)(e,c),v=(0,l.vE)(n,"row"),h=v+"-cols",E=[];return u.forEach((function(e){var t,n=f[e];delete f[e];var r="xs"!==e?"-"+e:"";null!=(t=null!=n&&"object"==typeof n?n.cols:n)&&E.push(""+h+r+"-"+t)})),o.createElement(p,(0,r.Z)({ref:t},f,{className:s().apply(void 0,[i,v,d&&"no-gutters"].concat(E))}))}));d.displayName="Row",d.defaultProps={noGutters:!1},t.Z=d},56841:function(e,t,n){var r=n(51721),a=n(67294),i=n(97184),s=n(28752),o=n(75103),l=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")},t}(a.Component);l.Container=i.Z,l.Content=s.Z,l.Pane=o.Z,t.Z=l},97184:function(e,t,n){var r=n(67294),a=n(14289),i=n(24426),s=n(45017);t.Z=function(e){var t=(0,a.Ch)(e,{activeKey:"onSelect"}),n=t.id,o=t.generateChildId,l=t.onSelect,c=t.activeKey,u=t.transition,d=t.mountOnEnter,m=t.unmountOnExit,p=t.children,f=(0,r.useMemo)((function(){return o||function(e,t){return n?n+"-"+t+"-"+e:null}}),[n,o]),v=(0,r.useMemo)((function(){return{onSelect:l,activeKey:c,transition:u,mountOnEnter:d||!1,unmountOnExit:m||!1,getControlledId:function(e){return f(e,"tabpane")},getControllerId:function(e){return f(e,"tab")}}}),[l,c,u,d,m,f]);return r.createElement(i.Z.Provider,{value:v},r.createElement(s.Z.Provider,{value:l||null},p))}},28752:function(e,t,n){var r=n(87462),a=n(63366),i=n(94184),s=n.n(i),o=n(67294),l=n(76792),c=["bsPrefix","as","className"],u=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.as,u=void 0===i?"div":i,d=e.className,m=(0,a.Z)(e,c),p=(0,l.vE)(n,"tab-content");return o.createElement(u,(0,r.Z)({ref:t},m,{className:s()(d,p)}))}));t.Z=u},75103:function(e,t,n){var r=n(87462),a=n(63366),i=n(94184),s=n.n(i),o=n(67294),l=n(76792),c=n(24426),u=n(45017),d=n(41068),m=["activeKey","getControlledId","getControllerId"],p=["bsPrefix","className","active","onEnter","onEntering","onEntered","onExit","onExiting","onExited","mountOnEnter","unmountOnExit","transition","as","eventKey"],f=o.forwardRef((function(e,t){var n=function(e){var t=(0,o.useContext)(c.Z);if(!t)return e;var n=t.activeKey,i=t.getControlledId,s=t.getControllerId,l=(0,a.Z)(t,m),p=!1!==e.transition&&!1!==l.transition,f=(0,u.h)(e.eventKey);return(0,r.Z)({},e,{active:null==e.active&&null!=f?(0,u.h)(n)===f:e.active,id:i(e.eventKey),"aria-labelledby":s(e.eventKey),transition:p&&(e.transition||l.transition||d.Z),mountOnEnter:null!=e.mountOnEnter?e.mountOnEnter:l.mountOnEnter,unmountOnExit:null!=e.unmountOnExit?e.unmountOnExit:l.unmountOnExit})}(e),i=n.bsPrefix,f=n.className,v=n.active,h=n.onEnter,E=n.onEntering,g=n.onEntered,y=n.onExit,Z=n.onExiting,b=n.onExited,O=n.mountOnEnter,w=n.unmountOnExit,x=n.transition,N=n.as,C=void 0===N?"div":N,S=(n.eventKey,(0,a.Z)(n,p)),P=(0,l.vE)(i,"tab-pane");if(!v&&!x&&w)return null;var j=o.createElement(C,(0,r.Z)({},S,{ref:t,role:"tabpanel","aria-hidden":!v,className:s()(f,P,{active:v})}));return x&&(j=o.createElement(x,{in:v,onEnter:h,onEntering:E,onEntered:g,onExit:y,onExiting:Z,onExited:b,mountOnEnter:O,unmountOnExit:w},j)),o.createElement(c.Z.Provider,{value:null},o.createElement(u.Z.Provider,{value:null},j))}));f.displayName="TabPane",t.Z=f}}]);
//# sourceMappingURL=253.77d22c8d674766ec4e73.js.map