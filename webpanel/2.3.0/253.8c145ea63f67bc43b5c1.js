(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[253],{28253:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ue}});var r=n(40098),a=n(42619),i=n(67814),s=n(67294),o=n(88375),c=n(27977),l=n(35005),u=n(31555),d=n(32258),m=n(94716),p=n(62318),f=n(86828),v=n(34051),h=n(56841),E=n(22122),g=n(19756),y=(n(55638),n(14289)),Z=n(13361),b=n(23982),O=n(41244),w=n(97184),x=n(28752),N=n(75103),C=n(53439);function S(e){var t=e.props,n=t.title,r=t.eventKey,a=t.disabled,i=t.tabClassName,o=t.id;return null==n?null:s.createElement(O.Z,{as:b.Z,eventKey:r,disabled:a,id:o,className:i},n)}var P=function(e){var t=(0,y.Ch)(e,{activeKey:"onSelect"}),n=t.id,r=t.onSelect,a=t.transition,i=t.mountOnEnter,o=t.unmountOnExit,c=t.children,l=t.activeKey,u=void 0===l?function(e){var t;return(0,C.E)(e,(function(e){null==t&&(t=e.props.eventKey)})),t}(c):l,d=(0,g.Z)(t,["id","onSelect","transition","mountOnEnter","unmountOnExit","children","activeKey"]);return s.createElement(w.Z,{id:n,activeKey:u,onSelect:r,transition:a,mountOnEnter:i,unmountOnExit:o},s.createElement(Z.Z,(0,E.Z)({},d,{role:"tablist",as:"nav"}),(0,C.U)(c,S)),s.createElement(x.Z,null,(0,C.U)(c,(function(e){var t=(0,E.Z)({},e.props);return delete t.title,delete t.disabled,delete t.tabClassName,s.createElement(N.Z,t)}))))};P.defaultProps={variant:"tabs",mountOnEnter:!1,unmountOnExit:!1},P.displayName="Tabs";var j=P,k=n(43489),A=n(44012),G=n(48272),I=n(41153),R=n(73727),K=n(48155),U=n(36800),_=n(38592),T=n(69644),F=n(23098),L=n(32826),M={},z=n(42540),D=n(3429),$=n(43307),V=n(71739);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(){return(q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function W(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(a)throw i}}return n}}(e,t)||ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e){return function(e){if(Array.isArray(e))return te(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ne(e,t,n,r,a,i,s){try{var o=e[i](s),c=o.value}catch(e){return void n(e)}o.done?t(c):Promise.resolve(c).then(r,a)}function re(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){ne(i,r,a,s,o,"next",e)}function o(e){ne(i,r,a,s,o,"throw",e)}s(void 0)}))}}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function se(e,t){return!t||"object"!==B(t)&&"function"!=typeof t?oe(e):t}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var le=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(N,e);var t,n,E,g,y,Z,b,O,w,x=(O=N,w=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ce(O);if(w){var n=ce(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return se(this,e)});function N(e,t){var n,r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,N),(r=x.call(this,e)).createGroup=r.createGroup.bind(oe(r)),r.changeGroup=r.changeGroup.bind(oe(r)),!t.user)throw Error("UserEdit: this.context.user is null!");return r.state={errors:[],loading:!0,saving:!1,permsadmin:{},permsinstance:{},tab:null!==(n=e.match.params.tab)&&void 0!==n?n:"info",groups:t.user.group?[Object.assign({users:[]},t.user.group)]:[],createGroupName:"",newOAuthConnections:[]},D.Mq.selecteduserid=parseInt(e.match.params.id),D.Mq.selectedusertab=e.match.params.tab,r}return t=N,(n=[{key:"canEdit",get:function(){return!!((0,z.Zg)(this.context.user).administrationRights&K.oj.WriteUsers)}},{key:"canRead",get:function(){return!!((0,z.Zg)(this.context.user).administrationRights&K.oj.ReadUsers)}},{key:"canEditOwnPassword",get:function(){var e=parseInt(this.props.match.params.id);return!!((0,z.Zg)(this.context.user).administrationRights&K.oj.EditOwnPassword)&&this.context.user.id===e}},{key:"canEditOwnOAuth",get:function(){var e=parseInt(this.props.match.params.id);return!!((0,z.Zg)(this.context.user).administrationRights&K.oj.EditOwnOAuthConnections)&&this.context.user.id===e}},{key:"componentDidUpdate",value:function(e){var t;e.match.params.tab!==this.props.match.params.tab&&this.setState({tab:null!==(t=this.props.match.params.tab)&&void 0!==t?t:"info"})}},{key:"componentDidMount",value:(b=re((function*(){var e=parseInt(this.props.match.params.id),t=yield T.Z.getUser(e);switch(t.code){case _.G.ERROR:this.addError(t.error);break;case _.G.OK:this.loadUser(t.payload)}yield this.loadGroups(),this.setState({loading:!1})})),function(){return b.apply(this,arguments)})},{key:"loadGroups",value:(Z=re((function*(){if(this.canRead){var e=[],t=yield F.Z.listGroups({page:1,pageSize:100});if(t.code===_.G.OK){for(var n=2;n<=t.payload.totalPages;n++){var r=yield F.Z.listGroups({page:n,pageSize:100});if(r.code===_.G.ERROR)return void this.addError(r.error);e.push.apply(e,Y(r.payload.content))}this.setState({groups:e})}else this.addError(t.error)}})),function(){return Z.apply(this,arguments)})},{key:"loadUser",value:function(e){this.setState({user:e,newOAuthConnections:e.oAuthConnections?Array.from(e.oAuthConnections):[]}),this.loadEnums()}},{key:"loadEnums",value:function(){var e=this;Object.entries(K.oj).forEach((function(t){var n=X(t,2),r=n[0],a=n[1];if(isNaN(parseInt(r))){var i=r.toLowerCase(),s=a;if("none"!=i){var o=!!((0,z.Zg)(e.state.user).administrationRights&s);e.setState((function(e){return{permsadmin:J(J({},e.permsadmin),{},Q({},i,{currentVal:o,bitflag:s}))}}))}}})),Object.entries(K.c2).forEach((function(t){var n=X(t,2),r=n[0],a=n[1];if(isNaN(parseInt(r))){var i=r.toLowerCase(),s=a;if("none"!=i){var o=!!((0,z.Zg)(e.state.user).instanceManagerRights&s);e.setState((function(e){return{permsinstance:J(J({},e.permsinstance),{},Q({},i,{currentVal:o,bitflag:s}))}}))}}}))}},{key:"addError",value:function(e){this.setState((function(t){var n=Array.from(t.errors);return n.push(e),{errors:n}}))}},{key:"render",value:function(){var e,t,n=this;return this.state.loading?s.createElement(V.Z,{text:"loading.user.load"}):this.state.saving?s.createElement(V.Z,{text:"loading.user.save"}):s.createElement("div",{className:"text-center"},this.state.errors.map((function(e,t){if(e)return s.createElement($.Z,{key:t,error:e,onClose:function(){return n.setState((function(e){var n=Array.from(e.errors);return n[t]=void 0,{errors:n}}))}})})),this.state.user?s.createElement(s.Fragment,null,this.canEdit?"":s.createElement(o.Z,{className:"clearfix",variant:"error"},s.createElement(A.Z,{id:"view.user.edit.cantedit"})),this.state.user.systemIdentifier?s.createElement(c.Z,{variant:"primary",className:"mx-1"},s.createElement(A.Z,{id:"generic.system.short"})):s.createElement(c.Z,{variant:"primary",className:"mx-1"},s.createElement(A.Z,{id:"generic.tgs"})),this.state.user.enabled?s.createElement(c.Z,{variant:"success",className:"mx-1"},s.createElement(A.Z,{id:"generic.enabled"})):s.createElement(c.Z,{variant:"danger",className:"mx-1"},s.createElement(A.Z,{id:"generic.disabled"})),this.state.user.group?s.createElement(c.Z,{variant:"warning",className:"mx-1"},s.createElement(A.Z,{id:"generic.grouped"})):null,s.createElement("h3",{className:"text-capitalize"},this.state.user.name),s.createElement(l.Z,{as:R.rU,to:null!==(e=D.$w.userlist.link)&&void 0!==e?e:D.$w.userlist.route},s.createElement(A.Z,{id:"generic.goback"})),s.createElement(j,{activeKey:this.state.tab,onSelect:function(e){var t;e&&(D.Mq.selectedusertab=e,M.setupMode||n.props.history.push(null!==(t=D.$w.useredit.link)&&void 0!==t?t:D.$w.useredit.route),n.setState({tab:e}))},id:"test",className:"justify-content-center mb-3 mt-4 flex-column flex-md-row"},s.createElement(h.Z,{eventKey:"info",title:s.createElement(A.Z,{id:"generic.info"})},s.createElement(u.Z,{lg:5,className:"text-center text-md-left mx-auto"},s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(A.Z,{id:"generic.userid"}))),s.createElement(u.Z,{className:"text-capitalize mb-2"},this.state.user.id)),this.state.user.systemIdentifier?s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(A.Z,{id:"generic.systemidentifier"}))),s.createElement(u.Z,{className:"mb-2 text-sm-break"},this.state.user.systemIdentifier)):"",s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(A.Z,{id:"generic.enabled"}))),s.createElement(u.Z,{className:"text-capitalize mb-2"},this.state.user.enabled.toString())),s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(A.Z,{id:"generic.created"}))),s.createElement(f.Z,{overlay:s.createElement(k.Z,{id:"".concat(this.state.user.name,"-tooltip")},new Date(this.state.user.createdAt).toLocaleString())},(function(e){var t=e.ref,r=W(e,["ref"]);return s.createElement(u.Z,q({className:"text-capitalize mb-2"},r),s.createElement("span",{ref:t},s.createElement(G.Z,{value:(new Date(n.state.user.createdAt).getTime()-Date.now())/1e3,numeric:"auto",updateIntervalInSeconds:1})))}))),s.createElement(v.Z,{xs:1,md:2},s.createElement(u.Z,null,s.createElement("h5",{className:"m-0"},s.createElement(A.Z,{id:"generic.createdby"}))),s.createElement(f.Z,{overlay:s.createElement(k.Z,{id:"".concat(this.state.user.name,"-tooltip-createdby")},s.createElement(A.Z,{id:"generic.userid"}),this.state.user.createdBy.id)},(function(e){var t=e.ref,r=W(e,["ref"]);return s.createElement(u.Z,q({className:"text-capitalize mb-2"},r),s.createElement("span",{ref:t},n.state.user.createdBy.name))}))),s.createElement("div",{className:"text-center mt-3"},this.canEdit||this.canEditOwnPassword?s.createElement(l.Z,{className:"mr-2",as:R.rU,to:(null!==(t=D.$w.passwd.link)&&void 0!==t?t:D.$w.passwd.route)+this.state.user.id.toString()},s.createElement(A.Z,{id:"routes.passwd"})):"",this.canEdit?s.createElement(l.Z,{variant:this.state.user.enabled?"danger":"success",onClick:re((function*(){n.setState({saving:!0});var e=yield T.Z.editUser({enabled:!n.state.user.enabled,id:n.state.user.id});e.code==_.G.OK?n.loadUser(e.payload):n.addError(e.error),n.setState({saving:!1})}))},s.createElement(A.Z,{id:this.state.user.enabled?"generic.disable":"generic.enable"})):""))),s.createElement(h.Z,{eventKey:"adminperms",title:s.createElement(A.Z,{id:"perms.admin"})},this.renderPerms("permsadmin","admin")),s.createElement(h.Z,{eventKey:"instanceperms",title:s.createElement(A.Z,{id:"perms.instance"})},this.renderPerms("permsinstance","instance")),s.createElement(h.Z,{eventKey:"group",title:s.createElement(A.Z,{id:"perms.group"})},this.renderGroups()),this.renderOAuth())):"")}},{key:"renderOAuth",value:function(){var e,t,n,r,o,c=this,u=this.context.serverInfo.oAuthProviderInfos,f=null!==(e=this.state.newOAuthConnections)&&void 0!==e?e:null===(t=this.state.user)||void 0===t?void 0:t.oAuthConnections;if("admin"===(null===(n=this.state.user)||void 0===n?void 0:n.name.toLowerCase())||null==f||!u||!Object.keys(u).length)return null;var v=function(){var e=re((function*(){if(c.setState({saving:!0}),c.state.user){var e=yield T.Z.editUser({id:c.state.user.id,oAuthConnections:c.state.newOAuthConnections});e.code==_.G.OK?c.loadUser(e.payload):c.addError(e.error),c.setState({saving:!1})}else c.addError(new U.ZP(U.jK.APP_FAIL,{jsError:Error("this.state.user is null in user edit save")}))}));return function(){return e.apply(this,arguments)}}(),E=this.canEdit||this.canEditOwnOAuth;return s.createElement(h.Z,{eventKey:"oauth",title:s.createElement(A.Z,{id:"view.user.edit.oauth.connections"})},s.createElement("h3",{className:"mb-3"},s.createElement(A.Z,{id:"view.user.edit.oauth.current"})),s.createElement("div",null,this.state.newOAuthConnections.map((function(e,t){return s.createElement("div",{className:"justify-content-center d-flex",key:t},s.createElement(p.Z,{className:"w-75 mb-1"},s.createElement(p.Z.Prepend,null,s.createElement(p.Z.Text,null,s.createElement("span",null,s.createElement(A.Z,{id:"view.user.edit.oauth.provider"})))),s.createElement(d.Z.Control,{className:"flex-grow-1 flex-md-grow-0 w-50 w-md-auto ",as:"select",custom:!0,disabled:!E,onChange:function(e){var n=e.target.value;c.setState((function(e){return{newOAuthConnections:e.newOAuthConnections.map((function(e,r){return r!==t?e:J(J({},e),{},{provider:n})}))}}))}},Object.keys(u).map((function(t){return s.createElement(A.Z,{key:t,id:"view.user.edit.oauth.provider.".concat(t.toLowerCase())},(function(n){return s.createElement("option",{value:t,selected:e.provider===t},n)}))}))),s.createElement(p.Z.Text,{className:"rounded-0"},s.createElement(A.Z,{id:"view.user.edit.oauth.id"})),s.createElement(m.Z,{className:"",value:e.externalUserId,onChange:function(e){var n=e.target.value;c.setState((function(e){return{newOAuthConnections:e.newOAuthConnections.map((function(e,r){return r!==t?e:J(J({},e),{},{externalUserId:n})}))}}))},disabled:!E}),s.createElement(p.Z.Append,{className:""},s.createElement(l.Z,{variant:"danger",className:"text-darker",hidden:!E,onClick:function(){c.setState((function(e){return{newOAuthConnections:e.newOAuthConnections.filter((function(e,n){return t!==n}))}}))}},s.createElement("div",null,s.createElement(i.G,{icon:a.$}))))))}))),E?s.createElement("div",{className:"text-center mt-3"},s.createElement(l.Z,{className:"mr-2",onClick:function(){c.setState((function(e){return{newOAuthConnections:[].concat(Y(e.newOAuthConnections),[{provider:Object.keys(u)[0],externalUserId:""}])}}))}},s.createElement(A.Z,{id:"view.user.edit.oauth.add"})),s.createElement(l.Z,{onClick:v,variant:"success",disabled:this.state.newOAuthConnections.some((function(e){return 0===e.externalUserId.trim().length}))||this.state.newOAuthConnections.every((function(e,t){var n,r,a,i,s,o;return e.externalUserId===(null===(n=(null!==(r=null===(a=c.state.user)||void 0===a?void 0:a.oAuthConnections)&&void 0!==r?r:[])[t])||void 0===n?void 0:n.externalUserId)&&e.provider===(null===(i=(null!==(s=null===(o=c.state.user)||void 0===o?void 0:o.oAuthConnections)&&void 0!==s?s:[])[t])||void 0===i?void 0:i.provider)}))&&this.state.newOAuthConnections.length===(null===(r=this.state.user)||void 0===r||null===(o=r.oAuthConnections)||void 0===o?void 0:o.length)},s.createElement(A.Z,{id:"generic.savepage"}))):"")}},{key:"renderGroups",value:function(){var e,t=this;return this.state.user&&this.state.groups?s.createElement("div",null,this.canRead?null:s.createElement(o.Z,{className:"clearfix",variant:"error"},s.createElement(A.Z,{id:"perms.group.cantlist"})),s.createElement("h3",{className:"mb-3"},s.createElement(A.Z,{id:"perms.group.current"}),this.state.user.group?this.state.user.group.name:s.createElement(A.Z,{id:"perms.group.none"})),s.createElement("div",{onChange:this.changeGroup},s.createElement(p.Z,{className:"justify-content-center mb-3",as:"label",htmlFor:"group_none"},s.createElement(p.Z.Prepend,null,s.createElement(p.Z.Radio,{id:"group_none",name:"group",defaultChecked:void 0===(null===(e=this.state.user.group)||void 0===e?void 0:e.id),disabled:!this.canEdit})),s.createElement(p.Z.Append,{className:"w-40 overflow-auto"},s.createElement(p.Z.Text,{className:"flex-fill"},s.createElement(A.Z,{id:"perms.group.none"})))),this.state.groups.map((function(e){var n,r,o,c;return s.createElement(p.Z,{className:"justify-content-center mb-1",key:e.id},s.createElement(p.Z.Prepend,null,s.createElement(p.Z.Radio,{id:"group-"+e.id.toString(),name:"group",defaultChecked:(null===(n=t.state.user.group)||void 0===n?void 0:n.id)===e.id,disabled:!t.canEdit})),s.createElement(p.Z.Append,{className:"w-40 overflow-auto"},s.createElement(p.Z.Text,{className:"flex-fill",as:"label",htmlFor:"group-"+e.id.toString()},s.createElement("span",null,e.name),s.createElement("div",{className:"text-right ml-auto"},s.createElement(A.Z,{id:"generic.numusers",values:{count:t.canRead?null===(r=e.users)||void 0===r?void 0:r.length:"???"}}))),s.createElement(f.Z,{overlay:s.createElement(k.Z,{id:"".concat(e.id,"-tooltip")},s.createElement(A.Z,{id:"perms.group.delete.warning"})),show:!!(null!==(o=e.users)&&void 0!==o&&o.length&&t.canEdit||e.id===(null===(c=t.state.user.group)||void 0===c?void 0:c.id))&&void 0},(function(n){var r,o,c=n.ref,u=W(n,["ref"]);return s.createElement(l.Z,q({variant:"danger",className:"text-darker",disabled:!(null===(r=e.users)||void 0===r||!r.length)||!t.canEdit||e.id===(null===(o=t.state.user.group)||void 0===o?void 0:o.id),onClick:function(){t.deleteGroup(e.id)}},u),s.createElement("div",{ref:c},s.createElement(i.G,{icon:a.$})))}))))}))),s.createElement(p.Z,{className:"justify-content-center mb-1 mt-5"},s.createElement(p.Z.Prepend,null,s.createElement(l.Z,{variant:"primary",onClick:this.createGroup,disabled:!this.canEdit||!this.state.createGroupName.length},s.createElement(i.G,{icon:r.r8}))),s.createElement(m.Z,{className:"w-40 overflow-auto flex-grow-0",value:this.state.createGroupName,onChange:function(e){t.setState({createGroupName:e.target.value})},disabled:!this.canEdit}))):s.createElement($.Z,{error:new U.ZP(U.jK.APP_FAIL,{jsError:Error("Assertion failed, user or group is null")})})}},{key:"changeGroup",value:(y=re((function*(e){if(this.state.user){this.setState({loading:!0});var t=e.target.id;if("group_none"===t){var n=yield T.Z.editUser({id:this.state.user.id,permissionSet:(0,z.Zg)(this.state.user)});n.code===_.G.OK?(yield this.loadGroups(),this.loadUser(n.payload)):this.addError(n.error)}else{var r=parseInt(t.substr(6)),a=yield T.Z.editUser({id:this.state.user.id,group:{id:r}});a.code===_.G.OK?(yield this.loadGroups(),this.loadUser(a.payload)):this.addError(a.error)}this.setState({loading:!1})}else this.addError(new U.ZP(U.jK.APP_FAIL,{jsError:Error("this.state.user is null in changegroup")}))})),function(e){return y.apply(this,arguments)})},{key:"deleteGroup",value:(g=re((function*(e){this.setState({loading:!0});var t=yield F.Z.deleteGroup(e);t.code===_.G.OK?this.setState((function(t){return{groups:t.groups.filter((function(t){return t.id!==e}))}})):this.addError(t.error),this.setState({loading:!1})})),function(e){return g.apply(this,arguments)})},{key:"createGroup",value:(E=re((function*(){this.setState({loading:!0});var e=yield F.Z.createGroup(this.state.createGroupName,(0,z.Zg)(this.state.user));e.code===_.G.OK?this.setState((function(t){return{groups:t.groups.concat([e.payload])}})):this.addError(e.error),this.setState({loading:!1})})),function(){return E.apply(this,arguments)})},{key:"renderPerms",value:function(e,t){var n,r=this,a={},c=function(e,t,n){e.current&&t.current&&(e.current.checked!==n?t.current.classList.add("font-weight-bold"):t.current.classList.remove("font-weight-bold"))},m=function(t){return function(){for(var n=0,i=Object.entries(a);n<i.length;n++){var s=X(i[n],2),o=s[0],l=s[1];if(!l.input.current)return;l.input.current.checked=t,c(l.input,l.field,r.state[e][o].currentVal)}}},v=function(){var t=re((function*(){r.setState({saving:!0});for(var t=0,n=0,i=Object.entries(a);n<i.length;n++){var s=X(i[n],2),o=s[0],c=s[1];c.input.current&&(t+=c.input.current.checked?r.state[e][o].bitflag:0)}if(r.state.user){if(r.state.user.group){var l=Object.assign(Object.assign({},r.state.user.group.permissionSet),Q({},"permsadmin"==e?"AdministrationRights":"InstanceManagerRights",t)),u=yield F.Z.updateGroup({id:r.state.user.group.id,permissionSet:l});if(u.code==_.G.OK){var d=yield T.Z.getUser(r.state.user.id);d.code==_.G.OK?r.loadUser(d.payload):r.addError(d.error)}else r.addError(u.error)}else{var m=Object.assign(Object.assign({},r.state.user.permissionSet),Q({},"permsadmin"==e?"AdministrationRights":"InstanceManagerRights",t)),p=yield T.Z.editUser({id:r.state.user.id,permissionSet:m});p.code==_.G.OK?r.loadUser(p.payload):r.addError(p.error)}r.setState({saving:!1})}else r.addError(new U.ZP(U.jK.APP_FAIL,{jsError:Error("this.state.user is null in user edit save")}))}));return function(){return t.apply(this,arguments)}}();return s.createElement(s.Fragment,null,null!==(n=this.state.user)&&void 0!==n&&n.group?s.createElement(o.Z,{variant:"warning"},s.createElement(A.Z,{id:"perms.group.warning",values:{group:"".concat(this.state.user.group.name," (").concat(this.state.user.group.id,")")}})):null,this.canEdit?s.createElement(s.Fragment,null,s.createElement("h5",null,s.createElement(A.Z,{id:"generic.setall"})),s.createElement(l.Z,{onClick:m(!0)},s.createElement(A.Z,{id:"generic.true"}))," ",s.createElement(l.Z,{onClick:m(!1)},s.createElement(A.Z,{id:"generic.false"}))," ",s.createElement(l.Z,{onClick:function(){for(var t=0,n=Object.entries(a);t<n.length;t++){var i=X(n[t],2),s=i[0],o=i[1];o.input.current&&(o.input.current.checked=r.state[e][s].currentVal,c(o.input,o.field,r.state[e][s].currentVal))}}},s.createElement(A.Z,{id:"generic.reset"}))):"",s.createElement(u.Z,{md:8,lg:7,xl:6,className:"mx-auto"},s.createElement("hr",null),Object.entries(this.state[e]).map((function(e){var n=X(e,2),o=n[0],l=n[1],u=s.createRef(),m=s.createRef();return a[o]={input:u,field:m},s.createElement(p.Z,{key:o,as:"label",htmlFor:o,className:"mb-0"},s.createElement(p.Z.Prepend,{className:"flex-grow-1 overflow-auto"},s.createElement(f.Z,{overlay:s.createElement(k.Z,{id:"perms.".concat(t,".").concat(o,".desc")},s.createElement(A.Z,{id:"perms.".concat(t,".").concat(o,".desc")}))},(function(e){var n=e.ref,a=W(e,["ref"]);return s.createElement(p.Z.Text,{className:"flex-fill",ref:m},s.createElement("div",a,s.createElement(A.Z,{id:"perms.".concat(t,".").concat(o)})),s.createElement("div",{className:"ml-auto d-flex align-items-center"},s.createElement(d.Z.Check,{inline:!0,type:"switch",custom:!0,id:o,className:"d-flex justify-content-center align-content-center mx-2",label:"",ref:u,disabled:!r.canEdit,defaultChecked:l.currentVal,onChange:function(){c(u,m,l.currentVal)}}),s.createElement("div",q({},a,{ref:n}),s.createElement(i.G,{fixedWidth:!0,icon:"info"}))))}))))})),s.createElement("hr",null)),this.canEdit?s.createElement(l.Z,{onClick:v},s.createElement(A.Z,{id:"generic.savepage"})):"")}}])&&ae(t.prototype,n),N}(s.Component);le.contextType=L.f;var ue=(0,I.EN)(le)},27977:function(e,t,n){"use strict";var r=n(22122),a=n(19756),i=n(94184),s=n.n(i),o=n(67294),c=n(76792),l=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.variant,l=e.pill,u=e.className,d=e.as,m=void 0===d?"span":d,p=(0,a.Z)(e,["bsPrefix","variant","pill","className","as"]),f=(0,c.vE)(n,"badge");return o.createElement(m,(0,r.Z)({ref:t},p,{className:s()(u,f,l&&f+"-pill",i&&f+"-"+i)}))}));l.displayName="Badge",l.defaultProps={pill:!1},t.Z=l},62318:function(e,t,n){"use strict";var r=n(19756),a=n(22122),i=n(94184),s=n.n(i),o=n(67294),c=n(44680),l=n(76792),u=(0,c.Z)("input-group-append"),d=(0,c.Z)("input-group-prepend"),m=(0,c.Z)("input-group-text",{Component:"span"}),p=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.size,c=e.className,u=e.as,d=void 0===u?"div":u,m=(0,r.Z)(e,["bsPrefix","size","className","as"]);return n=(0,l.vE)(n,"input-group"),o.createElement(d,(0,a.Z)({ref:t},m,{className:s()(c,n,i&&n+"-"+i)}))}));p.displayName="InputGroup";var f=(0,a.Z)({},p,{Text:m,Radio:function(e){return o.createElement(m,null,o.createElement("input",(0,a.Z)({type:"radio"},e)))},Checkbox:function(e){return o.createElement(m,null,o.createElement("input",(0,a.Z)({type:"checkbox"},e)))},Append:u,Prepend:d});t.Z=f},34051:function(e,t,n){"use strict";var r=n(22122),a=n(19756),i=n(94184),s=n.n(i),o=n(67294),c=n(76792),l=["xl","lg","md","sm","xs"],u=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.className,u=e.noGutters,d=e.as,m=void 0===d?"div":d,p=(0,a.Z)(e,["bsPrefix","className","noGutters","as"]),f=(0,c.vE)(n,"row"),v=f+"-cols",h=[];return l.forEach((function(e){var t,n=p[e];delete p[e];var r="xs"!==e?"-"+e:"";null!=(t=null!=n&&"object"==typeof n?n.cols:n)&&h.push(""+v+r+"-"+t)})),o.createElement(m,(0,r.Z)({ref:t},p,{className:s().apply(void 0,[i,f,u&&"no-gutters"].concat(h))}))}));u.displayName="Row",u.defaultProps={noGutters:!1},t.Z=u},56841:function(e,t,n){"use strict";var r=n(41788),a=n(67294),i=n(97184),s=n(28752),o=n(75103),c=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")},t}(a.Component);c.Container=i.Z,c.Content=s.Z,c.Pane=o.Z,t.Z=c},97184:function(e,t,n){"use strict";var r=n(67294),a=n(14289),i=n(24426),s=n(45017);t.Z=function(e){var t=(0,a.Ch)(e,{activeKey:"onSelect"}),n=t.id,o=t.generateChildId,c=t.onSelect,l=t.activeKey,u=t.transition,d=t.mountOnEnter,m=t.unmountOnExit,p=t.children,f=(0,r.useMemo)((function(){return o||function(e,t){return n?n+"-"+t+"-"+e:null}}),[n,o]),v=(0,r.useMemo)((function(){return{onSelect:c,activeKey:l,transition:u,mountOnEnter:d||!1,unmountOnExit:m||!1,getControlledId:function(e){return f(e,"tabpane")},getControllerId:function(e){return f(e,"tab")}}}),[c,l,u,d,m,f]);return r.createElement(i.Z.Provider,{value:v},r.createElement(s.Z.Provider,{value:c||null},p))}},28752:function(e,t,n){"use strict";var r=n(22122),a=n(19756),i=n(94184),s=n.n(i),o=n(67294),c=n(76792),l=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.as,l=void 0===i?"div":i,u=e.className,d=(0,a.Z)(e,["bsPrefix","as","className"]),m=(0,c.vE)(n,"tab-content");return o.createElement(l,(0,r.Z)({ref:t},d,{className:s()(u,m)}))}));t.Z=l},75103:function(e,t,n){"use strict";var r=n(22122),a=n(19756),i=n(94184),s=n.n(i),o=n(67294),c=n(76792),l=n(24426),u=n(45017),d=n(41068),m=o.forwardRef((function(e,t){var n=function(e){var t=(0,o.useContext)(l.Z);if(!t)return e;var n=t.activeKey,i=t.getControlledId,s=t.getControllerId,c=(0,a.Z)(t,["activeKey","getControlledId","getControllerId"]),m=!1!==e.transition&&!1!==c.transition,p=(0,u.h)(e.eventKey);return(0,r.Z)({},e,{active:null==e.active&&null!=p?(0,u.h)(n)===p:e.active,id:i(e.eventKey),"aria-labelledby":s(e.eventKey),transition:m&&(e.transition||c.transition||d.Z),mountOnEnter:null!=e.mountOnEnter?e.mountOnEnter:c.mountOnEnter,unmountOnExit:null!=e.unmountOnExit?e.unmountOnExit:c.unmountOnExit})}(e),i=n.bsPrefix,m=n.className,p=n.active,f=n.onEnter,v=n.onEntering,h=n.onEntered,E=n.onExit,g=n.onExiting,y=n.onExited,Z=n.mountOnEnter,b=n.unmountOnExit,O=n.transition,w=n.as,x=void 0===w?"div":w,N=(n.eventKey,(0,a.Z)(n,["bsPrefix","className","active","onEnter","onEntering","onEntered","onExit","onExiting","onExited","mountOnEnter","unmountOnExit","transition","as","eventKey"])),C=(0,c.vE)(i,"tab-pane");if(!p&&!O&&b)return null;var S=o.createElement(x,(0,r.Z)({},N,{ref:t,role:"tabpanel","aria-hidden":!p,className:s()(m,C,{active:p})}));return O&&(S=o.createElement(O,{in:p,onEnter:f,onEntering:v,onEntered:h,onExit:E,onExiting:g,onExited:y,mountOnEnter:Z,unmountOnExit:b},S)),o.createElement(l.Z.Provider,{value:null},o.createElement(u.Z.Provider,{value:null},S))}));m.displayName="TabPane",t.Z=m}}]);
//# sourceMappingURL=253.8c145ea63f67bc43b5c1.js.map