"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[12,327],{9657:function(e,t,r){r.d(t,{Z:function(){return z}});var n=r(67814),o=r(67294),a=r(35005),i=r(32258),s=r(15293),l=r(87462),c=r(63366),u=r(94184),p=r.n(u),f=r(76792),d=r(48358),m=["active","disabled","className","style","activeLabel","children"],h=["children"],v=o.forwardRef((function(e,t){var r=e.active,n=e.disabled,a=e.className,i=e.style,s=e.activeLabel,u=e.children,f=(0,c.Z)(e,m),h=r||n?"span":d.Z;return o.createElement("li",{ref:t,style:i,className:p()(a,"page-item",{active:r,disabled:n})},o.createElement(h,(0,l.Z)({className:"page-link",disabled:n},f),u,r&&s&&o.createElement("span",{className:"sr-only"},s)))}));v.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},v.displayName="PageItem";var y=v;function g(e,t,r){function n(e){var n=e.children,a=(0,c.Z)(e,h);return o.createElement(v,a,o.createElement("span",{"aria-hidden":"true"},n||t),o.createElement("span",{className:"sr-only"},r))}return void 0===r&&(r=e),n.displayName=e,n}var b=g("First","«"),E=g("Prev","‹","Previous"),P=g("Ellipsis","…","More"),w=g("Next","›"),x=g("Last","»"),Z=["bsPrefix","className","children","size"],O=o.forwardRef((function(e,t){var r=e.bsPrefix,n=e.className,a=e.children,i=e.size,s=(0,c.Z)(e,Z),u=(0,f.vE)(r,"pagination");return o.createElement("ul",(0,l.Z)({ref:t},s,{className:p()(n,u,i&&u+"-"+i)}),a)}));O.First=b,O.Prev=E,O.Ellipsis=P,O.Item=y,O.Next=w,O.Last=x;var N=O,S=(r(55638),["as","bsPrefix","className","children"]),j=o.forwardRef((function(e,t){var r=e.as,n=void 0===r?"div":r,a=e.bsPrefix,i=e.className,s=e.children,u=(0,c.Z)(e,S);return a=(0,f.vE)(a,"popover-header"),o.createElement(n,(0,l.Z)({ref:t},u,{className:p()(a,i)}),s)})),V=["as","bsPrefix","className","children"],k=o.forwardRef((function(e,t){var r=e.as,n=void 0===r?"div":r,a=e.bsPrefix,i=e.className,s=e.children,u=(0,c.Z)(e,V);return a=(0,f.vE)(a,"popover-body"),o.createElement(n,(0,l.Z)({ref:t},u,{className:p()(i,a)}),s)})),C=["bsPrefix","placement","className","style","children","content","arrowProps","popper","show"],R=o.forwardRef((function(e,t){var r=e.bsPrefix,n=e.placement,a=e.className,i=e.style,s=e.children,u=e.content,d=e.arrowProps,m=(e.popper,e.show,(0,c.Z)(e,C)),h=(0,f.vE)(r,"popover"),v=((null==n?void 0:n.split("-"))||[])[0];return o.createElement("div",(0,l.Z)({ref:t,role:"tooltip",style:i,"x-placement":v,className:p()(a,h,v&&"bs-popover-"+v)},m),o.createElement("div",(0,l.Z)({className:"arrow"},d)),u?o.createElement(k,null,s):s)}));R.defaultProps={placement:"right"},R.Title=j,R.Content=k;var _=R,A=r(44012);function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}var I=["selectPage","totalPages","currentPage"];function M(){return M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M.apply(this,arguments)}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function F(e,t){return F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},F(e,t)}function D(e,t){if(t&&("object"===G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(p,e);var t,r,l,c,u=(l=p,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(l);if(c){var r=L(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return D(this,e)});function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e)).state={showGoto:!1,gotoValue:e.currentPage},t}return t=p,(r=[{key:"render",value:function(){for(var e=this,t=[],r=Math.max(this.props.totalPages-this.props.currentPage-1,0),l=Math.max(this.props.currentPage-2,0),c=Math.max(this.props.currentPage-Math.max(5-Number(this.props.currentPage!==this.props.totalPages)-r,2),2),u=Math.min(this.props.currentPage+Math.max(5-Number(1!==this.props.currentPage)-l,2),this.props.totalPages-1),p=function(r){t.push(o.createElement(N.Item,{key:r,active:r===e.props.currentPage,onClick:function(){return e.props.selectPage(r)}},r))},f=c;f<=u;f++)p(f);var d=this.props.totalPages>7?o.createElement(N.Ellipsis,{disabled:!0}):null,m=o.createElement(_,{id:"popover-gotopage"},o.createElement(_.Title,null,o.createElement(A.Z,{id:"generic.goto.title"})),o.createElement(_.Content,null,o.createElement("form",{className:"d-flex",onSubmit:function(t){t.preventDefault(),e.props.selectPage(e.state.gotoValue),e.setState({showGoto:!1})}},o.createElement(i.Z.Control,{className:"mr-2",type:"number",min:1,max:this.props.totalPages,value:this.state.gotoValue,onChange:function(t){return e.setState({gotoValue:parseInt(t.target.value)})},custom:!0}),o.createElement(a.Z,{type:"submit"},o.createElement(A.Z,{id:"generic.goto"}))))),h=this.props,v=(h.selectPage,h.totalPages,h.currentPage,function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(h,I));return o.createElement("div",M({className:"text-center",style:{position:"sticky",bottom:"1.5em"}},v),o.createElement(N,{className:"justify-content-center"},o.createElement(N.Prev,{disabled:this.props.currentPage<=1,onClick:function(){return e.props.selectPage(Math.max(e.props.currentPage-1,1))}}),o.createElement(N.Item,{active:this.props.currentPage<=1,onClick:function(){return e.props.selectPage(1)}},"1"),d,t,d,this.props.totalPages>=2?o.createElement(N.Item,{active:this.props.currentPage>=this.props.totalPages,onClick:function(){return e.props.selectPage(e.props.totalPages)}},this.props.totalPages):null,this.props.totalPages>7?o.createElement(s.Z,{show:this.state.showGoto,placement:"top",overlay:m},o.createElement(N.Item,{onClick:function(){return e.setState((function(e){return{showGoto:!e.showGoto}}))}},o.createElement(n.G,{icon:"search"}))):null,o.createElement(N.Next,{disabled:this.props.currentPage>=this.props.totalPages,onClick:function(){return e.props.selectPage(Math.min(e.props.currentPage+1,e.props.totalPages))}})))}}])&&T(t.prototype,r),p}(o.PureComponent)},59012:function(e,t,r){r.r(t);var n=r(67814),o=r(67294),a=r(35005),i=r(32258),s=r(94716),l=r(62318),c=r(15293),u=r(43489),p=r(44012),f=r(91201),d=r(48155),m=r(36800),h=r(38592),v=r(49896),y=r(3429),g=r(65562),b=r(43307),E=r(71739),P=r(9657);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}var x=["ref"];function Z(){return Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Z.apply(this,arguments)}function O(e,t,r,n,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function N(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){O(a,n,o,i,s,"next",e)}function s(e){O(a,n,o,i,s,"throw",e)}i(void 0)}))}}function S(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function j(e,t){return j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},j(e,t)}function V(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(A,e);var t,r,v,w,O,C,R,_=(C=A,R=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=k(C);if(R){var r=k(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return V(this,e)});function A(e){var t,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,A),(r=_.call(this,e)).state={versions:[],errors:[],activeVersion:"",latestVersion:"",selectedVersion:"",loading:!0,page:null!==(t=y.Mq.byondlistpage)&&void 0!==t?t:1},r}return t=A,r=[{key:"addError",value:function(e){this.setState((function(t){var r=Array.from(t.errors);return r.push(e),{errors:r}}))}},{key:"loadVersions",value:(O=N((function*(){var e=yield f.Z.listAllVersions(this.context.instance.id,{page:this.state.page});if(e.code===h.G.OK){if(this.state.page>e.payload.totalPages&&0!==e.payload.totalPages)return void this.setState({page:1});this.setState({versions:e.payload.content,maxPage:e.payload.totalPages});var t=yield f.Z.getActiveVersion(this.context.instance.id);t.code===h.G.OK?this.setState({activeVersion:t.payload.version}):this.addError(t.error)}else this.addError(e.error)})),function(){return O.apply(this,arguments)})},{key:"componentDidUpdate",value:(w=N((function*(e,t){t.page!==this.state.page&&(y.Mq.byondlistpage=this.state.page,yield this.loadVersions())})),function(e,t){return w.apply(this,arguments)})},{key:"componentDidMount",value:(v=N((function*(){var e=this;yield this.loadVersions(),fetch("https://secure.byond.com/download/version.txt").then((function(e){return e.text()})).then((function(e){return e.split("\n")})).then((function(e){return e[0]})).then((function(t){e.setState({latestVersion:t,selectedVersion:t,loading:!1})})).catch((function(t){e.addError(new m.ZP(m.jK.APP_FAIL,{jsError:Error(t)})),e.setState({loading:!1})}))})),function(){return v.apply(this,arguments)})},{key:"render",value:function(){var e,t=this;return this.state.loading?o.createElement(E.Z,{text:"loading.instance"}):this.context.instancePermissionSet.byondRights&d.D8.ListInstalled&&this.context.instancePermissionSet.byondRights&d.D8.ReadActive?o.createElement("div",{className:"text-center"},o.createElement("h1",null,o.createElement(p.Z,{id:"view.instance.byond"})),this.state.errors.map((function(e,r){if(e)return o.createElement(b.Z,{key:r,error:e,onClose:function(){return t.setState((function(e){var t=Array.from(e.errors);return t[r]=void 0,{errors:t}}))}})})),o.createElement("div",{onChange:function(){var e=N((function*(e){t.setState({loading:!0});var r=yield f.Z.switchActive(t.context.instance.id,e.target.value);r.code===h.G.OK?yield t.loadVersions():t.addError(r.error),t.setState({loading:!1})}));return function(t){return e.apply(this,arguments)}}()},this.state.versions.map((function(e){return o.createElement(l.Z,{className:"w-md-25 mb-1 mx-auto d-flex",key:e.version},o.createElement(l.Z.Prepend,null,o.createElement(l.Z.Radio,{disabled:!(t.context.instancePermissionSet.byondRights&d.D8.InstallOfficialOrChangeActiveVersion),name:"byond",id:e.version,value:e.version,defaultChecked:e.version===t.state.activeVersion})),o.createElement(l.Z.Append,{className:"flex-grow-1 m-0",as:"label",htmlFor:e.version},o.createElement(c.Z,{overlay:(r="view.instance.byond.custom",o.createElement(u.Z,{id:r},o.createElement(p.Z,{id:r}))),show:!e.version.endsWith(".0")&&void 0},(function(t){var r=t.ref,a=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(t,x);return o.createElement(l.Z.Text,Z({className:"w-100"},a),e.version.endsWith(".0")?e.version.substr(0,e.version.length-2):e.version,e.version.endsWith(".0")?null:o.createElement("div",{className:"ml-auto",ref:r},o.createElement(n.G,{fixedWidth:!0,icon:"info"})))}))));var r}))),o.createElement(P.Z,{className:"mt-4",selectPage:function(e){return t.setState({page:e})},totalPages:null!==(e=this.state.maxPage)&&void 0!==e?e:1,currentPage:this.state.page}),o.createElement("hr",null),o.createElement("h4",null,o.createElement(p.Z,{id:"view.instance.byond.add"})),o.createElement(l.Z,{className:"w-md-50 w-lg-25 mb-3 mx-auto"},o.createElement(s.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[0],onChange:function(e){t.setState((function(t){var r=t.selectedVersion.split(".");return r[0]=e.target.value,{selectedVersion:r.join(".")}}))}}),o.createElement(l.Z.Text,{className:"rounded-0"},"."),o.createElement(s.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[1],onChange:function(e){t.setState((function(t){var r=t.selectedVersion.split(".");return r[1]=e.target.value,{selectedVersion:r.join(".")}}))}}),o.createElement(l.Z.Append,null,o.createElement(a.Z,{variant:"success",onClick:N((function*(){t.setState({loading:!0});var e=yield f.Z.switchActive(t.context.instance.id,t.state.selectedVersion,t.state.customFile?yield t.state.customFile.arrayBuffer():void 0);e.code===h.G.ERROR?t.addError(e.error):(t.setState({customFile:null}),yield t.loadVersions()),t.setState({loading:!1})}))},o.createElement(n.G,{icon:"plus"})))),o.createElement(i.Z,null,o.createElement(i.Z.File,{custom:!0,id:"test",className:"w-md-50 w-lg-25 text-left",label:this.state.customFile?this.state.customFile.name:o.createElement(p.Z,{id:"view.instance.byond.upload"}),accept:".zip",onChange:function(e){t.setState({customFile:e.target.files?e.target.files[0]:null})}}))):o.createElement(g.Z,null)}}],r&&S(t.prototype,r),A}(o.Component);C.contextType=v.g,t.default=C},49896:function(e,t,r){r.d(t,{g:function(){return n}});var n=r(67294).createContext(void 0)},62318:function(e,t,r){var n=r(63366),o=r(87462),a=r(94184),i=r.n(a),s=r(67294),l=r(44680),c=r(76792),u=["bsPrefix","size","hasValidation","className","as"],p=(0,l.Z)("input-group-append"),f=(0,l.Z)("input-group-prepend"),d=(0,l.Z)("input-group-text",{Component:"span"}),m=s.forwardRef((function(e,t){var r=e.bsPrefix,a=e.size,l=e.hasValidation,p=e.className,f=e.as,d=void 0===f?"div":f,m=(0,n.Z)(e,u);return r=(0,c.vE)(r,"input-group"),s.createElement(d,(0,o.Z)({ref:t},m,{className:i()(p,r,a&&r+"-"+a,l&&"has-validation")}))}));m.displayName="InputGroup",m.Text=d,m.Radio=function(e){return s.createElement(d,null,s.createElement("input",(0,o.Z)({type:"radio"},e)))},m.Checkbox=function(e){return s.createElement(d,null,s.createElement("input",(0,o.Z)({type:"checkbox"},e)))},m.Append=p,m.Prepend=f,t.Z=m}}]);
//# sourceMappingURL=12.876d3f3dc174132a73fd.js.map