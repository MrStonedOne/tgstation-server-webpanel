"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[359],{83359:function(t,e,r){r.r(e);var n=r(67294),o=r(35005),s=r(31555),a=r(32258),i=r(44012),u=r(5977),c=r(39248),l=r(36800),d=r(38592),p=r(65022),h=r(69644),f=r(32826),m=r(43307),y=r(71739);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function E(t,e,r,n,o,s,a){try{var i=t[s](a),u=i.value}catch(t){return void r(t)}i.done?e(u):Promise.resolve(u).then(n,o)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var s=t.apply(e,r);function a(t){E(s,n,o,a,i,"next",t)}function i(t){E(s,n,o,a,i,"throw",t)}a(void 0)}))}}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function g(t,e){return g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},g(t,e)}function Z(t,e){if(e&&("object"===w(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}function S(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}var _=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(k,t);var e,r,u,f,w,E,_=(w=k,E=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=P(w);if(E){var r=P(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Z(this,t)});function k(t,e){var r,n;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,k),r=_.call(this,t),null==e||!e.user)throw Error("ChangePassword: this.context?.user is null!");return n=t.match.params.id?parseInt(t.match.params.id):e.user.id,r.state={errors:[],password1:"",password2:"",userId:n,currentUser:e.user.id===n,loading:!0},r.submit=r.submit.bind(S(r)),r}return e=k,r=[{key:"componentDidMount",value:(f=v((function*(){var t=yield h.Z.getUser(this.state.userId);t.code==d.G.OK?this.setState({user:t.payload}):this.addError(t.error),this.setState({loading:!1})})),function(){return f.apply(this,arguments)})},{key:"addError",value:function(t){this.setState((function(e){var r=Array.from(e.errors);return r.push(t),{errors:r}}))}},{key:"submit",value:(u=v((function*(t){if(this.state.user){t.preventDefault();var e=!1;if(this.state.password1.length<this.context.serverInfo.minimumPasswordLength?(e=!0,this.setState({lengthError:!0})):this.setState({lengthError:!1}),this.state.password2!==this.state.password1?(e=!0,this.setState({matchError:!0})):this.setState({matchError:!1}),!e){this.setState({pwdload:!0});var r=yield h.Z.editUser({password:this.state.password1,id:this.state.user.id});switch(r.code){case d.G.OK:this.state.currentUser&&p.Z.login({type:c.P.Password,userName:this.state.user.name,password:this.state.password1}),this.props.history.goBack();break;case d.G.ERROR:this.addError(r.error),this.setState({pwdload:!1})}}}else this.addError(new l.ZP(l.jK.APP_FAIL,{jsError:Error("changepassword submit: this.user is falsy")}))})),function(t){return u.apply(this,arguments)})},{key:"render",value:function(){var t=this;return this.state.loading?n.createElement(y.Z,{text:"loading.info"}):this.state.pwdload?n.createElement(y.Z,{text:"loading.passwd"}):n.createElement(a.Z,{onSubmit:this.submit},n.createElement(s.Z,{className:"mx-auto",lg:5,md:8},this.state.errors.map((function(e,r){if(e)return n.createElement(m.Z,{key:r,error:e,onClose:function(){return t.setState((function(t){var e=Array.from(t.errors);return e[r]=void 0,{errors:e}}))}})})),this.state.user?n.createElement(n.Fragment,null,n.createElement("h3",null,n.createElement(i.Z,{id:"view.user.passwd.title"}),this.state.user.name,"(",this.state.user.id,")"),n.createElement("hr",null),n.createElement(a.Z.Group,{controlId:"password1"},n.createElement(a.Z.Label,null,n.createElement(i.Z,{id:"login.password"})),n.createElement(a.Z.Control,{type:"password",onChange:function(e){return t.setState({password1:e.target.value})},value:this.state.password1,isInvalid:this.state.matchError||this.state.lengthError}),n.createElement(a.Z.Control.Feedback,{type:"invalid"},this.state.lengthError?n.createElement(n.Fragment,null,n.createElement(i.Z,{id:"login.password.repeat.short"}),this.context.serverInfo.minimumPasswordLength):"")),n.createElement(a.Z.Group,{controlId:"password2"},n.createElement(a.Z.Label,null,n.createElement(i.Z,{id:"login.password.repeat"})),n.createElement(a.Z.Control,{type:"password",onChange:function(e){return t.setState({password2:e.target.value})},value:this.state.password2,isInvalid:this.state.matchError||this.state.lengthError}),n.createElement(a.Z.Control.Feedback,{type:"invalid"},this.state.matchError?n.createElement(i.Z,{id:"login.password.repeat.match"}):"")),n.createElement(o.Z,{type:"submit"},n.createElement(i.Z,{id:"routes.passwd"}))):""))}}],r&&b(e.prototype,r),k}(n.Component);_.contextType=f.f,e.default=(0,u.EN)(_)}}]);
//# sourceMappingURL=359.2b53040cdde1c30c28de.js.map