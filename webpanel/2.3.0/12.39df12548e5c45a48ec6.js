"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[12,327],{9657:function(e,t,n){n.d(t,{Z:function(){return z}});var r=n(67814),o=n(67294),a=n(35005),i=n(32258),s=n(15293),l=n(87462),c=n(63366),u=n(94184),p=n.n(u),f=n(76792),d=n(48358),m=["active","disabled","className","style","activeLabel","children"],v=["children"],h=o.forwardRef((function(e,t){var n=e.active,r=e.disabled,a=e.className,i=e.style,s=e.activeLabel,u=e.children,f=(0,c.Z)(e,m),v=n||r?"span":d.Z;return o.createElement("li",{ref:t,style:i,className:p()(a,"page-item",{active:n,disabled:r})},o.createElement(v,(0,l.Z)({className:"page-link",disabled:r},f),u,n&&s&&o.createElement("span",{className:"sr-only"},s)))}));h.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},h.displayName="PageItem";var y=h;function g(e,t,n){function r(e){var r=e.children,a=(0,c.Z)(e,v);return o.createElement(h,a,o.createElement("span",{"aria-hidden":"true"},r||t),o.createElement("span",{className:"sr-only"},n))}return void 0===n&&(n=e),r.displayName=e,r}var b=g("First","«"),E=g("Prev","‹","Previous"),P=g("Ellipsis","…","More"),w=g("Next","›"),x=g("Last","»"),Z=["bsPrefix","className","children","size"],O=o.forwardRef((function(e,t){var n=e.bsPrefix,r=e.className,a=e.children,i=e.size,s=(0,c.Z)(e,Z),u=(0,f.vE)(n,"pagination");return o.createElement("ul",(0,l.Z)({ref:t},s,{className:p()(r,u,i&&u+"-"+i)}),a)}));O.First=b,O.Prev=E,O.Ellipsis=P,O.Item=y,O.Next=w,O.Last=x;var N=O,S=(n(55638),["as","bsPrefix","className","children"]),j=o.forwardRef((function(e,t){var n=e.as,r=void 0===n?"div":n,a=e.bsPrefix,i=e.className,s=e.children,u=(0,c.Z)(e,S);return a=(0,f.vE)(a,"popover-header"),o.createElement(r,(0,l.Z)({ref:t},u,{className:p()(a,i)}),s)})),V=["as","bsPrefix","className","children"],_=o.forwardRef((function(e,t){var n=e.as,r=void 0===n?"div":n,a=e.bsPrefix,i=e.className,s=e.children,u=(0,c.Z)(e,V);return a=(0,f.vE)(a,"popover-body"),o.createElement(r,(0,l.Z)({ref:t},u,{className:p()(i,a)}),s)})),k=["bsPrefix","placement","className","style","children","content","arrowProps","popper","show"],C=o.forwardRef((function(e,t){var n=e.bsPrefix,r=e.placement,a=e.className,i=e.style,s=e.children,u=e.content,d=e.arrowProps,m=(e.popper,e.show,(0,c.Z)(e,k)),v=(0,f.vE)(n,"popover"),h=((null==r?void 0:r.split("-"))||[])[0];return o.createElement("div",(0,l.Z)({ref:t,role:"tooltip",style:i,"x-placement":h,className:p()(a,v,h&&"bs-popover-"+h)},m),o.createElement("div",(0,l.Z)({className:"arrow"},d)),u?o.createElement(_,null,s):s)}));C.defaultProps={placement:"right"},C.Title=j,C.Content=_;var R=C,I=n(44012);function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}var A=["selectPage","totalPages","currentPage"];function G(){return G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},G.apply(this,arguments)}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},T(e,t)}function D(e,t){if(t&&("object"===F(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function L(e){return L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},L(e)}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(p,e);var t,n,l,c,u=(l=p,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=L(l);if(c){var n=L(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return D(this,e)});function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e)).state={showGoto:!1,gotoValue:e.currentPage},t}return t=p,(n=[{key:"render",value:function(){for(var e=this,t=[],n=Math.max(this.props.totalPages-this.props.currentPage-1,0),l=Math.max(this.props.currentPage-2,0),c=Math.max(this.props.currentPage-Math.max(5-Number(this.props.currentPage!==this.props.totalPages)-n,2),2),u=Math.min(this.props.currentPage+Math.max(5-Number(1!==this.props.currentPage)-l,2),this.props.totalPages-1),p=function(n){t.push(o.createElement(N.Item,{key:n,active:n===e.props.currentPage,onClick:function(){return e.props.selectPage(n)}},n))},f=c;f<=u;f++)p(f);var d=this.props.totalPages>7?o.createElement(N.Ellipsis,{disabled:!0}):null,m=o.createElement(R,{id:"popover-gotopage"},o.createElement(R.Title,null,o.createElement(I.Z,{id:"generic.goto.title"})),o.createElement(R.Content,null,o.createElement("form",{className:"d-flex",onSubmit:function(t){t.preventDefault(),e.props.selectPage(e.state.gotoValue),e.setState({showGoto:!1})}},o.createElement(i.Z.Control,{className:"mr-2",type:"number",min:1,max:this.props.totalPages,value:this.state.gotoValue,onChange:function(t){return e.setState({gotoValue:parseInt(t.target.value)})},custom:!0}),o.createElement(a.Z,{type:"submit"},o.createElement(I.Z,{id:"generic.goto"}))))),v=this.props,h=(v.selectPage,v.totalPages,v.currentPage,function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(v,A));return o.createElement("div",G({className:"text-center",style:{position:"sticky",bottom:"1.5em"}},h),o.createElement(N,{className:"justify-content-center"},o.createElement(N.Prev,{disabled:this.props.currentPage<=1,onClick:function(){return e.props.selectPage(Math.max(e.props.currentPage-1,1))}}),o.createElement(N.Item,{active:this.props.currentPage<=1,onClick:function(){return e.props.selectPage(1)}},"1"),d,t,d,this.props.totalPages>=2?o.createElement(N.Item,{active:this.props.currentPage>=this.props.totalPages,onClick:function(){return e.props.selectPage(e.props.totalPages)}},this.props.totalPages):null,this.props.totalPages>7?o.createElement(s.Z,{show:this.state.showGoto,placement:"top",overlay:m},o.createElement(N.Item,{onClick:function(){return e.setState((function(e){return{showGoto:!e.showGoto}}))}},o.createElement(r.G,{icon:"search"}))):null,o.createElement(N.Next,{disabled:this.props.currentPage>=this.props.totalPages,onClick:function(){return e.props.selectPage(Math.min(e.props.currentPage+1,e.props.totalPages))}})))}}])&&M(t.prototype,n),p}(o.PureComponent)},59012:function(e,t,n){n.r(t);var r=n(67814),o=n(67294),a=n(35005),i=n(32258),s=n(94716),l=n(62318),c=n(15293),u=n(43489),p=n(44012),f=n(91201),d=n(48155),m=n(36800),v=n(38592),h=n(49896),y=n(42540),g=n(3429),b=n(43307),E=n(53041),P=n(71739),w=n(9657);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}var Z=["ref"];function O(){return O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O.apply(this,arguments)}function N(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){N(a,r,o,i,s,"next",e)}function s(e){N(a,r,o,i,s,"throw",e)}i(void 0)}))}}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t){return V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},V(e,t)}function _(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function k(e){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},k(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(F,e);var t,n,h,x,N,C,R,I=(C=F,R=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=k(C);if(R){var n=k(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _(this,e)});function F(e){var t,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,F),(n=I.call(this,e)).state={versions:[],errors:[],activeVersion:"",latestVersion:"",selectedVersion:"",loading:!0,page:null!==(t=g.Mq.byondlistpage)&&void 0!==t?t:1},n}return t=F,n=[{key:"addError",value:function(e){this.setState((function(t){var n=Array.from(t.errors);return n.push(e),{errors:n}}))}},{key:"loadVersions",value:(N=S((function*(){if((0,y.n5)(this.context.instancePermissionSet,d.D8.ListInstalled)){var e=yield f.Z.listAllVersions(this.context.instance.id,{page:this.state.page});if(e.code===v.G.OK){if(this.state.page>e.payload.totalPages&&0!==e.payload.totalPages)return void this.setState({page:1});this.setState({versions:e.payload.content,maxPage:e.payload.totalPages})}else this.addError(e.error)}if((0,y.n5)(this.context.instancePermissionSet,d.D8.ReadActive)){var t=yield f.Z.getActiveVersion(this.context.instance.id);t.code===v.G.OK?this.setState({activeVersion:t.payload.version}):this.addError(t.error)}})),function(){return N.apply(this,arguments)})},{key:"componentDidUpdate",value:(x=S((function*(e,t){t.page!==this.state.page&&(g.Mq.byondlistpage=this.state.page,yield this.loadVersions())})),function(e,t){return x.apply(this,arguments)})},{key:"componentDidMount",value:(h=S((function*(){var e=this;yield this.loadVersions(),fetch("https://secure.byond.com/download/version.txt").then((function(e){return e.text()})).then((function(e){return e.split("\n")})).then((function(e){return e[0]})).then((function(t){e.setState({latestVersion:t,selectedVersion:t,loading:!1})})).catch((function(t){e.addError(new m.ZP(m.jK.APP_FAIL,{jsError:Error(t)})),e.setState({loading:!1})}))})),function(){return h.apply(this,arguments)})},{key:"render",value:function(){var e,t=this;if(this.state.loading)return o.createElement(P.Z,{text:"loading.instance"});var n=(0,y.n5)(this.context.instancePermissionSet,d.D8.ListInstalled),m=(0,y.n5)(this.context.instancePermissionSet,d.D8.ReadActive),h=(0,y.n5)(this.context.instancePermissionSet,d.D8.InstallCustomVersion),g=(0,y.n5)(this.context.instancePermissionSet,d.D8.InstallOfficialOrChangeActiveVersion),x=function(e){return e?o.createElement(u.Z,{id:e},o.createElement(p.Z,{id:e})):o.createElement(o.Fragment,null)};return o.createElement("div",{className:"text-center"},o.createElement("h1",null,o.createElement(p.Z,{id:"view.instance.byond"})),this.state.errors.map((function(e,n){if(e)return o.createElement(b.ZP,{key:n,error:e,onClose:function(){return t.setState((function(e){var t=Array.from(e.errors);return t[n]=void 0,{errors:t}}))}})})),n?o.createElement(o.Fragment,null,m?null:o.createElement(E.Z,{title:"view.instance.byond.current_denied"}),o.createElement("div",{onChange:function(){var e=S((function*(e){t.setState({loading:!0});var n=yield f.Z.switchActive(t.context.instance.id,e.target.value);n.code===v.G.OK?yield t.loadVersions():t.addError(n.error),t.setState({loading:!1})}));return function(t){return e.apply(this,arguments)}}()},this.state.versions.map((function(e){return o.createElement(l.Z,{className:"w-md-25 mb-1 mx-auto d-flex",key:e.version},g||m?o.createElement(l.Z.Prepend,null,o.createElement(l.Z.Radio,{name:"byond",id:e.version,value:e.version,disabled:!g,defaultChecked:e.version===t.state.activeVersion})):null,o.createElement("label",{className:"flex-grow-1 m-0",htmlFor:e.version},o.createElement(c.Z,{overlay:x("view.instance.byond.custom"),show:!e.version.endsWith(".0")&&void 0},(function(t){var n=t.ref,a=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(t,Z);return o.createElement(l.Z.Text,O({className:"w-100"},a),e.version.endsWith(".0")?e.version.substr(0,e.version.length-2):e.version,e.version.endsWith(".0")?null:o.createElement("div",{className:"ml-auto",ref:n},o.createElement(r.G,{fixedWidth:!0,icon:"info"})))}))))}))),o.createElement(w.Z,{className:"mt-4",selectPage:function(e){return t.setState({page:e})},totalPages:null!==(e=this.state.maxPage)&&void 0!==e?e:1,currentPage:this.state.page})):m?o.createElement(o.Fragment,null,o.createElement(E.Z,{title:"view.instance.byond.list_denied"}),o.createElement(p.Z,{id:"view.instance.byond.current_version",values:{version:this.state.activeVersion}})):o.createElement(E.Z,{title:"view.instance.byond.current_and_list_denied"}),o.createElement("hr",null),o.createElement("h4",null,o.createElement(p.Z,{id:"view.instance.byond.add"})),o.createElement(l.Z,{className:"w-md-50 w-lg-25 mb-3 mx-auto"},o.createElement(s.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[0],onChange:function(e){t.setState((function(t){var n=t.selectedVersion.split(".");return n[0]=e.target.value,{selectedVersion:n.join(".")}}))}}),o.createElement(l.Z.Text,{className:"rounded-0"},"."),o.createElement(s.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[1],onChange:function(e){t.setState((function(t){var n=t.selectedVersion.split(".");return n[1]=e.target.value,{selectedVersion:n.join(".")}}))}}),o.createElement(l.Z.Append,null,o.createElement(c.Z,{overlay:x("generic.no_perm"),show:!g&&void 0},o.createElement(a.Z,{variant:g?"success":"danger",disabled:!g,onClick:S((function*(){t.setState({loading:!0});var e=yield f.Z.switchActive(t.context.instance.id,t.state.selectedVersion,t.state.customFile?yield t.state.customFile.arrayBuffer():void 0);e.code===v.G.ERROR?t.addError(e.error):(t.setState({customFile:null}),yield t.loadVersions()),t.setState({loading:!1})}))},o.createElement(r.G,{icon:"plus"}))))),o.createElement(i.Z,null,o.createElement(c.Z,{overlay:x("generic.no_perm"),show:!h&&void 0},o.createElement(i.Z.File,{custom:!0,id:"test",disabled:!h,className:"w-md-50 w-lg-25 text-left",label:this.state.customFile?this.state.customFile.name:o.createElement(p.Z,{id:"view.instance.byond.upload"}),accept:".zip",onChange:function(e){t.setState({customFile:e.target.files?e.target.files[0]:null})}}))))}}],n&&j(t.prototype,n),F}(o.Component);C.contextType=h.g,t.default=C},49896:function(e,t,n){n.d(t,{g:function(){return r}});var r=n(67294).createContext(void 0)},62318:function(e,t,n){var r=n(63366),o=n(87462),a=n(94184),i=n.n(a),s=n(67294),l=n(44680),c=n(76792),u=["bsPrefix","size","hasValidation","className","as"],p=(0,l.Z)("input-group-append"),f=(0,l.Z)("input-group-prepend"),d=(0,l.Z)("input-group-text",{Component:"span"}),m=s.forwardRef((function(e,t){var n=e.bsPrefix,a=e.size,l=e.hasValidation,p=e.className,f=e.as,d=void 0===f?"div":f,m=(0,r.Z)(e,u);return n=(0,c.vE)(n,"input-group"),s.createElement(d,(0,o.Z)({ref:t},m,{className:i()(p,n,a&&n+"-"+a,l&&"has-validation")}))}));m.displayName="InputGroup",m.Text=d,m.Radio=function(e){return s.createElement(d,null,s.createElement("input",(0,o.Z)({type:"radio"},e)))},m.Checkbox=function(e){return s.createElement(d,null,s.createElement("input",(0,o.Z)({type:"checkbox"},e)))},m.Append=p,m.Prepend=f,t.Z=m}}]);
//# sourceMappingURL=12.39df12548e5c45a48ec6.js.map