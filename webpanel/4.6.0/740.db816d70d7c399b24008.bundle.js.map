{"version":3,"file":"740.db816d70d7c399b24008.bundle.js","mappings":"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","sources":["webpack://tgstation-server-control-panel/./src/components/views/Instance/Edit/ChatBots.tsx"],"sourcesContent":["import { faDiscord } from \"@fortawesome/free-brands-svg-icons\";\nimport { faComment, faHashtag, faPlus } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport React from \"react\";\nimport { Button, OverlayTrigger, Tooltip } from \"react-bootstrap\";\nimport { FormattedMessage, injectIntl, WrappedComponentProps } from \"react-intl\";\n\nimport ChatBotClient from \"../../../../ApiClient/ChatBotClient\";\nimport {\n    ChatBotResponse,\n    ChatBotRights,\n    ChatChannel,\n    ChatProvider\n} from \"../../../../ApiClient/generatedcode/generated\";\nimport InternalError, { ErrorCode } from \"../../../../ApiClient/models/InternalComms/InternalError\";\nimport { StatusCode } from \"../../../../ApiClient/models/InternalComms/InternalStatus\";\nimport { InstanceEditContext } from \"../../../../contexts/InstanceEditContext\";\nimport { hasChatBotRight } from \"../../../../utils/misc\";\nimport ErrorAlert from \"../../../utils/ErrorAlert\";\nimport GenericAlert from \"../../../utils/GenericAlert\";\nimport InputField, { FieldType } from \"../../../utils/InputField\";\nimport InputForm, { InputFormField } from \"../../../utils/InputForm\";\nimport { DebugJsonViewer } from \"../../../utils/JsonViewer\";\nimport Loading from \"../../../utils/Loading\";\n\nenum DiscordDMOutputDisplayType {\n    Always = 0,\n    OnError = 1,\n    Never = 2\n}\n\nenum IrcPasswordType {\n    Server = 0,\n    SASL = 1,\n    NickServ = 2\n}\n\ninterface ChatBotConnectionBuilder {\n    provider: ChatProvider;\n    name: string;\n    enabled: boolean;\n    channelLimit: number;\n    reconnectionInterval: number;\n}\n\ninterface ChatBotUpdate extends ChatBotConnectionBuilder {\n    connectionString: string;\n}\n\ninterface DiscordConnectionBuilder extends ChatBotConnectionBuilder {\n    botToken: string;\n    basedMeme: boolean;\n    deploymentBranding: boolean;\n    dmOutputDisplay: DiscordDMOutputDisplayType;\n}\n\ninterface IrcConnectionBuilder extends ChatBotConnectionBuilder {\n    name: string;\n    address: string;\n    port: number;\n    nickname: string;\n    useSsl: boolean;\n    passwordType: IrcPasswordType;\n    password?: string;\n}\n\ninterface ChatBot extends ChatBotResponse {\n    loadedWithConnectionString?: boolean;\n}\n\ninterface IProps extends WrappedComponentProps {}\n\ninterface IState {\n    loading: boolean;\n    errors: Array<InternalError<ErrorCode> | undefined>;\n    chatBots: ChatBot[];\n    selectedAddNode: boolean;\n    selectedChatBot: ChatBot | null;\n    selectedChannel: ChatChannel | null;\n    addBotProvider: ChatProvider;\n}\n\nclass ChatBots extends React.Component<IProps, IState> {\n    public declare context: InstanceEditContext;\n\n    public constructor(props: IProps) {\n        super(props);\n\n        this.state = {\n            loading: true,\n            errors: [],\n            chatBots: [],\n            selectedAddNode: false,\n            selectedChatBot: null,\n            selectedChannel: null,\n            addBotProvider: ChatProvider.Discord\n        };\n\n        this.renderChatBotBrowser = this.renderChatBotBrowser.bind(this);\n    }\n\n    public async componentDidMount(): Promise<void> {\n        if (hasChatBotRight(this.context.instancePermissionSet, ChatBotRights.Read))\n            await this.refresh();\n        else\n            this.setState({\n                loading: false\n            });\n    }\n\n    private addError(error: InternalError<ErrorCode>): void {\n        this.setState(prevState => {\n            const errors = Array.from(prevState.errors);\n            errors.push(error);\n            return {\n                errors\n            };\n        });\n    }\n\n    private async refresh(): Promise<void> {\n        if (hasChatBotRight(this.context.instancePermissionSet, ChatBotRights.Read)) {\n            this.setState({\n                loading: true\n            });\n\n            let maxPages = 1;\n            let chatBots: ChatBot[] = [];\n            for (let page = 1; page <= maxPages; ++page) {\n                const response = await ChatBotClient.listChatBots(this.context.instance.id, {\n                    page\n                });\n\n                if (response.code === StatusCode.OK) {\n                    maxPages = response.payload.totalPages;\n\n                    chatBots = chatBots.concat(response.payload.content);\n                } else {\n                    this.addError(response.error);\n                    break;\n                }\n            }\n\n            // List endpoint does not pull connection string\n            chatBots.forEach(chatBot => (chatBot.loadedWithConnectionString = false));\n\n            this.setState({\n                chatBots,\n                loading: false\n            });\n        }\n    }\n\n    private async addChatBot(connectionBuilder: ChatBotConnectionBuilder): Promise<void> {\n        let connectionString: string;\n        let discordBuilder: DiscordConnectionBuilder;\n        let ircBuilder: IrcConnectionBuilder;\n\n        if (!connectionBuilder.name) {\n            alert(\n                this.props.intl.formatMessage({\n                    id: \"view.instance.chat.create.missing.name\"\n                })\n            );\n            return;\n        }\n\n        switch (connectionBuilder.provider) {\n            case ChatProvider.Discord:\n                discordBuilder = connectionBuilder as DiscordConnectionBuilder;\n                if (!discordBuilder.botToken) {\n                    alert(\n                        this.props.intl.formatMessage({\n                            id: \"view.instance.chat.create.missing.token\"\n                        })\n                    );\n                    return;\n                }\n\n                connectionString = `${discordBuilder.botToken};${discordBuilder.dmOutputDisplay};${\n                    discordBuilder.basedMeme ? \"1\" : \"0\"\n                };${discordBuilder.deploymentBranding ? \"1\" : \"0\"}`;\n                break;\n            case ChatProvider.Irc:\n                ircBuilder = connectionBuilder as IrcConnectionBuilder;\n                if (!ircBuilder.address) {\n                    alert(\n                        this.props.intl.formatMessage({\n                            id: \"view.instance.chat.create.missing.address\"\n                        })\n                    );\n                    return;\n                }\n                if (!ircBuilder.nickname) {\n                    alert(\n                        this.props.intl.formatMessage({\n                            id: \"view.instance.chat.create.missing.nick\"\n                        })\n                    );\n                    return;\n                }\n\n                connectionString = `${ircBuilder.address};${ircBuilder.port};${\n                    ircBuilder.nickname\n                };${ircBuilder.useSsl ? \"1\" : \"0\"}`;\n                if (ircBuilder.password)\n                    connectionString += `;${ircBuilder.passwordType};${ircBuilder.password}`;\n                break;\n            default:\n                throw new Error(\"Bad provider!\");\n        }\n\n        this.setState({\n            loading: true\n        });\n\n        const response = await ChatBotClient.createChatBot(this.context.instance.id, {\n            provider: connectionBuilder.provider,\n            name: connectionBuilder.name,\n            enabled: connectionBuilder.enabled,\n            connectionString,\n            channelLimit: connectionBuilder.channelLimit,\n            reconnectionInterval: connectionBuilder.reconnectionInterval\n        });\n\n        if (response.code === StatusCode.OK) {\n            const newChatBot: ChatBot = response.payload;\n            newChatBot.loadedWithConnectionString = true;\n            const newChatBots = [...this.state.chatBots];\n            newChatBots.push(newChatBot);\n            this.setState({\n                chatBots: newChatBots,\n                selectedChatBot: newChatBot,\n                selectedAddNode: false\n            });\n        } else {\n            this.addError(response.error);\n        }\n\n        this.setState({\n            loading: false\n        });\n    }\n\n    private async reloadChatBot(chatBot: ChatBot): Promise<void> {\n        this.setState({\n            loading: true\n        });\n\n        const response = await ChatBotClient.getChatBot(this.context.instance.id, chatBot.id);\n        if (response.code === StatusCode.OK) {\n            chatBot = response.payload;\n            chatBot.loadedWithConnectionString = true;\n\n            const chatBots = [...this.state.chatBots];\n            const index = chatBots.indexOf(chatBot);\n            chatBots[index] = chatBot;\n\n            this.setState({\n                chatBots,\n                selectedChatBot: chatBot\n            });\n        } else {\n            this.addError(response.error);\n        }\n\n        this.setState({\n            loading: false\n        });\n    }\n\n    private async editChatBot(chatBotUpdate: ChatBotUpdate): Promise<void> {\n        this.setState({\n            loading: true\n        });\n\n        let chatBot = this.state.selectedChatBot!;\n\n        const response = await ChatBotClient.updateChatBot(this.context.instance.id, {\n            ...chatBotUpdate,\n            id: chatBot.id\n        });\n\n        if (response.code === StatusCode.OK) {\n            if (response.payload) {\n                const chatBots = [...this.state.chatBots];\n                const index = chatBots.indexOf(chatBot);\n\n                chatBot = response.payload;\n                chatBot.loadedWithConnectionString = true;\n\n                chatBots[index] = chatBot;\n\n                this.setState({\n                    chatBots,\n                    selectedChatBot: chatBot\n                });\n            }\n        } else {\n            this.addError(response.error);\n        }\n\n        this.setState({\n            loading: false\n        });\n    }\n\n    private async addChatChannel(chatBot: ChatBot, chatChannel: ChatChannel): Promise<void> {\n        if (!chatChannel.ircChannel) {\n            alert(\n                this.props.intl.formatMessage({ id: \"view.instance.chat.create.missing.channel\" })\n            );\n            return;\n        }\n\n        // Uint64 hack\n        if (chatBot.provider === ChatProvider.Discord) {\n            const reg = new RegExp(\"^[0-9]+$\");\n            if (!reg.test(chatChannel.ircChannel)) {\n                alert(\n                    this.props.intl.formatMessage({\n                        id: \"view.instance.chat.create.invalid.discord\"\n                    })\n                );\n                return;\n            }\n            chatChannel.discordChannelId = (chatChannel.ircChannel as unknown) as number;\n            chatChannel.ircChannel = null;\n        }\n\n        this.setState({\n            loading: true\n        });\n\n        const newChannels = [...(chatBot.channels ?? [])];\n        newChannels.push(chatChannel);\n\n        const response = await ChatBotClient.updateChatBot(this.context.instance.id, {\n            channels: newChannels,\n            id: chatBot.id\n        });\n\n        if (response.code === StatusCode.OK) {\n            if (response.payload) {\n                const chatBots = [...this.state.chatBots];\n                const index = chatBots.indexOf(chatBot);\n\n                chatBot = response.payload;\n                chatBot.loadedWithConnectionString = true;\n\n                chatBots[index] = chatBot;\n\n                this.setState({\n                    chatBots,\n                    selectedChatBot: chatBot,\n                    selectedChannel: chatBot.channels[chatBot.channels.length - 1]\n                });\n            }\n        } else {\n            this.addError(response.error);\n        }\n\n        this.setState({\n            loading: false\n        });\n    }\n\n    private async editChatChannel(chatBot: ChatBot, chatChannel: ChatChannel): Promise<void> {\n        this.setState({\n            loading: true\n        });\n\n        const newChannels = [...(chatBot.channels ?? [])];\n        const channelToEdit = newChannels[newChannels.indexOf(this.state.selectedChannel!)];\n\n        Object.assign(channelToEdit, chatChannel);\n\n        const response = await ChatBotClient.updateChatBot(this.context.instance.id, {\n            channels: newChannels,\n            id: chatBot.id\n        });\n\n        if (response.code === StatusCode.OK) {\n            if (response.payload) {\n                const chatBots = [...this.state.chatBots];\n                const index = chatBots.indexOf(chatBot);\n\n                chatBot = response.payload;\n                chatBot.loadedWithConnectionString = true;\n\n                chatBots[index] = chatBot;\n\n                this.setState({\n                    chatBots,\n                    selectedChatBot: chatBot\n                });\n            }\n        } else {\n            this.addError(response.error);\n        }\n\n        this.setState({\n            loading: false\n        });\n    }\n\n    private async deleteChatChannel(chatBot: ChatBot, chatChannel: ChatChannel): Promise<void> {\n        if (\n            !confirm(\n                this.props.intl.formatMessage(\n                    { id: \"view.instance.chat.delete.channel.confirm\" },\n                    {\n                        channelName:\n                            chatChannel.tag ??\n                            chatChannel.ircChannel ??\n                            chatChannel.discordChannelId\n                    }\n                )\n            )\n        )\n            return;\n\n        this.setState({\n            loading: true\n        });\n\n        const newChannels = [...(chatBot.channels ?? [])];\n        const index = newChannels.indexOf(chatChannel);\n        newChannels.splice(index, 1);\n\n        const response = await ChatBotClient.updateChatBot(this.context.instance.id, {\n            channels: newChannels,\n            id: chatBot.id\n        });\n\n        if (response.code === StatusCode.OK) {\n            if (response.payload) {\n                const chatBots = [...this.state.chatBots];\n                const index = chatBots.indexOf(chatBot);\n\n                chatBot = response.payload;\n                chatBot.loadedWithConnectionString = true;\n\n                chatBots[index] = chatBot;\n\n                this.setState({\n                    chatBots,\n                    selectedChatBot: chatBot,\n\n                    selectedChannel: null\n                });\n            }\n        } else {\n            this.addError(response.error);\n        }\n\n        this.setState({\n            loading: false\n        });\n    }\n\n    private async deleteChatBot(chatBot: ChatBot): Promise<void> {\n        if (\n            !confirm(\n                this.props.intl.formatMessage(\n                    { id: \"view.instance.chat.delete.confirm\" },\n                    { botName: chatBot.name }\n                )\n            )\n        )\n            return;\n\n        this.setState({\n            loading: true\n        });\n\n        const response = await ChatBotClient.deleteChatBot(this.context.instance.id, chatBot.id);\n\n        if (response.code === StatusCode.OK) {\n            const newChatBots = [...this.state.chatBots];\n            const index = newChatBots.indexOf(chatBot);\n            newChatBots.splice(index, 1);\n\n            this.setState({\n                chatBots: newChatBots,\n                selectedChatBot: null\n            });\n        } else {\n            this.addError(response.error);\n        }\n\n        this.setState({\n            loading: false\n        });\n    }\n\n    public render(): React.ReactNode {\n        if (this.state.loading) {\n            return <Loading text=\"loading.chat\" />;\n        }\n\n        const canRead = hasChatBotRight(this.context.instancePermissionSet, ChatBotRights.Read);\n        const canCreate = hasChatBotRight(this.context.instancePermissionSet, ChatBotRights.Create);\n\n        return (\n            <div className=\"text-center\">\n                <DebugJsonViewer obj={this.state} />\n                <h1>\n                    <FormattedMessage id=\"view.instance.chat\" />\n                </h1>\n                {this.state.errors.map((err, index) => {\n                    if (!err) return;\n                    return (\n                        <ErrorAlert\n                            key={index}\n                            error={err}\n                            onClose={() =>\n                                this.setState(prev => {\n                                    const newarr = Array.from(prev.errors);\n                                    newarr[index] = undefined;\n                                    return {\n                                        errors: newarr\n                                    };\n                                })\n                            }\n                        />\n                    );\n                })}\n                <div className=\"d-flex flex-row\">\n                    <div\n                        className=\"text-left\"\n                        style={{\n                            paddingRight: \"16px\",\n                            maxHeight: \"800px\",\n                            minWidth: \"300px\",\n                            overflowY: \"scroll\"\n                        }}>\n                        <ul className=\"browser-ul\">\n                            {canRead ? (\n                                this.state.chatBots.map(this.renderChatBotBrowser)\n                            ) : (\n                                <React.Fragment />\n                            )}\n                            {canCreate ? (\n                                <li className=\"browser-li\">\n                                    <OverlayTrigger\n                                        placement=\"top\"\n                                        show={\n                                            this.state.chatBots.length <\n                                            this.context.instance.chatBotLimit\n                                                ? false\n                                                : undefined\n                                        }\n                                        overlay={props => (\n                                            <Tooltip id=\"too-many-chat-bots\" {...props}>\n                                                <FormattedMessage\n                                                    id=\"view.instance.chat.limit\"\n                                                    values={{\n                                                        max: this.context.instance.chatBotLimit\n                                                    }}\n                                                />\n                                            </Tooltip>\n                                        )}>\n                                        <Button\n                                            className=\"nowrap\"\n                                            disabled={\n                                                this.state.chatBots.length >=\n                                                this.context.instance.chatBotLimit\n                                            }\n                                            onClick={() =>\n                                                this.setState({\n                                                    selectedChatBot: null,\n                                                    selectedChannel: null,\n                                                    selectedAddNode: !!(\n                                                        !this.state.selectedAddNode ||\n                                                        this.state.selectedChatBot\n                                                    )\n                                                })\n                                            }>\n                                            <FontAwesomeIcon icon={faPlus} />\n                                            &nbsp;\n                                            <FormattedMessage id=\"view.instance.chat.create\" />\n                                        </Button>\n                                    </OverlayTrigger>\n                                </li>\n                            ) : (\n                                <React.Fragment />\n                            )}\n                        </ul>\n                    </div>\n                    <div\n                        className=\"flex-fill flex-column text-center align-self-center\"\n                        style={{ padding: \"16px\" }}>\n                        {this.state.selectedChannel ? (\n                            this.renderAddEditChannel(false)\n                        ) : this.state.selectedChatBot && !this.state.selectedAddNode ? (\n                            this.renderAddEditChatBot(false)\n                        ) : this.state.selectedAddNode ? (\n                            this.state.selectedChatBot ? (\n                                this.renderAddEditChannel(true)\n                            ) : (\n                                this.renderAddEditChatBot(true)\n                            )\n                        ) : (\n                            <h4>\n                                <FormattedMessage id=\"view.instance.chat.select_item\" />\n                            </h4>\n                        )}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n    private renderChatBotBrowser(chatBot: ChatBotResponse): React.ReactNode {\n        const selected = this.state.selectedChatBot === chatBot;\n        const canWriteChannels = hasChatBotRight(\n            this.context.instancePermissionSet,\n            ChatBotRights.WriteChannels\n        );\n        return (\n            <li key={chatBot.id} className=\"browser-li\">\n                <Button\n                    variant={selected ? \"secondary\" : \"primary\"}\n                    onClick={() =>\n                        this.setState({\n                            selectedChatBot:\n                                selected &&\n                                !this.state.selectedChannel &&\n                                !this.state.selectedAddNode\n                                    ? null\n                                    : chatBot,\n                            selectedChannel: null,\n                            selectedAddNode: false\n                        })\n                    }\n                    className=\"nowrap\">\n                    <FontAwesomeIcon\n                        icon={chatBot.provider === ChatProvider.Discord ? faDiscord : faComment}\n                    />\n                    &nbsp;{chatBot.name}\n                </Button>\n                {canWriteChannels && selected ? (\n                    <ul className=\"browser-ul\">\n                        {chatBot.channels.map(channel => {\n                            const channelSelected = this.state.selectedChannel === channel;\n                            return (\n                                <li\n                                    key={channel.discordChannelId ?? channel.ircChannel}\n                                    className=\"browser-li\">\n                                    <Button\n                                        variant={channelSelected ? \"secondary\" : \"primary\"}\n                                        onClick={() =>\n                                            this.setState({\n                                                selectedChannel: channelSelected ? null : channel\n                                            })\n                                        }\n                                        className=\"nowrap\">\n                                        <FontAwesomeIcon icon={faHashtag} />\n                                        &nbsp;\n                                        {channel.tag\n                                            ? `(${channel.tag})`\n                                            : channel.discordChannelId ?? channel.ircChannel}\n                                    </Button>\n                                </li>\n                            );\n                        })}\n                        <li className=\"browser-li\">\n                            <OverlayTrigger\n                                placement=\"top\"\n                                show={\n                                    chatBot.channels.length < chatBot.channelLimit\n                                        ? false\n                                        : undefined\n                                }\n                                overlay={props => (\n                                    <Tooltip id=\"too-many-chat-channels\" {...props}>\n                                        <FormattedMessage\n                                            id=\"view.instance.chat.limit.channels\"\n                                            values={{ max: chatBot.channelLimit }}\n                                        />\n                                    </Tooltip>\n                                )}>\n                                <Button\n                                    className=\"nowrap\"\n                                    disabled={chatBot.channels.length >= chatBot.channelLimit}\n                                    onClick={() =>\n                                        this.setState({\n                                            selectedChannel: null,\n                                            selectedAddNode: !!(\n                                                !this.state.selectedAddNode ||\n                                                this.state.selectedChannel\n                                            )\n                                        })\n                                    }>\n                                    <FontAwesomeIcon icon={faPlus} />\n                                    &nbsp;\n                                    <FormattedMessage id=\"view.instance.chat.create.channel\" />\n                                </Button>\n                            </OverlayTrigger>\n                        </li>\n                    </ul>\n                ) : (\n                    <React.Fragment />\n                )}\n            </li>\n        );\n    }\n\n    private renderAddEditChatBot(add: boolean): React.ReactNode {\n        const providerFieldCommon = {\n            type: FieldType.Enum as FieldType.Enum,\n            name: \"fields.instance.chat.provider\",\n            defaultValue: this.state.addBotProvider,\n            enum: ChatProvider,\n            noLocalize: true\n        };\n\n        const providerField = {\n            ...providerFieldCommon,\n            onChange: (newValue: ChatProvider) => {\n                this.setState({ addBotProvider: newValue });\n            }\n        };\n\n        const fieldsCommon = {\n            provider: { ...providerFieldCommon },\n            name: {\n                type: FieldType.String as FieldType.String,\n                name: \"fields.instance.chat.name\",\n                tooltip: \"fields.instance.chat.name.tip\"\n            },\n            enabled: {\n                type: FieldType.Boolean as FieldType.Boolean,\n                name: \"fields.instance.chat.enabled\",\n                tooltip: \"fields.instance.chat.enabled.tip\",\n                defaultValue: true\n            },\n            channelLimit: {\n                type: FieldType.Number as FieldType.Number,\n                name: \"fields.instance.chat.limit\",\n                tooltip: \"fields.instance.chat.limit.tip\",\n                min: 0,\n                max: 65535,\n                defaultValue: 10\n            },\n            reconnectionInterval: {\n                type: FieldType.Number as FieldType.Number,\n                name: \"fields.instance.chat.reconnect\",\n                tooltip: \"fields.instance.chat.reconnect.tip\",\n                min: 0,\n                defaultValue: 5\n            }\n        };\n\n        if (add) {\n            const fieldsDiscord = {\n                ...fieldsCommon,\n                botToken: {\n                    type: FieldType.String as FieldType.String,\n                    name: \"fields.instance.chat.create.discord.token\",\n                    tooltip: \"fields.instance.chat.create.discord.token.tip\"\n                },\n                dmOutputDisplayType: {\n                    type: FieldType.Enum as FieldType.Enum,\n                    name: \"fields.instance.chat.create.discord.output\",\n                    tooltip: \"fields.instance.chat.create.discord.output.tip\",\n                    defaultValue: DiscordDMOutputDisplayType.Always,\n                    enum: DiscordDMOutputDisplayType,\n                    noLocalize: true\n                },\n                basedMeme: {\n                    type: FieldType.Boolean as FieldType.Boolean,\n                    name: \"fields.instance.chat.create.discord.based\",\n                    tooltip: \"fields.instance.chat.create.discord.based.tip\",\n                    defaultValue: true\n                },\n                deploymentBranding: {\n                    type: FieldType.Boolean as FieldType.Boolean,\n                    name: \"fields.instance.chat.create.discord.branding\",\n                    tooltip: \"fields.instance.chat.create.discord.branding.tip\",\n                    defaultValue: true\n                }\n            };\n\n            const fieldsIrc = {\n                ...fieldsCommon,\n                address: {\n                    type: FieldType.String as FieldType.String,\n                    name: \"fields.instance.chat.create.irc.address\",\n                    tooltip: \"fields.instance.chat.create.irc.address.tip\"\n                },\n                port: {\n                    type: FieldType.Number as FieldType.Number,\n                    name: \"fields.instance.chat.create.irc.port\",\n                    min: 1,\n                    max: 65535,\n                    defaultValue: 6697 // RFC7194\n                },\n                nickname: {\n                    type: FieldType.String as FieldType.String,\n                    name: \"fields.instance.chat.create.irc.nick\"\n                },\n                password: {\n                    type: FieldType.Password as FieldType.Password,\n                    name: \"fields.instance.chat.create.irc.pass\",\n                    tooltip: \"fields.instance.chat.create.irc.pass.tip\"\n                },\n                passwordType: {\n                    type: FieldType.Enum as FieldType.Enum,\n                    name: \"fields.instance.chat.create.irc.passtype\",\n                    defaultValue: IrcPasswordType.SASL,\n                    enum: IrcPasswordType,\n                    noLocalize: true\n                },\n                useSsl: {\n                    type: FieldType.Boolean as FieldType.Boolean,\n                    name: \"fields.instance.chat.create.irc.ssl\",\n                    tooltip: \"fields.instance.chat.create.irc.ssl.tip\"\n                }\n            };\n\n            (fieldsCommon.provider as InputFormField).disabled = true;\n\n            return (\n                <React.Fragment>\n                    <h5>\n                        <FormattedMessage id=\"view.instance.chat.create\" />\n                    </h5>\n                    <hr />\n                    <InputField {...providerField} />\n                    <hr />\n                    <InputForm\n                        key={`bot-create-form-${this.state.addBotProvider}`}\n                        hideDisabled\n                        includeAll\n                        saveMessageId=\"fields.instance.chat.create.save\"\n                        fields={\n                            this.state.addBotProvider === ChatProvider.Discord\n                                ? fieldsDiscord\n                                : fieldsIrc\n                        }\n                        onSave={(connectionBuilder: ChatBotConnectionBuilder) =>\n                            void this.addChatBot(connectionBuilder)\n                        }\n                    />\n                </React.Fragment>\n            );\n        }\n\n        const chatBot = this.state.selectedChatBot!;\n        const canReadConnectionString = hasChatBotRight(\n            this.context.instancePermissionSet,\n            ChatBotRights.ReadConnectionString\n        );\n        const canEditConnectionString = hasChatBotRight(\n            this.context.instancePermissionSet,\n            ChatBotRights.WriteConnectionString\n        );\n\n        const fieldsEdit = {\n            ...fieldsCommon,\n            connectionString: {\n                type: FieldType.String as FieldType.String,\n                name: \"fields.instance.chat.edit.connection\",\n                tooltip: \"fields.instance.chat.edit.connection.tip\",\n                defaultValue: canReadConnectionString\n                    ? chatBot.loadedWithConnectionString\n                        ? chatBot.connectionString\n                        : this.props.intl.formatMessage({\n                              id: \"fields.instance.chat.edit.connection.unloaded\"\n                          })\n                    : this.props.intl.formatMessage({\n                          id: \"fields.instance.chat.edit.connection.deny\"\n                      }),\n                disabled: !canEditConnectionString\n            }\n        };\n\n        (fieldsEdit.name as InputFormField).defaultValue = chatBot.name;\n        (fieldsEdit.enabled as InputFormField).defaultValue = chatBot.enabled;\n        (fieldsEdit.channelLimit as InputFormField).defaultValue = chatBot.channelLimit;\n        (fieldsEdit.reconnectionInterval as InputFormField).defaultValue =\n            chatBot.reconnectionInterval;\n\n        (fieldsEdit.name as InputFormField).disabled = !hasChatBotRight(\n            this.context.instancePermissionSet,\n            ChatBotRights.WriteName\n        );\n        (fieldsEdit.enabled as InputFormField).disabled = !hasChatBotRight(\n            this.context.instancePermissionSet,\n            ChatBotRights.WriteEnabled\n        );\n        (fieldsEdit.channelLimit as InputFormField).disabled = !hasChatBotRight(\n            this.context.instancePermissionSet,\n            ChatBotRights.WriteChannelLimit\n        );\n        (fieldsEdit.reconnectionInterval as InputFormField).disabled = !hasChatBotRight(\n            this.context.instancePermissionSet,\n            ChatBotRights.WriteReconnectionInterval\n        );\n\n        const canDelete = hasChatBotRight(this.context.instancePermissionSet, ChatBotRights.Delete);\n\n        return (\n            <React.Fragment>\n                <h5>\n                    <FontAwesomeIcon\n                        icon={chatBot.provider === ChatProvider.Discord ? faDiscord : faComment}\n                    />\n                    &nbsp;{chatBot.name}\n                </h5>\n                <hr />\n                {!chatBot.loadedWithConnectionString ? (\n                    <React.Fragment>\n                        <OverlayTrigger\n                            placement=\"top\"\n                            show={canReadConnectionString ? false : undefined}\n                            overlay={props => (\n                                <Tooltip id=\"chat-bot-read-conn-perm\" {...props}>\n                                    <FormattedMessage id=\"view.instance.chat.reload.deny\" />\n                                </Tooltip>\n                            )}>\n                            <Button\n                                className=\"nowrap\"\n                                disabled={!canReadConnectionString}\n                                onClick={() => void this.reloadChatBot(chatBot)}>\n                                <FormattedMessage id=\"view.instance.chat.reload\" />\n                            </Button>\n                        </OverlayTrigger>\n                        <br />\n                        <br />\n                    </React.Fragment>\n                ) : (\n                    <React.Fragment />\n                )}\n                <InputForm\n                    fields={fieldsEdit}\n                    onSave={(chatBotUpdate: ChatBotUpdate) => void this.editChatBot(chatBotUpdate)}\n                />\n                <hr />\n                <OverlayTrigger\n                    placement=\"top\"\n                    show={canDelete ? false : undefined}\n                    overlay={props => (\n                        <Tooltip id=\"chat-bot-delete-perm\" {...props}>\n                            <FormattedMessage id=\"view.instance.chat.delete.deny\" />\n                        </Tooltip>\n                    )}>\n                    <Button\n                        className=\"nowrap\"\n                        disabled={!canDelete}\n                        variant=\"danger\"\n                        onClick={() => void this.deleteChatBot(chatBot)}>\n                        <FormattedMessage id=\"view.instance.chat.delete\" />\n                    </Button>\n                </OverlayTrigger>\n            </React.Fragment>\n        );\n    }\n\n    private renderAddEditChannel(add: boolean): React.ReactNode {\n        const chatBot = this.state.selectedChatBot!;\n\n        const fieldsCommon = {\n            tag: {\n                type: FieldType.String as FieldType.String,\n                name: \"fields.instance.chat.channel.tag\",\n                tooltip: \"fields.instance.chat.channel.tag.tip\"\n            },\n            isAdminChannel: {\n                type: FieldType.Boolean as FieldType.Boolean,\n                name: \"fields.instance.chat.channel.admin\",\n                tooltip: \"fields.instance.chat.channel.admin.tip\"\n            },\n            isWatchdogChannel: {\n                type: FieldType.Boolean as FieldType.Boolean,\n                name: \"fields.instance.chat.channel.watchdog\",\n                tooltip: \"fields.instance.chat.channel.watchdog.tip\"\n            },\n            isUpdatesChannel: {\n                type: FieldType.Boolean as FieldType.Boolean,\n                name: \"fields.instance.chat.channel.updates\",\n                tooltip: \"fields.instance.chat.channel.updates.tip\"\n            }\n        };\n\n        const canEditChannels = hasChatBotRight(\n            this.context.instancePermissionSet,\n            ChatBotRights.WriteChannels\n        );\n\n        if (add) {\n            const fieldsDiscord = {\n                // we remap this to discord later because of uint64 memes\n                ircChannel: {\n                    type: FieldType.String as FieldType.String,\n                    name: \"fields.instance.chat.channel.discord\",\n                    tooltip: \"fields.instance.chat.channel.discord.tip\"\n                },\n                ...fieldsCommon\n            };\n            const fieldsIrc = {\n                ircChannel: {\n                    type: FieldType.String as FieldType.String,\n                    name: \"fields.instance.chat.channel.irc\",\n                    tooltip: \"fields.instance.chat.channel.irc.tip\",\n                    defaultValue: \"#\"\n                },\n                ...fieldsCommon\n            };\n\n            return (\n                <React.Fragment>\n                    <h5>\n                        <FormattedMessage id=\"view.instance.chat.create.channel\" />\n                    </h5>\n                    <hr />\n                    <InputForm\n                        key={`bot-channel-create-form-${chatBot.provider}`}\n                        includeAll\n                        saveMessageId=\"fields.instance.chat.create.channel\"\n                        fields={\n                            chatBot.provider === ChatProvider.Discord ? fieldsDiscord : fieldsIrc\n                        }\n                        onSave={(chatChannel: ChatChannel) =>\n                            void this.addChatChannel(chatBot, chatChannel)\n                        }\n                    />\n                </React.Fragment>\n            );\n        }\n\n        const channel = this.state.selectedChannel!;\n\n        (fieldsCommon.isAdminChannel as InputFormField).defaultValue = channel.isAdminChannel;\n        (fieldsCommon.isUpdatesChannel as InputFormField).defaultValue = channel.isUpdatesChannel;\n        (fieldsCommon.isWatchdogChannel as InputFormField).defaultValue = channel.isWatchdogChannel;\n        (fieldsCommon.tag as InputFormField).defaultValue = channel.tag;\n\n        return (\n            <React.Fragment key={chatBot.channels.indexOf(channel)}>\n                {channel.discordChannelId ? (\n                    <GenericAlert title=\"view.instance.chat.channel.wrong_id\" />\n                ) : (\n                    <React.Fragment />\n                )}\n                <h5>\n                    {channel.ircChannel ?? channel.discordChannelId}\n                    {channel.tag ? ` (${channel.tag})` : \"\"}\n                </h5>\n                <hr />\n                <InputForm\n                    fields={fieldsCommon}\n                    onSave={(chatChannel: ChatChannel) =>\n                        void this.editChatChannel(chatBot, chatChannel)\n                    }\n                />\n                <hr />\n                <OverlayTrigger\n                    placement=\"top\"\n                    show={canEditChannels ? false : undefined}\n                    overlay={props => (\n                        <Tooltip id=\"chat-bot-delete-perm\" {...props}>\n                            <FormattedMessage id=\"view.instance.chat.delete.channel.deny\" />\n                        </Tooltip>\n                    )}>\n                    <Button\n                        className=\"nowrap\"\n                        disabled={!canEditChannels}\n                        variant=\"danger\"\n                        onClick={() => void this.deleteChatChannel(chatBot, channel)}>\n                        <FormattedMessage id=\"view.instance.chat.delete.channel\" />\n                    </Button>\n                </OverlayTrigger>\n            </React.Fragment>\n        );\n    }\n}\n\nChatBots.contextType = InstanceEditContext;\nexport default injectIntl(ChatBots);\n"],"names":["DiscordDMOutputDisplayType","IrcPasswordType","ChatBots","React","constructor","props","super","this","state","loading","errors","chatBots","selectedAddNode","selectedChatBot","selectedChannel","addBotProvider","ChatProvider","renderChatBotBrowser","bind","hasChatBotRight","context","instancePermissionSet","ChatBotRights","refresh","setState","addError","error","prevState","Array","from","push","maxPages","page","response","ChatBotClient","instance","id","code","StatusCode","payload","totalPages","concat","content","forEach","chatBot","loadedWithConnectionString","connectionBuilder","connectionString","discordBuilder","ircBuilder","name","alert","intl","formatMessage","provider","botToken","dmOutputDisplay","basedMeme","deploymentBranding","address","nickname","port","useSsl","password","passwordType","Error","enabled","channelLimit","reconnectionInterval","newChatBot","newChatBots","index","indexOf","chatBotUpdate","chatChannel","ircChannel","RegExp","test","discordChannelId","newChannels","channels","length","channelToEdit","Object","assign","confirm","channelName","tag","splice","botName","render","text","canRead","canCreate","className","obj","map","err","key","onClose","prev","newarr","undefined","style","paddingRight","maxHeight","minWidth","overflowY","placement","show","chatBotLimit","overlay","values","max","disabled","onClick","icon","faPlus","padding","renderAddEditChannel","renderAddEditChatBot","selected","canWriteChannels","variant","faDiscord","faComment","channel","channelSelected","faHashtag","add","providerFieldCommon","type","FieldType","defaultValue","enum","noLocalize","providerField","onChange","newValue","fieldsCommon","tooltip","min","fieldsDiscord","dmOutputDisplayType","Always","fieldsIrc","SASL","hideDisabled","includeAll","saveMessageId","fields","onSave","addChatBot","canReadConnectionString","canEditConnectionString","fieldsEdit","canDelete","reloadChatBot","editChatBot","deleteChatBot","isAdminChannel","isWatchdogChannel","isUpdatesChannel","canEditChannels","addChatChannel","title","editChatChannel","deleteChatChannel","contextType","InstanceEditContext","injectIntl"],"sourceRoot":""}