"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[883],{76515:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(67294),a=n(15881),i=n(44012),o=n(2486);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function f(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(y,e);var t,n,s,m,p=(s=y,m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=d(s);if(m){var n=d(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function y(){return l(this,y),p.apply(this,arguments)}return t=y,(n=[{key:"render",value:function(){return r.createElement(a.Z,{className:"bg-transparent",border:"info"},r.createElement(a.Z.Header,{className:"bg-info text-dark font-weight-bold"},r.createElement(i.Z,{id:"generic.wip"})),r.createElement(a.Z.Body,null,r.createElement(a.Z.Title,null,r.createElement(i.Z,{id:"generic.wip.desc"}),r.createElement("a",{href:"https://github.com/tgstation/Tgstation.Server.ControlPanel/releases/latest"},"https://github.com/tgstation/Tgstation.Server.ControlPanel/releases/latest")),r.createElement(a.Z.Text,{as:"pre",className:"bg-transparent text-info"},r.createElement("code",null,"Version: ".concat(o.q4,"\nWebpanel Mode: ").concat(o.IK,"\nCurrent route: ").concat(window.location.toString())))))}}])&&c(t.prototype,n),y}(r.Component)},78883:function(e,t,n){n.r(t),n.d(t,{default:function(){return N}});var r,a=n(67294),i=n(27977),o=n(35005),s=n(15293),l=n(43489),c=n(44012),u=n(74490),f=n(48155),d=n(38592),m=n(71460),p=n(49896),y=n(42540),v=n(43307),h=n(53041),b=n(81251),g=n(80919),S=n(71739),w=n(76515);function E(e,t,n,r,a,i,o){try{var s=e[i](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,a)}function Z(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){E(i,r,a,o,s,"next",e)}function s(e){E(i,r,a,o,s,"throw",e)}o(void 0)}))}}function R(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function N(){var e=(0,a.useContext)(p.g),t=R((0,a.useState)(),2),n=t[0],E=t[1],P=R((0,a.useState)(!1),2),N=P[0],_=P[1],O=(0,a.useState)([]);function x(){return T.apply(this,arguments)}function T(){return(T=Z((function*(){if(!(0,y.mg)(e.instancePermissionSet,f.py.ReadMetadata))return E({});var t=yield u.Z.getWatchdogStatus(e.instance.id);t.code===d.G.ERROR?(0,v.iT)(O,t.error):E(t.payload)}))).apply(this,arguments)}function C(e){return k.apply(this,arguments)}function k(){return(k=Z((function*(t){_(!0);var n=yield u.Z.updateWatchdogStatus(e.instance.id,t);n.code===d.G.ERROR&&(0,v.iT)(O,n.error),yield x(),_(!1)}))).apply(this,arguments)}function j(){return(j=Z((function*(){_(!0);var t=yield u.Z.startWatchdog(e.instance.id);t.code===d.G.ERROR?(0,v.iT)(O,t.error):(m.Z.registerCallback(t.payload.id,(function(){x()})),m.Z.fastmode=5,yield x()),_(!1)}))).apply(this,arguments)}function V(){return(V=Z((function*(){_(!0);var t=yield u.Z.stopWatchdog(e.instance.id);t.code===d.G.ERROR?(0,v.iT)(O,t.error):yield x(),_(!1)}))).apply(this,arguments)}function W(){return(W=Z((function*(){_(!0);var t=yield u.Z.restartWatchdog(e.instance.id);t.code===d.G.ERROR?(0,v.iT)(O,t.error):(m.Z.registerCallback(t.payload.id,(function(){x()})),m.Z.fastmode=5,yield x()),_(!1)}))).apply(this,arguments)}function A(){return(A=Z((function*(){_(!0);var t=yield u.Z.dumpWatchdog(e.instance.id);t.code===d.G.ERROR?(0,v.iT)(O,t.error):m.Z.fastmode=5,_(!1)}))).apply(this,arguments)}if((0,a.useEffect)((function(){x()}),[]),!n)return a.createElement(S.Z,{text:"loading.instance.server"});if(N)return a.createElement(S.Z,null);var B={autoStart:{type:b.fS.Boolean,name:"fields.instance.watchdog.autostart",defaultValue:n.autoStart,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetAutoStart)},port:{type:b.fS.Number,name:"fields.instance.watchdog.port",defaultValue:n.port,min:0,max:65535,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetPort)},visibility:{type:b.fS.Enum,name:"fields.instance.watchdog.visibility",defaultValue:n.visibility,enum:f.Ye,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetVisibility)},securityLevel:{type:b.fS.Enum,name:"fields.instance.watchdog.securitylevel",defaultValue:n.securityLevel,enum:f.ns,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetSecurity)},startupTimeout:{type:b.fS.Number,name:"fields.instance.watchdog.timeout.startup",defaultValue:n.startupTimeout,min:0,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetStartupTimeout)},topicRequestTimeout:{type:b.fS.Number,name:"fields.instance.watchdog.timeout.topic",defaultValue:n.topicRequestTimeout,min:0,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetTopicTimeout)},heartbeatSeconds:{type:b.fS.Number,name:"fields.instance.watchdog.heartbeat",defaultValue:n.heartbeatSeconds,min:0,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetHeartbeatInterval)},allowWebClient:{type:b.fS.Boolean,name:"fields.instance.watchdog.allowwebclient",defaultValue:n.allowWebClient,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetWebClient)},additionalParameters:{type:b.fS.String,name:"fields.instance.watchdog.additionalparams",defaultValue:n.additionalParameters,disabled:!(0,y.mg)(e.instancePermissionSet,f.py.SetAdditionalParameters)}},G=Object.values(B).some((function(e){return!e.disabled})),I=a.createElement(l.Z,{id:"generic.no_perm"},a.createElement(c.Z,{id:"generic.no_perm"})),M=(0,y.mg)(e.instancePermissionSet,f.py.Start),q=(0,y.mg)(e.instancePermissionSet,f.py.Shutdown),D=(0,y.mg)(e.instancePermissionSet,f.py.Restart),H=(0,y.mg)(e.instancePermissionSet,f.py.CreateDump),L=(0,y.mg)(e.instancePermissionSet,f.py.ReadMetadata),F=(0,y.mg)(e.instancePermissionSet,f.py.SoftShutdown)||(0,y.mg)(e.instancePermissionSet,f.py.SoftRestart),K=M||q||D||H;return a.createElement("div",null,(0,v.hP)(O),a.createElement("h2",{className:"text-center"},a.createElement(c.Z,{id:"view.instance.server.status"}),a.createElement(i.Z,{pill:!0,variant:n.status===f.Ni.Online?"success":n.status===f.Ni.Offline?"danger":"warning"},a.createElement(c.Z,{id:"view.instance.server.status.".concat(f.Ni[n.status])}))),a.createElement("hr",null),a.createElement("h3",{className:"text-center"},a.createElement(c.Z,{id:"view.instance.server.settings"})),L?null:G?a.createElement(h.Z,{title:"view.instance.server.no_metadata"}):a.createElement(h.Z,{title:"view.instance.server.no_metadata_and_no_settings"}),a.createElement(g.Z,{fields:B,onSave:C,hideDisabled:!L}),a.createElement("hr",null),a.createElement("h3",{className:"text-center"},a.createElement(c.Z,{id:"view.instance.server.actions"})),K?a.createElement(a.Fragment,null,L?null:a.createElement(h.Z,{title:"view.instance.server.no_metadata_actions"}),a.createElement("div",{className:"text-center mb-3"},a.createElement(s.Z,{overlay:I,show:!M&&void 0},a.createElement(o.Z,{variant:"success",className:"mx-2",onClick:function(){return j.apply(this,arguments)},disabled:L&&n.status!=f.Ni.Offline||!M},a.createElement(c.Z,{id:"view.instance.server.start"}))),a.createElement(s.Z,{overlay:I,show:!q&&void 0},a.createElement(o.Z,{variant:"danger",className:"mx-2",onClick:function(){return V.apply(this,arguments)},disabled:L&&n.status!=f.Ni.Online||!q},a.createElement(c.Z,{id:"view.instance.server.stop"}))),a.createElement(s.Z,{overlay:I,show:!D&&void 0},a.createElement(o.Z,{variant:"warning",className:"mx-2",onClick:function(){return W.apply(this,arguments)},disabled:L&&n.status!=f.Ni.Online||!D},a.createElement(c.Z,{id:"view.instance.server.restart"}))),a.createElement(s.Z,{overlay:I,show:!H&&void 0},a.createElement(o.Z,{variant:"info",className:"mx-2",onClick:function(){return A.apply(this,arguments)},disabled:L&&n.status!=f.Ni.Online||!H},a.createElement(c.Z,{id:"view.instance.server.dump"}))))):a.createElement(h.Z,{title:"view.instance.server.no_actions"}),!L&&F?a.createElement(h.Z,{title:"view.instance.server.no_metadata_graceful"}):null,L||F?a.createElement("div",{className:"w-75 mx-auto"},a.createElement(b.ZP,{name:"view.instance.graceful",type:b.fS.Enum,enum:r,tooltip:"view.instance.graceful.desc",defaultValue:n.softRestart?r.Restart:n.softShutdown?r.Stop:r.None,disabled:!F,onChange:function(e){switch(e){case r.None:if(!(null!=n&&n.softRestart||null!=n&&n.softShutdown))return;C({softShutdown:!n.softShutdown&&void 0,softRestart:!n.softRestart&&void 0});break;case r.Stop:if(null!=n&&n.softShutdown)return;C({softShutdown:!0});break;case r.Restart:if(null!=n&&n.softRestart)return;C({softRestart:!0})}}})):K?a.createElement(h.Z,{title:"view.instance.server.no_graceful"}):null,a.createElement("hr",null),a.createElement("h3",{className:"text-center"},a.createElement(c.Z,{id:"view.instance.server.deployment_info"})),a.createElement(w.Z,null))}!function(e){e[e.None=0]="None",e[e.Stop=1]="Stop",e[e.Restart=2]="Restart"}(r||(r={}))},27977:function(e,t,n){var r=n(87462),a=n(63366),i=n(94184),o=n.n(i),s=n(67294),l=n(76792),c=["bsPrefix","variant","pill","className","as"],u=s.forwardRef((function(e,t){var n=e.bsPrefix,i=e.variant,u=e.pill,f=e.className,d=e.as,m=void 0===d?"span":d,p=(0,a.Z)(e,c),y=(0,l.vE)(n,"badge");return s.createElement(m,(0,r.Z)({ref:t},p,{className:o()(f,y,u&&y+"-pill",i&&y+"-"+i)}))}));u.displayName="Badge",u.defaultProps={pill:!1},t.Z=u}}]);
//# sourceMappingURL=883.0edb5c5ffead40262241.js.map