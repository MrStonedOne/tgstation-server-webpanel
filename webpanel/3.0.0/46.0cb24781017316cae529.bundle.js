"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[46,664],{9049:function(e,t,n){n.d(t,{fS:function(){return r},Pg:function(){return Z},ZP:function(){return w}});var a,r,i=n(7462),l=n(3366),s=n(7814),c=n(7294),o=n(5005),u=n(2258),d=n(2318),m=n(5293),f=n(3489),p=n(4012),v=["ref"];!function(e){e.Boolean="boolean",e.Number="number",e.String="string",e.Password="password",e.Enum="enum"}(r||(r={}));var g=c.forwardRef((function(e,t){return c.createElement(u.Z.Control,{value:e.value,onChange:function(t){return e.onChange(t.target.value)},disabled:e.disabled,ref:t})})),b=c.forwardRef((function(e,t){return c.createElement(u.Z.Control,{value:e.value,onChange:function(t){return e.onChange(t.target.value)},disabled:e.disabled,type:"password",ref:t})})),h=c.forwardRef((function(e,t){var n=Math.random().toString();return c.createElement("label",{htmlFor:n,className:"d-flex m-0 flex-grow-1 justify-content-center align-content-center"},c.createElement(u.Z.Check,{id:n,checked:e.value,onChange:function(t){return e.onChange(t.target.checked)},type:"switch",className:"m-auto",disabled:e.disabled,ref:t}))})),E=c.forwardRef((function(e,t){return c.createElement(u.Z.Control,{value:e.value,onChange:function(t){return e.onChange(isNaN(t.target.valueAsNumber)?t.target.value:t.target.valueAsNumber)},disabled:e.disabled,min:e.min,max:e.max,type:"number",ref:t})})),y=c.forwardRef((function(e,t){return c.createElement(u.Z.Control,{value:e.value,onChange:function(t){return e.onChange(parseInt(t.target.value))},disabled:e.disabled,as:"select",custom:!0,ref:t},Object.entries(e.enum).filter((function(e){var t=e[0];return isNaN(parseInt(t))})).map((function(t){var n=t[0],a=t[1];return c.createElement(p.Z,{id:e.name+"."+n,key:n},(function(e){return c.createElement("option",{key:a,value:a},e)}))})))})),Z=((a={})[r.Enum]=0,a[r.Number]=0,a[r.Boolean]=!1,a[r.String]="",a[r.Password]="",a);function w(e){var t,n,a,u=(0,c.useState)(null!=(t=e.defaultValue)?t:Z[e.type]),w=u[0],S=u[1],x=(0,c.useRef)(null);(0,c.useEffect)((function(){var t;S(null!=(t=e.defaultValue)?t:Z[e.type])}),[e.defaultValue]),(0,c.useEffect)((function(){x.current&&(x.current.checkValidity()?x.current.classList.remove("is-invalid"):x.current.classList.add("is-invalid")),C(w)}),[w]);var N,C=function(t){var n,a,i,l,s,c;switch(e.type){case r.Boolean:return void e.onChange(t,null==(n=null==(a=x.current)?void 0:a.checkValidity())||n);case r.Enum:case r.Number:return void e.onChange(t,null==(i=null==(l=x.current)?void 0:l.checkValidity())||i);case r.String:case r.Password:return void e.onChange(t,null==(s=null==(c=x.current)?void 0:c.checkValidity())||s)}},k=((n={string:g,password:b,boolean:h})[r.Number]=void 0,n[r.Enum]=void 0,n),P=w!=(null!=(a=e.defaultValue)?a:Z[e.type]);return c.createElement(d.Z,null,c.createElement(m.Z,{overlay:(N=e.tooltip,N?c.createElement(f.Z,{id:N},c.createElement(p.Z,{id:N})):c.createElement(c.Fragment,null)),show:!!e.tooltip&&void 0},(function(t){var n=t.ref,a=(0,l.Z)(t,v);return c.createElement(d.Z.Prepend,{className:"w-40"},c.createElement(d.Z.Text,(0,i.Z)({className:"flex-grow-1"},a),c.createElement("span",{className:P?"font-weight-bold":""},c.createElement(p.Z,{id:e.name})),c.createElement("div",{className:"ml-auto"},e.disabled?c.createElement(p.Z,{id:"generic.readonly"}):null,c.createElement("div",{ref:n,className:"d-inline-block ml-2",style:{visibility:e.tooltip?"unset":"hidden"}},c.createElement(s.G,{icon:"info"})))))})),e.type===r.Number?c.createElement(E,{value:w,onChange:function(e){return S(e)},name:e.name,disabled:e.disabled,max:e.max,min:e.min,ref:x}):e.type===r.Enum?c.createElement(y,{value:w,onChange:function(e){return S(e)},name:e.name,enum:e.enum,disabled:e.disabled}):c.createElement(k[e.type],{value:w,onChange:function(e){return S(e)},disabled:e.disabled,name:e.type,ref:x}),c.createElement(d.Z.Append,null,c.createElement(o.Z,{style:{visibility:!P||e.disabled?"hidden":void 0},variant:"danger",onClick:function(){var t;return S(null!=(t=e.defaultValue)?t:Z[e.type])}},c.createElement(s.G,{icon:"undo"}))))}},5619:function(e,t,n){n.d(t,{Z:function(){return p}});var a=n(3366),r=n(7462),i=n(7294),l=n(5005),s=n(5293),c=n(3489),o=n(4012),u=n(9049),d=["disabled"];function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function p(e){var t=new Map,n=new Map,f=(0,i.useState)({}),p=f[0],v=f[1];(0,i.useEffect)((function(){Object.keys(e.fields).forEach((function(e){v((function(t){var n;return(0,r.Z)({},t,((n={})[e]={},n))}))}))}),[]),Object.entries(e.fields).forEach((function(e){var a,r=e[0],l=e[1];n.set(r,l),t.set(l,(0,i.useState)(null!=(a=l.defaultValue)?a:u.Pg[l.type]))}));for(var g,b=!1,h=!1,E=m(n);!(g=E()).done;){var y,Z=g.value,w=Z[0],S=Z[1],x=t.get(S)[0],N=p[w];if((null!=(y=S.defaultValue)?y:u.Pg[S.type])!=x&&(b=!0),null!=N&&N.invalid&&(h=!0),b&&h)break}return e.hideDisabled&&!Object.values(e.fields).some((function(e){return!e.disabled}))?i.createElement(i.Fragment,null):i.createElement("div",null,Object.entries(e.fields).map((function(n){var l=n[0],s=n[1],c=s.disabled,o=(0,a.Z)(s,d);return e.hideDisabled&&c?null:i.createElement(u.ZP,(0,r.Z)({key:l},o,{disabled:e.readOnly||c,onChange:function(e,n){t.get(s)[1](e),v((function(e){var t;return(0,r.Z)({},e,((t={})[l]=(0,r.Z)({},e[l],{invalid:!n}),t))}))}}))})),i.createElement("div",{className:"text-center mt-2"},i.createElement(s.Z,{overlay:i.createElement(c.Z,{id:"form-invalid"},i.createElement(o.Z,{id:"generic.invalid_form"})),show:!!h&&void 0},i.createElement(l.Z,{variant:e.readOnly||h?"danger":"success",disabled:e.readOnly||!b||h,onClick:function(){for(var a,r={},i=m(n);!(a=i()).done;){var l,s=a.value,c=s[0],o=s[1],d=t.get(o)[0];(o.alwaysInclude||d!=(null!=(l=o.defaultValue)?l:u.Pg[o.type])||e.includeAll)&&(r[c]=d)}e.onSave(r)}},i.createElement(o.Z,{id:"generic.save"})))))}},8425:function(e,t,n){n.d(t,{t:function(){return c}});var a=n(7294),r=n(5171),i=n.n(r),l=n(7961);function s(e){return a.createElement(i(),{src:e.obj,name:"JSON",theme:"tube",iconStyle:"triangle",collapsed:!0,displayDataTypes:!1})}function c(e){return l.ZP.showjson.value?a.createElement("div",{className:"text-left"},a.createElement(s,{obj:e.obj})):a.createElement(a.Fragment,null)}},6642:function(e,t,n){n.d(t,{Z:function(){return c}});var a=n(1721),r=n(7294),i=n(5881),l=n(4012),s=n(6755),c=function(e){function t(){return e.apply(this,arguments)||this}return(0,a.Z)(t,e),t.prototype.render=function(){return r.createElement(i.Z,{className:"bg-transparent",border:"info"},r.createElement(i.Z.Header,{className:"bg-info text-dark font-weight-bold"},r.createElement(l.Z,{id:"generic.wip"})),r.createElement(i.Z.Body,null,r.createElement(i.Z.Title,null,r.createElement(l.Z,{id:"generic.wip.desc"}),r.createElement("a",{href:"https://github.com/tgstation/Tgstation.Server.ControlPanel/releases/latest"},"https://github.com/tgstation/Tgstation.Server.ControlPanel/releases/latest")),r.createElement(i.Z.Text,{as:"pre",className:"bg-transparent text-info"},r.createElement("code",null,"Version: "+s.q4+"\nWebpanel Mode: "+s.IK+"\nCurrent route: "+window.location.toString()))))},t}(r.Component)},6046:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var a,r=n(5861),i=n(7757),l=n.n(i),s=n(7294),c=n(7977),o=n(5005),u=n(5293),d=n(3489),m=n(4012),f=n(7179),p=n(8509),v=n(3803),g=n(9521),b=n(6190),h=n(6964),E=n(3e3),y=n(9635),Z=n(9049),w=n(5619),S=n(8425),x=n(5855),N=n(6642);function C(){var e=(0,s.useContext)(b.g),t=(0,s.useState)(),n=t[0],i=t[1],C=(0,s.useState)(!1),k=C[0],P=C[1],R=(0,s.useState)([]);function V(){return O.apply(this,arguments)}function O(){return(O=(0,r.Z)(l().mark((function t(){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((0,h.mg)(e.instancePermissionSet,p.py.ReadMetadata)){t.next=2;break}return t.abrupt("return",i({}));case 2:return t.next=4,f.Z.getWatchdogStatus(e.instance.id);case 4:(n=t.sent).code===v.G.ERROR?(0,E.iT)(R,n.error):i(n.payload);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(e){return _.apply(this,arguments)}function _(){return(_=(0,r.Z)(l().mark((function t(n){var a;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.next=3,f.Z.updateWatchdogStatus(e.instance.id,n);case 3:return(a=t.sent).code===v.G.ERROR&&(0,E.iT)(R,a.error),t.next=7,V();case 7:P(!1);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(){return(j=(0,r.Z)(l().mark((function t(){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.next=3,f.Z.startWatchdog(e.instance.id);case 3:if((n=t.sent).code!==v.G.ERROR){t.next=8;break}(0,E.iT)(R,n.error),t.next=12;break;case 8:return g.Z.registerCallback(n.payload.id,(function(){V()})),g.Z.fastmode=5,t.next=12,V();case 12:P(!1);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function A(){return(A=(0,r.Z)(l().mark((function t(){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.next=3,f.Z.stopWatchdog(e.instance.id);case 3:if((n=t.sent).code!==v.G.ERROR){t.next=8;break}(0,E.iT)(R,n.error),t.next=10;break;case 8:return t.next=10,V();case 10:P(!1);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function W(){return(W=(0,r.Z)(l().mark((function t(){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.next=3,f.Z.restartWatchdog(e.instance.id);case 3:if((n=t.sent).code!==v.G.ERROR){t.next=8;break}(0,E.iT)(R,n.error),t.next=12;break;case 8:return g.Z.registerCallback(n.payload.id,(function(){V()})),g.Z.fastmode=5,t.next=12,V();case 12:P(!1);case 13:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function G(){return(G=(0,r.Z)(l().mark((function t(){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.next=3,f.Z.dumpWatchdog(e.instance.id);case 3:(n=t.sent).code===v.G.ERROR?(0,E.iT)(R,n.error):g.Z.fastmode=5,P(!1);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}if((0,s.useEffect)((function(){V()}),[]),!n)return s.createElement(s.Fragment,null,(0,E.hP)(R));if(k)return s.createElement(x.Z,null);var I={autoStart:{type:Z.fS.Boolean,name:"fields.instance.watchdog.autostart",defaultValue:n.autoStart,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetAutoStart)},port:{type:Z.fS.Number,name:"fields.instance.watchdog.port",defaultValue:n.port,min:0,max:65535,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetPort)},visibility:{type:Z.fS.Enum,name:"fields.instance.watchdog.visibility",defaultValue:n.visibility,enum:p.Ye,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetVisibility)},securityLevel:{type:Z.fS.Enum,name:"fields.instance.watchdog.securitylevel",defaultValue:n.securityLevel,enum:p.ns,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetSecurity)},startupTimeout:{type:Z.fS.Number,name:"fields.instance.watchdog.timeout.startup",defaultValue:n.startupTimeout,min:0,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetStartupTimeout)},topicRequestTimeout:{type:Z.fS.Number,name:"fields.instance.watchdog.timeout.topic",defaultValue:n.topicRequestTimeout,min:0,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetTopicTimeout)},heartbeatSeconds:{type:Z.fS.Number,name:"fields.instance.watchdog.heartbeat",defaultValue:n.heartbeatSeconds,min:0,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetHeartbeatInterval)},allowWebClient:{type:Z.fS.Boolean,name:"fields.instance.watchdog.allowwebclient",defaultValue:n.allowWebClient,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetWebClient)},additionalParameters:{type:Z.fS.String,name:"fields.instance.watchdog.additionalparams",defaultValue:n.additionalParameters,disabled:!(0,h.mg)(e.instancePermissionSet,p.py.SetAdditionalParameters)}},B=Object.values(I).some((function(e){return!e.disabled})),M=s.createElement(d.Z,{id:"generic.no_perm"},s.createElement(m.Z,{id:"generic.no_perm"})),F=(0,h.mg)(e.instancePermissionSet,p.py.Start),D=(0,h.mg)(e.instancePermissionSet,p.py.Shutdown),L=(0,h.mg)(e.instancePermissionSet,p.py.Restart),q=(0,h.mg)(e.instancePermissionSet,p.py.CreateDump),z=(0,h.mg)(e.instancePermissionSet,p.py.ReadMetadata),H=(0,h.mg)(e.instancePermissionSet,p.py.SoftShutdown)||(0,h.mg)(e.instancePermissionSet,p.py.SoftRestart),J=F||D||L||q;return s.createElement("div",null,s.createElement(S.t,{obj:n}),(0,E.hP)(R),s.createElement("h2",{className:"text-center"},s.createElement(m.Z,{id:"view.instance.server.status"}),s.createElement(c.Z,{pill:!0,variant:n.status===p.Ni.Online?"success":n.status===p.Ni.Offline?"danger":"warning"},s.createElement(m.Z,{id:"view.instance.server.status."+p.Ni[n.status]}))),s.createElement("hr",null),s.createElement("h3",{className:"text-center"},s.createElement(m.Z,{id:"view.instance.server.settings"})),z?null:B?s.createElement(y.Z,{title:"view.instance.server.no_metadata"}):s.createElement(y.Z,{title:"view.instance.server.no_metadata_and_no_settings"}),s.createElement(w.Z,{fields:I,onSave:T,hideDisabled:!z}),s.createElement("hr",null),s.createElement("h3",{className:"text-center"},s.createElement(m.Z,{id:"view.instance.server.actions"})),J?s.createElement(s.Fragment,null,z?null:s.createElement(y.Z,{title:"view.instance.server.no_metadata_actions"}),s.createElement("div",{className:"text-center mb-3"},s.createElement(u.Z,{overlay:M,show:!F&&void 0},s.createElement(o.Z,{variant:"success",className:"mx-2",onClick:function(){return j.apply(this,arguments)},disabled:z&&n.status!=p.Ni.Offline||!F},s.createElement(m.Z,{id:"view.instance.server.start"}))),s.createElement(u.Z,{overlay:M,show:!D&&void 0},s.createElement(o.Z,{variant:"danger",className:"mx-2",onClick:function(){return A.apply(this,arguments)},disabled:z&&n.status!=p.Ni.Online||!D},s.createElement(m.Z,{id:"view.instance.server.stop"}))),s.createElement(u.Z,{overlay:M,show:!L&&void 0},s.createElement(o.Z,{variant:"warning",className:"mx-2",onClick:function(){return W.apply(this,arguments)},disabled:z&&n.status!=p.Ni.Online||!L},s.createElement(m.Z,{id:"view.instance.server.restart"}))),s.createElement(u.Z,{overlay:M,show:!q&&void 0},s.createElement(o.Z,{variant:"info",className:"mx-2",onClick:function(){return G.apply(this,arguments)},disabled:z&&n.status!=p.Ni.Online||!q},s.createElement(m.Z,{id:"view.instance.server.dump"}))))):s.createElement(y.Z,{title:"view.instance.server.no_actions"}),!z&&H?s.createElement(y.Z,{title:"view.instance.server.no_metadata_graceful"}):null,z||H?s.createElement("div",{className:"w-75 mx-auto"},s.createElement(Z.ZP,{name:"view.instance.graceful",type:Z.fS.Enum,enum:a,tooltip:"view.instance.graceful.desc",defaultValue:n.softRestart?a.Restart:n.softShutdown?a.Stop:a.None,disabled:!H,onChange:function(e){switch(e){case a.None:if(!(null!=n&&n.softRestart||null!=n&&n.softShutdown))return;T({softShutdown:!n.softShutdown&&void 0,softRestart:!n.softRestart&&void 0});break;case a.Stop:if(null!=n&&n.softShutdown)return;T({softShutdown:!0});break;case a.Restart:if(null!=n&&n.softRestart)return;T({softRestart:!0})}}})):J?s.createElement(y.Z,{title:"view.instance.server.no_graceful"}):null,s.createElement("hr",null),s.createElement("h3",{className:"text-center"},s.createElement(m.Z,{id:"view.instance.server.deployment_info"})),s.createElement(N.Z,null))}!function(e){e[e.None=0]="None",e[e.Stop=1]="Stop",e[e.Restart=2]="Restart"}(a||(a={}))},6190:function(e,t,n){n.d(t,{g:function(){return a}});var a=n(7294).createContext(void 0)},7977:function(e,t,n){var a=n(7462),r=n(3366),i=n(4184),l=n.n(i),s=n(7294),c=n(6792),o=["bsPrefix","variant","pill","className","as"],u=s.forwardRef((function(e,t){var n=e.bsPrefix,i=e.variant,u=e.pill,d=e.className,m=e.as,f=void 0===m?"span":m,p=(0,r.Z)(e,o),v=(0,c.vE)(n,"badge");return s.createElement(f,(0,a.Z)({ref:t},p,{className:l()(d,v,u&&v+"-pill",i&&v+"-"+i)}))}));u.displayName="Badge",u.defaultProps={pill:!1},t.Z=u},2318:function(e,t,n){var a=n(3366),r=n(7462),i=n(4184),l=n.n(i),s=n(7294),c=n(4680),o=n(6792),u=["bsPrefix","size","hasValidation","className","as"],d=(0,c.Z)("input-group-append"),m=(0,c.Z)("input-group-prepend"),f=(0,c.Z)("input-group-text",{Component:"span"}),p=s.forwardRef((function(e,t){var n=e.bsPrefix,i=e.size,c=e.hasValidation,d=e.className,m=e.as,f=void 0===m?"div":m,p=(0,a.Z)(e,u);return n=(0,o.vE)(n,"input-group"),s.createElement(f,(0,r.Z)({ref:t},p,{className:l()(d,n,i&&n+"-"+i,c&&"has-validation")}))}));p.displayName="InputGroup",p.Text=f,p.Radio=function(e){return s.createElement(f,null,s.createElement("input",(0,r.Z)({type:"radio"},e)))},p.Checkbox=function(e){return s.createElement(f,null,s.createElement("input",(0,r.Z)({type:"checkbox"},e)))},p.Append=d,p.Prepend=m,t.Z=p}}]);
//# sourceMappingURL=46.0cb24781017316cae529.bundle.js.map