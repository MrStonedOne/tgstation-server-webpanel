"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[799],{1304:function(t,e,r){r.r(e);var s=r(5861),a=r(7326),n=r(1721),o=r(7757),i=r.n(o),u=r(7294),l=r(5005),c=r(1555),d=r(2258),h=r(4012),p=r(5977),m=r(1895),E=r(6846),w=r(3803),f=r(5631),g=r(6942),Z=r(4615),v=r(3e3),b=r(5855),y=function(t){function e(e,r){var s,n;if(s=t.call(this,e)||this,null==r||!r.user)throw Error("ChangePassword: this.context?.user is null!");return n=e.match.params.id?parseInt(e.match.params.id):r.user.id,s.state={errors:[],password1:"",password2:"",userId:n,currentUser:r.user.id===n,loading:!0},s.submit=s.submit.bind((0,a.Z)(s)),s}(0,n.Z)(e,t);var r=e.prototype;return r.componentDidMount=function(){var t=(0,s.Z)(i().mark((function t(){var e;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.Z.getUser(this.state.userId);case 2:(e=t.sent).code==w.G.OK?this.setState({user:e.payload}):this.addError(e.error),this.setState({loading:!1});case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.addError=function(t){this.setState((function(e){var r=Array.from(e.errors);return r.push(t),{errors:r}}))},r.submit=function(){var t=(0,s.Z)(i().mark((function t(e){var r,s;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.state.user){t.next=3;break}return this.addError(new E.ZP(E.jK.APP_FAIL,{jsError:Error("changepassword submit: this.user is falsy")})),t.abrupt("return");case 3:if(e.preventDefault(),r=!1,this.state.password1.length<this.context.serverInfo.minimumPasswordLength?(r=!0,this.setState({lengthError:!0})):this.setState({lengthError:!1}),this.state.password2!==this.state.password1?(r=!0,this.setState({matchError:!0})):this.setState({matchError:!1}),!r){t.next=9;break}return t.abrupt("return");case 9:return this.setState({pwdload:!0}),t.next=12,g.Z.editUser({password:this.state.password1,id:this.state.user.id});case 12:s=t.sent,t.t0=s.code,t.next=t.t0===w.G.OK?16:t.t0===w.G.ERROR?19:22;break;case 16:return this.state.currentUser&&f.Z.login({type:m.P.Password,userName:this.state.user.name,password:this.state.password1}),this.props.history.goBack(),t.abrupt("break",22);case 19:return this.addError(s.error),this.setState({pwdload:!1}),t.abrupt("break",22);case 22:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.render=function(){var t=this;if(this.state.loading)return u.createElement(b.Z,{text:"loading.info"});if(this.state.pwdload)return u.createElement(b.Z,{text:"loading.passwd"});return u.createElement(d.Z,{onSubmit:this.submit},u.createElement(c.Z,{className:"mx-auto",lg:5,md:8},this.state.errors.map((function(e,r){if(e)return u.createElement(v.ZP,{key:r,error:e,onClose:function(){return t.setState((function(t){var e=Array.from(t.errors);return e[r]=void 0,{errors:e}}))}})})),this.state.user?u.createElement(u.Fragment,null,u.createElement("h3",null,u.createElement(h.Z,{id:"view.user.passwd.title"}),this.state.user.name,"(",this.state.user.id,")"),u.createElement("hr",null),u.createElement(d.Z.Group,{controlId:"password1"},u.createElement(d.Z.Label,null,u.createElement(h.Z,{id:"login.password"})),u.createElement(d.Z.Control,{type:"password",onChange:function(e){return t.setState({password1:e.target.value})},value:this.state.password1,isInvalid:this.state.matchError||this.state.lengthError}),u.createElement(d.Z.Control.Feedback,{type:"invalid"},this.state.lengthError?u.createElement(u.Fragment,null,u.createElement(h.Z,{id:"login.password.repeat.short"}),this.context.serverInfo.minimumPasswordLength):"")),u.createElement(d.Z.Group,{controlId:"password2"},u.createElement(d.Z.Label,null,u.createElement(h.Z,{id:"login.password.repeat"})),u.createElement(d.Z.Control,{type:"password",onChange:function(e){return t.setState({password2:e.target.value})},value:this.state.password2,isInvalid:this.state.matchError||this.state.lengthError}),u.createElement(d.Z.Control.Feedback,{type:"invalid"},this.state.matchError?u.createElement(h.Z,{id:"login.password.repeat.match"}):"")),u.createElement(l.Z,{type:"submit"},u.createElement(h.Z,{id:"routes.passwd"}))):""))},e}(u.Component);y.contextType=Z.f,e.default=(0,p.EN)(y)}}]);
//# sourceMappingURL=799.97f9738cd68c9d98b58f.bundle.js.map