"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[408],{8425:function(e,t,r){r.d(t,{t:function(){return c}});var a=r(7294),n=r(5171),s=r.n(n),o=r(7961);function l(e){return a.createElement(s(),{src:e.obj,name:"JSON",theme:"tube",iconStyle:"triangle",collapsed:!0,displayDataTypes:!1})}function c(e){return o.ZP.showjson.value?a.createElement("div",{className:"text-left"},a.createElement(l,{obj:e.obj})):a.createElement(a.Fragment,null)}},9905:function(e,t,r){r.d(t,{Z:function(){return D}});var a=r(7462),n=r(3366),s=r(1721),o=r(7814),l=r(7294),c=r(5005),i=r(2258),m=r(5293),p=r(4184),u=r.n(p),d=r(6792),h=r(8358),g=["active","disabled","className","style","activeLabel","children"],f=["children"],v=l.forwardRef((function(e,t){var r=e.active,s=e.disabled,o=e.className,c=e.style,i=e.activeLabel,m=e.children,p=(0,n.Z)(e,g),d=r||s?"span":h.Z;return l.createElement("li",{ref:t,style:c,className:u()(o,"page-item",{active:r,disabled:s})},l.createElement(d,(0,a.Z)({className:"page-link",disabled:s},p),m,r&&i&&l.createElement("span",{className:"sr-only"},i)))}));v.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},v.displayName="PageItem";var E=v;function b(e,t,r){function a(e){var a=e.children,s=(0,n.Z)(e,f);return l.createElement(v,s,l.createElement("span",{"aria-hidden":"true"},a||t),l.createElement("span",{className:"sr-only"},r))}return void 0===r&&(r=e),a.displayName=e,a}var P=b("First","\xab"),Z=b("Prev","\u2039","Previous"),y=b("Ellipsis","\u2026","More"),N=b("Next","\u203a"),x=b("Last","\xbb"),w=["bsPrefix","className","children","size"],k=l.forwardRef((function(e,t){var r=e.bsPrefix,s=e.className,o=e.children,c=e.size,i=(0,n.Z)(e,w),m=(0,d.vE)(r,"pagination");return l.createElement("ul",(0,a.Z)({ref:t},i,{className:u()(s,m,c&&m+"-"+c)}),o)}));k.First=P,k.Prev=Z,k.Ellipsis=y,k.Item=E,k.Next=N,k.Last=x;var L=k,C=(r(5638),["as","bsPrefix","className","children"]),R=l.forwardRef((function(e,t){var r=e.as,s=void 0===r?"div":r,o=e.bsPrefix,c=e.className,i=e.children,m=(0,n.Z)(e,C);return o=(0,d.vE)(o,"popover-header"),l.createElement(s,(0,a.Z)({ref:t},m,{className:u()(o,c)}),i)})),S=["as","bsPrefix","className","children"],M=l.forwardRef((function(e,t){var r=e.as,s=void 0===r?"div":r,o=e.bsPrefix,c=e.className,i=e.children,m=(0,n.Z)(e,S);return o=(0,d.vE)(o,"popover-body"),l.createElement(s,(0,a.Z)({ref:t},m,{className:u()(c,o)}),i)})),G=["bsPrefix","placement","className","style","children","content","arrowProps","popper","show"],_=l.forwardRef((function(e,t){var r=e.bsPrefix,s=e.placement,o=e.className,c=e.style,i=e.children,m=e.content,p=e.arrowProps,h=(e.popper,e.show,(0,n.Z)(e,G)),g=(0,d.vE)(r,"popover"),f=((null==s?void 0:s.split("-"))||[])[0];return l.createElement("div",(0,a.Z)({ref:t,role:"tooltip",style:c,"x-placement":f,className:u()(o,g,f&&"bs-popover-"+f)},h),l.createElement("div",(0,a.Z)({className:"arrow"},p)),m?l.createElement(M,null,i):i)}));_.defaultProps={placement:"right"},_.Title=R,_.Content=M;var I=_,j=r(4012),O=["selectPage","totalPages","currentPage"],D=function(e){function t(t){var r;return(r=e.call(this,t)||this).state={showGoto:!1,gotoValue:t.currentPage},r}return(0,s.Z)(t,e),t.prototype.render=function(){for(var e=this,t=[],r=Math.max(this.props.totalPages-this.props.currentPage-1,0),s=Math.max(this.props.currentPage-2,0),p=Math.max(this.props.currentPage-Math.max(5-Number(this.props.currentPage!==this.props.totalPages)-r,2),2),u=Math.min(this.props.currentPage+Math.max(5-Number(1!==this.props.currentPage)-s,2),this.props.totalPages-1),d=function(r){t.push(l.createElement(L.Item,{key:r,active:r===e.props.currentPage,onClick:function(){return e.props.selectPage(r)}},r))},h=p;h<=u;h++)d(h);var g=this.props.totalPages>7?l.createElement(L.Ellipsis,{disabled:!0}):null,f=l.createElement(I,{id:"popover-gotopage"},l.createElement(I.Title,null,l.createElement(j.Z,{id:"generic.goto.title"})),l.createElement(I.Content,null,l.createElement("form",{className:"d-flex",onSubmit:function(t){t.preventDefault(),e.props.selectPage(e.state.gotoValue),e.setState({showGoto:!1})}},l.createElement(i.Z.Control,{className:"mr-2",type:"number",min:1,max:this.props.totalPages,value:this.state.gotoValue,onChange:function(t){return e.setState({gotoValue:parseInt(t.target.value)})},custom:!0}),l.createElement(c.Z,{type:"submit"},l.createElement(j.Z,{id:"generic.goto"}))))),v=this.props,E=(v.selectPage,v.totalPages,v.currentPage,(0,n.Z)(v,O));return l.createElement("div",(0,a.Z)({className:"text-center",style:{position:"sticky",bottom:"1.5em"}},E),l.createElement(L,{className:"justify-content-center"},l.createElement(L.Prev,{disabled:this.props.currentPage<=1,onClick:function(){return e.props.selectPage(Math.max(e.props.currentPage-1,1))}}),l.createElement(L.Item,{active:this.props.currentPage<=1,onClick:function(){return e.props.selectPage(1)}},"1"),g,t,g,this.props.totalPages>=2?l.createElement(L.Item,{active:this.props.currentPage>=this.props.totalPages,onClick:function(){return e.props.selectPage(e.props.totalPages)}},this.props.totalPages):null,this.props.totalPages>7?l.createElement(m.Z,{show:this.state.showGoto,placement:"top",overlay:f},l.createElement(L.Item,{onClick:function(){return e.setState((function(e){return{showGoto:!e.showGoto}}))}},l.createElement(o.G,{icon:"search"}))):null,l.createElement(L.Next,{disabled:this.props.currentPage>=this.props.totalPages,onClick:function(){return e.props.selectPage(Math.min(e.props.currentPage+1,e.props.totalPages))}})))},t}(l.PureComponent)},3408:function(e,t,r){r.r(t);var a=r(3366),n=r(5861),s=r(1721),o=r(7757),l=r.n(o),c=r(7294),i=r(5005),m=r(682),p=r(5293),u=r(5147),d=r(3489),h=r(4012),g=r(8272),f=r(5977),v=r(3727),E=r(2480),b=r(6846),P=r(3803),Z=r(6964),y=r(1320),N=r(3e3),x=r(8425),w=r(5855),k=r(9905),L=["ref"];t.default=(0,f.EN)(function(e){function t(t){var r,a;return(a=e.call(this,t)||this).state={errors:[],loading:!0,logs:[],page:null!=(r=y.Mq.loglistpage)?r:1},a}(0,s.Z)(t,e);var r=t.prototype;return r.componentDidUpdate=function(){var e=(0,n.Z)(l().mark((function e(t,r){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.page===this.state.page){e.next=4;break}return y.Mq.loglistpage=this.state.page,e.next=4,this.loadLogs();case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),r.componentDidMount=function(){var e=(0,n.Z)(l().mark((function e(){var t,r,a,n,s;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.props.match.params.name)){e.next=15;break}return e.next=4,E.Z.getLog(t);case 4:r=e.sent,e.t0=r.code,e.next=e.t0===P.G.OK?8:e.t0===P.G.ERROR?13:15;break;case 8:for(a=RegExp(/(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{7}[-+]\d{2}:\d{2})\s+(.*?)(?=(?:\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{7}[-+]\d{2}:\d{2}|$))/,"gs"),s=[];null!==(n=a.exec(r.payload.content));)s.push({time:n[1],content:n[2]});return this.setState({viewedLog:{logFile:r.payload,entries:s}}),e.abrupt("break",15);case 13:return this.addError(r.error),e.abrupt("break",15);case 15:return e.next=17,this.loadLogs();case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.loadLogs=function(){var e=(0,n.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,E.Z.getLogs({page:this.state.page});case 3:t=e.sent,e.t0=t.code,e.next=e.t0===P.G.OK?7:e.t0===P.G.ERROR?12:14;break;case 7:if(!(this.state.page>t.payload.totalPages&&0!==t.payload.totalPages)){e.next=10;break}return this.setState({page:1}),e.abrupt("return");case 10:return this.setState({logs:t.payload.content,maxPage:t.payload.totalPages}),e.abrupt("break",14);case 12:return this.addError(t.error),e.abrupt("break",14);case 14:this.setState({loading:!1});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.addError=function(e){this.setState((function(t){var r=Array.from(t.errors);return r.push(e),{errors:r}}))},r.downloadLog=function(){var e=(0,n.Z)(l().mark((function e(t){var r;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.Z.getLog(t);case 2:r=e.sent,e.t0=r.code,e.next=e.t0===P.G.OK?6:e.t0===P.G.ERROR?8:10;break;case 6:return(0,Z.LR)(t,r.payload.content),e.abrupt("break",10);case 8:return this.addError(r.error),e.abrupt("break",10);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.render=function(){var e,t,r=this;return c.createElement("div",{className:"text-center"},this.state.errors.map((function(e,t){if(e)return c.createElement(N.ZP,{key:t,error:e,onClose:function(){return r.setState((function(e){var r=Array.from(e.errors);return r[t]=void 0,{errors:r}}))}})})),this.state.loading?c.createElement(w.Z,{text:"loading.logs"}):this.props.match.params.name&&this.state.viewedLog?c.createElement("div",{className:"mx-5 mt-5"},c.createElement(x.t,{obj:this.state.viewedLog}),c.createElement("h3",null,this.props.match.params.name),c.createElement(i.Z,{className:"mr-1",as:v.rU,to:null!=(e=y.$w.admin_logs.link)?e:y.$w.admin_logs.route},c.createElement(h.Z,{id:"generic.goback"})),c.createElement(i.Z,{onClick:function(){(0,Z.LR)(r.props.match.params.name,r.state.viewedLog.logFile.content)}},c.createElement(h.Z,{id:"generic.download"})),c.createElement("hr",null),c.createElement("div",{style:{height:"60vh",display:"block"},className:"table-responsive"},c.createElement(u.Z,{striped:!0,hover:!0,variant:"dark",className:"text-left"},c.createElement("thead",{className:"bg-dark",style:{position:"sticky",top:0}},c.createElement("th",null,c.createElement(h.Z,{id:"generic.datetime"})),c.createElement("th",null,c.createElement(h.Z,{id:"generic.entry"}))),c.createElement("tbody",null,this.state.viewedLog.entries.map((function(e){return c.createElement("tr",{key:e.time},c.createElement("td",{className:"py-1"},e.time),c.createElement("td",{className:"py-1"},c.createElement("pre",{className:"mb-0"},e.content)))})))))):c.createElement(m.Z,{className:"mt-5 mb-5"},c.createElement(x.t,{obj:this.state.logs}),c.createElement(u.Z,{striped:!0,bordered:!0,hover:!0,variant:"dark",responsive:!0},c.createElement("thead",null,c.createElement("tr",null,c.createElement("th",null,"#"),c.createElement("th",null,c.createElement(h.Z,{id:"generic.name"})),c.createElement("th",null,c.createElement(h.Z,{id:"generic.datetime"})),c.createElement("th",null,c.createElement(h.Z,{id:"generic.action"})))),c.createElement("tbody",null,this.state.logs.map((function(e,t){var n=new Date(e.lastModified),s=(n.getTime()-Date.now())/1e3;return c.createElement("tr",{key:e.name},c.createElement("td",null,t),c.createElement("td",null,e.name),c.createElement(p.Z,{overlay:c.createElement(d.Z,{id:e.name+"-tooltip"},n.toLocaleString())},(function(e){var t=e.ref,r=(0,a.Z)(e,L);return c.createElement("td",r,c.createElement("span",{ref:t},c.createElement(g.Z,{value:s,numeric:"auto",updateIntervalInSeconds:1})))})),c.createElement("td",{className:"align-middle p-0"},c.createElement(i.Z,{className:"mr-1",onClick:function(){var t;r.props.history.push((null!=(t=y.$w.admin_logs.link)?t:y.$w.admin_logs.route)+e.name+"/",{reload:!0})}},c.createElement(h.Z,{id:"generic.view"})),c.createElement(i.Z,{onClick:function(){r.downloadLog(e.name).catch((function(e){r.addError(new b.ZP(b.jK.APP_FAIL,{jsError:e}))}))}},c.createElement(h.Z,{id:"generic.download"}))))})))),c.createElement(k.Z,{selectPage:function(e){return r.setState({page:e})},totalPages:null!=(t=this.state.maxPage)?t:1,currentPage:this.state.page})))},t}(c.Component))},5147:function(e,t,r){var a=r(7462),n=r(3366),s=r(4184),o=r.n(s),l=r(7294),c=r(6792),i=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],m=l.forwardRef((function(e,t){var r=e.bsPrefix,s=e.className,m=e.striped,p=e.bordered,u=e.borderless,d=e.hover,h=e.size,g=e.variant,f=e.responsive,v=(0,n.Z)(e,i),E=(0,c.vE)(r,"table"),b=o()(s,E,g&&E+"-"+g,h&&E+"-"+h,m&&E+"-striped",p&&E+"-bordered",u&&E+"-borderless",d&&E+"-hover"),P=l.createElement("table",(0,a.Z)({},v,{className:b,ref:t}));if(f){var Z=E+"-responsive";return"string"==typeof f&&(Z=Z+"-"+f),l.createElement("div",{className:Z},P)}return P}));t.Z=m}}]);
//# sourceMappingURL=408.3afc367474127e0f33d9.bundle.js.map