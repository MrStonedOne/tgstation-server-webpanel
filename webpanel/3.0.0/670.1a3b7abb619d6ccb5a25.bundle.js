"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[670],{8425:function(e,t,r){r.d(t,{t:function(){return l}});var n=r(7294),a=r(5171),s=r.n(a),i=r(7961);function c(e){return n.createElement(s(),{src:e.obj,name:"JSON",theme:"tube",iconStyle:"triangle",collapsed:!0,displayDataTypes:!1})}function l(e){return i.ZP.showjson.value?n.createElement("div",{className:"text-left"},n.createElement(c,{obj:e.obj})):n.createElement(n.Fragment,null)}},9905:function(e,t,r){r.d(t,{Z:function(){return _}});var n=r(7462),a=r(3366),s=r(1721),i=r(7814),c=r(7294),l=r(5005),o=r(2258),u=r(5293),p=r(4184),m=r.n(p),d=r(6792),f=r(8358),h=["active","disabled","className","style","activeLabel","children"],v=["children"],g=c.forwardRef((function(e,t){var r=e.active,s=e.disabled,i=e.className,l=e.style,o=e.activeLabel,u=e.children,p=(0,a.Z)(e,h),d=r||s?"span":f.Z;return c.createElement("li",{ref:t,style:l,className:m()(i,"page-item",{active:r,disabled:s})},c.createElement(d,(0,n.Z)({className:"page-link",disabled:s},p),u,r&&o&&c.createElement("span",{className:"sr-only"},o)))}));g.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},g.displayName="PageItem";var E=g;function b(e,t,r){function n(e){var n=e.children,s=(0,a.Z)(e,v);return c.createElement(g,s,c.createElement("span",{"aria-hidden":"true"},n||t),c.createElement("span",{className:"sr-only"},r))}return void 0===r&&(r=e),n.displayName=e,n}var P=b("First","\xab"),Z=b("Prev","\u2039","Previous"),y=b("Ellipsis","\u2026","More"),x=b("Next","\u203a"),N=b("Last","\xbb"),w=["bsPrefix","className","children","size"],k=c.forwardRef((function(e,t){var r=e.bsPrefix,s=e.className,i=e.children,l=e.size,o=(0,a.Z)(e,w),u=(0,d.vE)(r,"pagination");return c.createElement("ul",(0,n.Z)({ref:t},o,{className:m()(s,u,l&&u+"-"+l)}),i)}));k.First=P,k.Prev=Z,k.Ellipsis=y,k.Item=E,k.Next=x,k.Last=N;var C=k,S=(r(5638),["as","bsPrefix","className","children"]),I=c.forwardRef((function(e,t){var r=e.as,s=void 0===r?"div":r,i=e.bsPrefix,l=e.className,o=e.children,u=(0,a.Z)(e,S);return i=(0,d.vE)(i,"popover-header"),c.createElement(s,(0,n.Z)({ref:t},u,{className:m()(i,l)}),o)})),A=["as","bsPrefix","className","children"],M=c.forwardRef((function(e,t){var r=e.as,s=void 0===r?"div":r,i=e.bsPrefix,l=e.className,o=e.children,u=(0,a.Z)(e,A);return i=(0,d.vE)(i,"popover-body"),c.createElement(s,(0,n.Z)({ref:t},u,{className:m()(l,i)}),o)})),j=["bsPrefix","placement","className","style","children","content","arrowProps","popper","show"],O=c.forwardRef((function(e,t){var r=e.bsPrefix,s=e.placement,i=e.className,l=e.style,o=e.children,u=e.content,p=e.arrowProps,f=(e.popper,e.show,(0,a.Z)(e,j)),h=(0,d.vE)(r,"popover"),v=((null==s?void 0:s.split("-"))||[])[0];return c.createElement("div",(0,n.Z)({ref:t,role:"tooltip",style:l,"x-placement":v,className:m()(i,h,v&&"bs-popover-"+v)},f),c.createElement("div",(0,n.Z)({className:"arrow"},p)),u?c.createElement(M,null,o):o)}));O.defaultProps={placement:"right"},O.Title=I,O.Content=M;var G=O,R=r(4012),T=["selectPage","totalPages","currentPage"],_=function(e){function t(t){var r;return(r=e.call(this,t)||this).state={showGoto:!1,gotoValue:t.currentPage},r}return(0,s.Z)(t,e),t.prototype.render=function(){for(var e=this,t=[],r=Math.max(this.props.totalPages-this.props.currentPage-1,0),s=Math.max(this.props.currentPage-2,0),p=Math.max(this.props.currentPage-Math.max(5-Number(this.props.currentPage!==this.props.totalPages)-r,2),2),m=Math.min(this.props.currentPage+Math.max(5-Number(1!==this.props.currentPage)-s,2),this.props.totalPages-1),d=function(r){t.push(c.createElement(C.Item,{key:r,active:r===e.props.currentPage,onClick:function(){return e.props.selectPage(r)}},r))},f=p;f<=m;f++)d(f);var h=this.props.totalPages>7?c.createElement(C.Ellipsis,{disabled:!0}):null,v=c.createElement(G,{id:"popover-gotopage"},c.createElement(G.Title,null,c.createElement(R.Z,{id:"generic.goto.title"})),c.createElement(G.Content,null,c.createElement("form",{className:"d-flex",onSubmit:function(t){t.preventDefault(),e.props.selectPage(e.state.gotoValue),e.setState({showGoto:!1})}},c.createElement(o.Z.Control,{className:"mr-2",type:"number",min:1,max:this.props.totalPages,value:this.state.gotoValue,onChange:function(t){return e.setState({gotoValue:parseInt(t.target.value)})},custom:!0}),c.createElement(l.Z,{type:"submit"},c.createElement(R.Z,{id:"generic.goto"}))))),g=this.props,E=(g.selectPage,g.totalPages,g.currentPage,(0,a.Z)(g,T));return c.createElement("div",(0,n.Z)({className:"text-center",style:{position:"sticky",bottom:"1.5em"}},E),c.createElement(C,{className:"justify-content-center"},c.createElement(C.Prev,{disabled:this.props.currentPage<=1,onClick:function(){return e.props.selectPage(Math.max(e.props.currentPage-1,1))}}),c.createElement(C.Item,{active:this.props.currentPage<=1,onClick:function(){return e.props.selectPage(1)}},"1"),h,t,h,this.props.totalPages>=2?c.createElement(C.Item,{active:this.props.currentPage>=this.props.totalPages,onClick:function(){return e.props.selectPage(e.props.totalPages)}},this.props.totalPages):null,this.props.totalPages>7?c.createElement(u.Z,{show:this.state.showGoto,placement:"top",overlay:v},c.createElement(C.Item,{onClick:function(){return e.setState((function(e){return{showGoto:!e.showGoto}}))}},c.createElement(i.G,{icon:"search"}))):null,c.createElement(C.Next,{disabled:this.props.currentPage>=this.props.totalPages,onClick:function(){return e.props.selectPage(Math.min(e.props.currentPage+1,e.props.totalPages))}})))},t}(c.PureComponent)},670:function(e,t,r){r.r(t);var n=r(7462),a=r(3366),s=r(5861),i=r(7326),c=r(1721),l=r(7757),o=r.n(l),u=r(98),p=r(7814),m=r(7294),d=r(7977),f=r(5005),h=r(5293),v=r(5147),g=r(3489),E=r(4012),b=r(5977),P=r(1249),Z=r(8509),y=r(6352),x=r(5870),N=r(6846),w=r(3803),k=r(5631),C=r(4615),S=r(6964),I=r(1320),A=r(3e3),M=r(8425),j=r(5855),O=r(9905),G=["ref"];function R(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _=function(e){function t(t){var r,n;return(n=e.call(this,t)||this).setOnline=n.setOnline.bind((0,i.Z)(n)),n.state={loading:!0,instances:[],errors:[],page:null!=(r=I.Mq.instancelistpage)?r:1},n}(0,c.Z)(t,e);var r=t.prototype;return r.addError=function(e){this.setState((function(t){var r=Array.from(t.errors);return r.push(e),{errors:r}}))},r.componentDidUpdate=function(){var e=(0,s.Z)(o().mark((function e(t,r){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.page===this.state.page){e.next=4;break}return I.Mq.instancelistpage=this.state.page,e.next=4,this.loadInstances();case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),r.loadInstances=function(){var e=(0,s.Z)(o().mark((function e(){var t,r,n,a,s,i,c,l,u=this;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,y.Z.listInstances({page:this.state.page});case 3:return t=e.sent,e.next=6,k.Z.getServerInfo();case 6:if(r=e.sent,n=r.code===w.G.OK&&(0,P.satisfies)(r.payload.apiVersion,"<9.1.0"),a=[],t.code!=w.G.OK){e.next=21;break}if(!(this.state.page>t.payload.totalPages&&0!==t.payload.totalPages)){e.next=13;break}return this.setState({page:1}),e.abrupt("return");case 13:for(s=[],i=function(){var e=l.value,t=e;n?e.online?s.push(x.Z.getCurrentInstancePermissionSet(e.id).then((function(e){e.code==w.G.OK?t.canAccess=!0:(t.canAccess=!1,e.error.code!==N.jK.HTTP_ACCESS_DENIED&&u.addError(e.error)),a.push(t)}))):(t.canAccess=!1,a.push(t)):(t.canAccess=t.online&&t.accessible,a.push(t))},c=R(t.payload.content);!(l=c()).done;)i();return e.next=18,Promise.all(s);case 18:this.setState({instances:a.sort((function(e,t){return e.id-t.id})),maxPage:t.payload.totalPages}),e.next=22;break;case 21:this.addError(t.error);case 22:this.setState({loading:!1});case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.componentDidMount=function(){var e=(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadInstances();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),r.setOnline=function(){var e=(0,s.Z)(o().mark((function e(t){var r,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!t.online,e.next=3,y.Z.editInstance({id:t.id,online:r});case 3:if((n=e.sent).code!==w.G.OK){e.next=9;break}return e.next=7,this.loadInstances();case 7:e.next=10;break;case 9:this.addError(n.error);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r.render=function(){var e,t=this;if(this.state.loading)return m.createElement(j.Z,{text:"loading.instance.list"});var r=!!((0,S.Zg)(this.context.user).instanceManagerRights&Z.c2.SetOnline),n={verticalAlign:"middle"};return m.createElement("div",{className:"text-center"},m.createElement(M.t,{obj:this.state.instances}),this.state.errors.map((function(e,r){if(e)return m.createElement(A.ZP,{key:r,error:e,onClose:function(){return t.setState((function(e){var t=Array.from(e.errors);return t[r]=void 0,{errors:t}}))}})})),m.createElement("h3",null,m.createElement(E.Z,{id:"view.instance.list.title"})),m.createElement(v.Z,{striped:!0,bordered:!0,hover:!0,variant:"dark",responsive:!0,className:"mb-4"},m.createElement("thead",null,m.createElement("tr",null,m.createElement("th",null,"#"),m.createElement("th",null,m.createElement(E.Z,{id:"generic.name"})),m.createElement("th",null,m.createElement(E.Z,{id:"generic.online"})),m.createElement("th",null,m.createElement(E.Z,{id:"generic.path"})),m.createElement("th",null,m.createElement(E.Z,{id:"generic.configmode"})),m.createElement("th",null,m.createElement(E.Z,{id:"generic.action"})))),m.createElement("tbody",null,this.state.instances.map((function(e){return m.createElement("tr",{key:e.id},m.createElement("td",{style:n},e.id),m.createElement("td",{style:n},e.name),m.createElement("td",{style:n},e.online?m.createElement(d.Z,{variant:"success"},m.createElement(E.Z,{id:"generic.online"})):m.createElement(d.Z,{variant:"danger"},m.createElement(E.Z,{id:"generic.offline"}))),m.createElement("td",{style:n},e.moveJob?m.createElement(E.Z,{id:"view.instance.moving"}):e.path),m.createElement("td",{style:n},m.createElement(E.Z,{id:"view.instance.configmode."+e.configurationType.toString()})),m.createElement("td",{className:"align-middle p-1",style:n},m.createElement(f.Z,{className:"mx-1",onClick:function(){var r;I.Mq.selectedinstanceid=e.id,t.props.history.push(null!=(r=I.$w.instanceedit.link)?r:I.$w.instanceedit.route)},disabled:!e.canAccess},m.createElement(E.Z,{id:"generic.edit"})),m.createElement(f.Z,{className:"mx-1",variant:e.online?"danger":"success",onClick:function(){return t.setOnline(e)},disabled:!r},m.createElement(E.Z,{id:"view.instance.list.set."+(e.online?"offline":"online")}))))})))),m.createElement(O.Z,{selectPage:function(e){return t.setState({page:e})},totalPages:null!=(e=this.state.maxPage)?e:1,currentPage:this.state.page}),m.createElement("div",{className:"align-middle"},m.createElement("div",{className:"mb-4"},this.renderAddInstance()),m.createElement(f.Z,{className:"mx-1",onClick:function(){var e;t.props.history.push(null!=(e=I.$w.instancejobs.link)?e:I.$w.instancejobs.route)}},m.createElement(E.Z,{id:"routes.instancejobs"}))))},r.renderAddInstance=function(){var e=this,t=!!((0,S.Zg)(this.context.user).instanceManagerRights&Z.c2.Create);return m.createElement(h.Z,{overlay:m.createElement(g.Z,{id:"create-instance-tooltip"},m.createElement(E.Z,{id:"perms.instance.create.warning"})),show:!t&&void 0},(function(r){var s=r.ref,i=(0,a.Z)(r,G);return m.createElement(f.Z,(0,n.Z)({ref:s,className:"mx-1",variant:"success",onClick:function(){var t;e.props.history.push(null!=(t=I.$w.instancecreate.link)?t:I.$w.instancecreate.route)},disabled:!t},i),m.createElement("div",null,m.createElement(p.G,{className:"mr-2",icon:u.r8}),m.createElement(E.Z,{id:"routes.instancecreate"})))}))},t}(m.Component);_.contextType=C.f,t.default=(0,b.EN)(_)},7977:function(e,t,r){var n=r(7462),a=r(3366),s=r(4184),i=r.n(s),c=r(7294),l=r(6792),o=["bsPrefix","variant","pill","className","as"],u=c.forwardRef((function(e,t){var r=e.bsPrefix,s=e.variant,u=e.pill,p=e.className,m=e.as,d=void 0===m?"span":m,f=(0,a.Z)(e,o),h=(0,l.vE)(r,"badge");return c.createElement(d,(0,n.Z)({ref:t},f,{className:i()(p,h,u&&h+"-pill",s&&h+"-"+s)}))}));u.displayName="Badge",u.defaultProps={pill:!1},t.Z=u},5147:function(e,t,r){var n=r(7462),a=r(3366),s=r(4184),i=r.n(s),c=r(7294),l=r(6792),o=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],u=c.forwardRef((function(e,t){var r=e.bsPrefix,s=e.className,u=e.striped,p=e.bordered,m=e.borderless,d=e.hover,f=e.size,h=e.variant,v=e.responsive,g=(0,a.Z)(e,o),E=(0,l.vE)(r,"table"),b=i()(s,E,h&&E+"-"+h,f&&E+"-"+f,u&&E+"-striped",p&&E+"-bordered",m&&E+"-borderless",d&&E+"-hover"),P=c.createElement("table",(0,n.Z)({},g,{className:b,ref:t}));if(v){var Z=E+"-responsive";return"string"==typeof v&&(Z=Z+"-"+v),c.createElement("div",{className:Z},P)}return P}));t.Z=u}}]);
//# sourceMappingURL=670.1a3b7abb619d6ccb5a25.bundle.js.map