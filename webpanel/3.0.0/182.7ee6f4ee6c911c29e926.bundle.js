"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[182],{2685:function(e,t,n){n.r(t);var r=n(7462),a=n(5861),i=n(7326),s=n(1721),o=n(7757),c=n.n(o),u=n(7294),l=n(5977),d=n(8509),m=n(6352),f=n(3803),p=n(6190),h=n(6964),v=n(3e3),E=n(9049),y=n(5619),b=n(8425),x=function(e){function t(t){var n;return(n=e.call(this,t)||this).editInstance=n.editInstance.bind((0,i.Z)(n)),n.state={errors:[]},n}(0,s.Z)(t,e);var n=t.prototype;return n.addError=function(e){this.setState((function(t){var n=Array.from(t.errors);return n.push(e),{errors:n}}))},n.editInstance=function(){var e=(0,a.Z)(c().mark((function e(t){var n;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.Z.editInstance((0,r.Z)({},t,{id:this.context.instance.id}));case 2:(n=e.sent).code===f.G.OK?this.context.reloadInstance():this.addError(n.error);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.render=function(){var e=this,t=function(t){return(0,h.D0)((0,h.Zg)(e.context.user),t)},n={name:{name:"fields.instance.name",type:E.fS.String,defaultValue:this.context.instance.name,disabled:!t(d.c2.Rename)},path:{name:"fields.instance.path",type:E.fS.String,defaultValue:this.context.instance.path,disabled:!t(d.c2.Relocate)},chatBotLimit:{name:"fields.instance.chatbotlimit",type:E.fS.Number,min:0,defaultValue:this.context.instance.chatBotLimit,disabled:!t(d.c2.SetChatBotLimit)},autoUpdateInterval:{name:"fields.instance.autoupdate",type:E.fS.Number,min:0,defaultValue:this.context.instance.autoUpdateInterval,disabled:!t(d.c2.SetAutoUpdate)},configurationType:{name:"fields.instance.filemode",type:E.fS.Enum,enum:d.c7,defaultValue:this.context.instance.configurationType,disabled:!t(d.c2.SetConfiguration)}};return u.createElement("div",{className:"text-center"},u.createElement(b.t,{obj:this.context}),this.state.errors.map((function(t,n){if(t)return u.createElement(v.ZP,{key:n,error:t,onClose:function(){return e.setState((function(e){var t=Array.from(e.errors);return t[n]=void 0,{errors:t}}))}})})),u.createElement(y.Z,{fields:n,onSave:this.editInstance}))},t}(u.Component);x.contextType=p.g,t.default=(0,l.EN)(x)},5921:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var r=n(5861),a=n(7757),i=n.n(a),s=n(7294),o=n(3204),c=n(3803),u=n(9521),l=n(6190),d=n(1320),m=n(3e3),f=n(3128),p=n(8425),h=n(5855),v=n(9905);function E(){var e,t=s.useContext(l.g),n=(0,s.useState)([]),a=n[0],E=n[1],y=(0,s.useState)([]),b=y[0],x=y[1],S=(0,s.useState)(!0),Z=S[0],g=S[1],P=(0,s.useState)(null!=(e=d.Mq.jobhistorypage.get(t.instance.id))?e:1),w=P[0],C=P[1],I=(0,s.useState)(void 0),O=I[0],k=I[1];function N(){return(N=(0,r.Z)(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.listJobs(t.instance.id,{page:w});case 2:(n=e.sent).code===c.G.OK?(w>n.payload.totalPages&&0!==n.payload.totalPages&&C(1),E(n.payload.content),k(n.payload.totalPages)):K(n.error),g(!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){x((function(t){var n=Array.from(t);return n.push(e),n}))}function A(e){return T.apply(this,arguments)}function T(){return(T=(0,r.Z)(i().mark((function e(t){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Z.deleteJob(t.instanceid,t.id);case 2:(n=e.sent).code===c.G.OK?u.Z.fastmode=5:K(n.error);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return(0,s.useEffect)((function(){d.Mq.jobhistorypage.set(t.instance.id,w),g(!0),function(){N.apply(this,arguments)}()}),[w]),(0,s.useEffect)((function(){}),[b]),Z?s.createElement(h.Z,{text:"loading.instance.jobs.list"}):s.createElement("div",null,s.createElement(p.t,{obj:a}),b.map((function(e,t){if(e)return s.createElement(m.ZP,{key:t,error:e,onClose:function(){return x((function(e){var n=Array.from(e);return n[t]=void 0,n}))}})})),a.sort((function(e,t){return t.id-e.id})).filter((function(e){return!!e.stoppedAt})).map((function(e){return s.createElement(f.Z,{job:e,key:e.id,onCancel:A})})),s.createElement(v.Z,{selectPage:function(e){return C(e)},totalPages:null!=O?O:1,currentPage:w}))}},9182:function(e,t,n){n.r(t);var r=n(5861),a=n(7326),i=n(1721),s=n(7757),o=n.n(s),c=n(7814),u=n(7294),l=n(5881),d=n(3361),m=n(6841),f=n(4012),p=n(5977),h=n(8509),v=n(6352),E=n(5870),y=n(3803),b=n(7961),x=n(4615),S=n(6190),Z=n(1320),g=n(7888),P=n(5855),w=n(6642),C=n(161),I=n(2685),O=n(5921),k=n(6046),N=h.D8.ReadActive|h.D8.ListInstalled|h.D8.InstallOfficialOrChangeActiveVersion|h.D8.InstallCustomVersion,K=h.py.SetPort|h.py.SetAutoStart|h.py.SetSecurity|h.py.ReadMetadata|h.py.SetWebClient|h.py.SoftRestart|h.py.SoftShutdown|h.py.Restart|h.py.Shutdown|h.py.Start|h.py.SetStartupTimeout|h.py.SetHeartbeatInterval|h.py.CreateDump|h.py.SetTopicTimeout|h.py.SetAdditionalParameters|h.py.SetVisibility,A=function(e){function t(n){var r,i;return(i=e.call(this,n)||this).reloadInstance=i.reloadInstance.bind((0,a.Z)(i)),i.deleteContextError=i.deleteContextError.bind((0,a.Z)(i)),Z.Mq.selectedinstanceid=parseInt(i.props.match.params.id),i.state={tab:null!=(r=n.match.params.tab)?r:t.tabs[0][0],errors:new Set,instance:null,instancePermissionSet:null,reloadInstance:i.reloadInstance,deleteError:i.deleteContextError,instanceid:parseInt(i.props.match.params.id)},i}(0,i.Z)(t,e);var n=t.prototype;return n.deleteContextError=function(e){this.setState((function(t){var n=new Set(t.errors);return n.delete(e),{errors:n}}))},n.componentDidMount=function(){var e=(0,r.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.reloadInstance();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.componentDidUpdate=function(e){this.props.match.params.tab&&e.match.params.tab!=this.props.match.params.tab&&this.setState({tab:this.props.match.params.tab})},n.reloadInstance=function(){var e=(0,r.Z)(o().mark((function e(){var t,n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({instance:null,instancePermissionSet:null}),e.next=3,v.Z.getInstance(this.state.instanceid);case 3:if((t=e.sent).code!==y.G.OK){e.next=12;break}return this.setState({instance:t.payload}),e.next=8,E.Z.getCurrentInstancePermissionSet(this.state.instanceid);case 8:(n=e.sent).code===y.G.OK?this.setState({instancePermissionSet:n.payload}):this.setState((function(e){var t=new Set(e.errors);return t.add(n.error),{instancePermissionSet:null,errors:t}})),e.next=13;break;case 12:this.setState((function(e){var n=new Set(e.errors);return n.add(t.error),{instance:null,errors:n}}));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.render=function(){var e=this;if(!this.state.instance||!this.state.instancePermissionSet)return u.createElement(P.Z,{text:"loading.instance"});return u.createElement(S.g.Provider,{value:Object.assign({user:this.context.user,serverInfo:this.context.serverInfo},this.state)},u.createElement(l.Z,null,u.createElement(l.Z.Header,{className:"text-center mb-2 sticky-top"},u.createElement("h3",null,u.createElement(f.Z,{id:"view.instanceedit.title",values:{instanceid:this.props.match.params.id,instancename:this.state.instance.name}})),u.createElement("h5",{className:"text-white-50"},u.createElement(f.Z,{id:"view.instanceedit.tabs."+this.state.tab}))),u.createElement(m.Z.Container,{mountOnEnter:!0,unmountOnExit:!0,id:"instanceedit",activeKey:this.state.tab},u.createElement("div",{className:"d-flex flex-row"},u.createElement(l.Z.Body,{className:"flex-grow-0"},u.createElement(d.Z,{defaultActiveKey:e.state.tab,onSelect:function(n){var r,a,i;n=null!=(r=n)?r:t.tabs[0][0],Z.Mq.selectedinstanceedittab=n,e.props.history.push(null!=(a=Z.$w.instanceedit.link)?a:Z.$w.instanceedit.route),e.setState({tab:null!=(i=n)?i:t.tabs[0][0]})},fill:!0,variant:"pills",activeKey:e.state.tab,className:"flex-nowrap text-nowrap flex-column hover-bar sticky-top "+(b.ZP.instanceeditsidebar.value===b.mf.COLLAPSE?"pin-close":b.ZP.instanceeditsidebar.value===b.mf.EXPAND?"pin-open":""),style:{top:"8em"}},t.tabs.map((function(t){var n=t[0],r=t[1],a=t[2],i=t[3];if(!e.state.instancePermissionSet)throw Error("this.state.instancePermissionSet is null in instanceedit nav map");var s=!i,o=!a(e.state.instancePermissionSet,e.context);return u.createElement(d.Z.Item,{key:n},u.createElement(d.Z.Link,{eventKey:n,bsPrefix:"nav-link instanceedittab",className:(s?"no-access text-white":"")+(o?"no-access text-white font-italic":"")+" text-left"},u.createElement(u.Fragment,null,u.createElement(c.G,{icon:o?"lock":r,fixedWidth:!0}),u.createElement("div",{className:"tab-text d-inline-block "+(o?"font-weight-lighter":"")},u.createElement("span",{className:"pl-1"},u.createElement(f.Z,{id:"view.instanceedit.tabs."+n}))))))})))),u.createElement(l.Z.Body,{className:"bg-body"},u.createElement(m.Z.Content,null,t.tabs.map((function(t){var n=t[0],r=t[2],a=t[3];if(!e.state.instancePermissionSet)throw Error("this.state.instancePermissionSet is null in render card map");return u.createElement(m.Z.Pane,{eventKey:n,key:n},a?r(e.state.instancePermissionSet,e.context)?u.createElement(a,null):u.createElement(g.Z,null):u.createElement(w.Z,null))}))))))))},t}(u.Component);A.tabs=[["info","info",function(){return!0}],["repository","code-branch",function(){return!0}],["deployment","hammer",function(){return!0}],["dd","server",function(e){return!!(e.dreamDaemonRights&K)},k.default],["byond","list-ul",function(e){return!!(e.byondRights&N)},C.default],["chatbots","comments",function(){return!0}],["files","folder-open",function(){return!0}],["users","users",function(){return!0}],["jobs","stream",function(){return!0},O.default],["config","cogs",function(){return!0},I.default]],A.contextType=x.f,t.default=(0,p.EN)(A)},6841:function(e,t,n){var r=n(1721),a=n(7294),i=n(7184),s=n(8752),o=n(5103),c=function(e){function t(){return e.apply(this,arguments)||this}return(0,r.Z)(t,e),t.prototype.render=function(){throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")},t}(a.Component);c.Container=i.Z,c.Content=s.Z,c.Pane=o.Z,t.Z=c},7184:function(e,t,n){var r=n(7294),a=n(4289),i=n(4426),s=n(5017);t.Z=function(e){var t=(0,a.Ch)(e,{activeKey:"onSelect"}),n=t.id,o=t.generateChildId,c=t.onSelect,u=t.activeKey,l=t.transition,d=t.mountOnEnter,m=t.unmountOnExit,f=t.children,p=(0,r.useMemo)((function(){return o||function(e,t){return n?n+"-"+t+"-"+e:null}}),[n,o]),h=(0,r.useMemo)((function(){return{onSelect:c,activeKey:u,transition:l,mountOnEnter:d||!1,unmountOnExit:m||!1,getControlledId:function(e){return p(e,"tabpane")},getControllerId:function(e){return p(e,"tab")}}}),[c,u,l,d,m,p]);return r.createElement(i.Z.Provider,{value:h},r.createElement(s.Z.Provider,{value:c||null},f))}},8752:function(e,t,n){var r=n(7462),a=n(3366),i=n(4184),s=n.n(i),o=n(7294),c=n(6792),u=["bsPrefix","as","className"],l=o.forwardRef((function(e,t){var n=e.bsPrefix,i=e.as,l=void 0===i?"div":i,d=e.className,m=(0,a.Z)(e,u),f=(0,c.vE)(n,"tab-content");return o.createElement(l,(0,r.Z)({ref:t},m,{className:s()(d,f)}))}));t.Z=l},5103:function(e,t,n){var r=n(7462),a=n(3366),i=n(4184),s=n.n(i),o=n(7294),c=n(6792),u=n(4426),l=n(5017),d=n(9280),m=["activeKey","getControlledId","getControllerId"],f=["bsPrefix","className","active","onEnter","onEntering","onEntered","onExit","onExiting","onExited","mountOnEnter","unmountOnExit","transition","as","eventKey"];var p=o.forwardRef((function(e,t){var n=function(e){var t=(0,o.useContext)(u.Z);if(!t)return e;var n=t.activeKey,i=t.getControlledId,s=t.getControllerId,c=(0,a.Z)(t,m),f=!1!==e.transition&&!1!==c.transition,p=(0,l.h)(e.eventKey);return(0,r.Z)({},e,{active:null==e.active&&null!=p?(0,l.h)(n)===p:e.active,id:i(e.eventKey),"aria-labelledby":s(e.eventKey),transition:f&&(e.transition||c.transition||d.Z),mountOnEnter:null!=e.mountOnEnter?e.mountOnEnter:c.mountOnEnter,unmountOnExit:null!=e.unmountOnExit?e.unmountOnExit:c.unmountOnExit})}(e),i=n.bsPrefix,p=n.className,h=n.active,v=n.onEnter,E=n.onEntering,y=n.onEntered,b=n.onExit,x=n.onExiting,S=n.onExited,Z=n.mountOnEnter,g=n.unmountOnExit,P=n.transition,w=n.as,C=void 0===w?"div":w,I=(n.eventKey,(0,a.Z)(n,f)),O=(0,c.vE)(i,"tab-pane");if(!h&&!P&&g)return null;var k=o.createElement(C,(0,r.Z)({},I,{ref:t,role:"tabpanel","aria-hidden":!h,className:s()(p,O,{active:h})}));return P&&(k=o.createElement(P,{in:h,onEnter:v,onEntering:E,onEntered:y,onExit:b,onExiting:x,onExited:S,mountOnEnter:Z,unmountOnExit:g},k)),o.createElement(u.Z.Provider,{value:null},o.createElement(l.Z.Provider,{value:null},k))}));p.displayName="TabPane",t.Z=p}}]);
//# sourceMappingURL=182.7ee6f4ee6c911c29e926.bundle.js.map