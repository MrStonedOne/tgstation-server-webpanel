"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[182],{2685:function(e,t,n){n.r(t);var a=n(7294),r=n(5977),s=n(8509),i=n(6352),o=n(3803),c=n(6190),l=n(6964),d=n(3e3),u=n(9049),m=n(5619),p=n(8425);class h extends a.Component{constructor(e){super(e),this.editInstance=this.editInstance.bind(this),this.state={errors:[]}}addError(e){this.setState((t=>{const n=Array.from(t.errors);return n.push(e),{errors:n}}))}async editInstance(e){const t=await i.Z.editInstance({...e,id:this.context.instance.id});t.code===o.G.OK?this.context.reloadInstance():this.addError(t.error)}render(){const e=e=>(0,l.D0)((0,l.Zg)(this.context.user),e),t={name:{name:"fields.instance.name",type:u.fS.String,defaultValue:this.context.instance.name,disabled:!e(s.c2.Rename)},path:{name:"fields.instance.path",type:u.fS.String,defaultValue:this.context.instance.path,disabled:!e(s.c2.Relocate)},chatBotLimit:{name:"fields.instance.chatbotlimit",type:u.fS.Number,min:0,defaultValue:this.context.instance.chatBotLimit,disabled:!e(s.c2.SetChatBotLimit)},autoUpdateInterval:{name:"fields.instance.autoupdate",type:u.fS.Number,min:0,defaultValue:this.context.instance.autoUpdateInterval,disabled:!e(s.c2.SetAutoUpdate)},configurationType:{name:"fields.instance.filemode",type:u.fS.Enum,enum:s.c7,defaultValue:this.context.instance.configurationType,disabled:!e(s.c2.SetConfiguration)}};return a.createElement("div",{className:"text-center"},a.createElement(p.t,{obj:this.context}),this.state.errors.map(((e,t)=>{if(e)return a.createElement(d.ZP,{key:t,error:e,onClose:()=>this.setState((e=>{const n=Array.from(e.errors);return n[t]=void 0,{errors:n}}))})})),a.createElement(m.Z,{fields:t,onSave:this.editInstance}))}}h.contextType=c.g,t.default=(0,r.EN)(h)},5921:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});var a=n(7294),r=n(3204),s=n(3803),i=n(9521),o=n(6190),c=n(1320),l=n(3e3),d=n(3128),u=n(8425),m=n(5855),p=n(9905);function h(){const e=a.useContext(o.g),[t,n]=(0,a.useState)([]),[h,f]=(0,a.useState)([]),[E,y]=(0,a.useState)(!0),[b,v]=(0,a.useState)(c.Mq.jobhistorypage.get(e.instance.id)??1),[S,x]=(0,a.useState)(void 0);function Z(e){f((t=>{const n=Array.from(t);return n.push(e),n}))}async function g(e){const t=await r.Z.deleteJob(e.instanceid,e.id);t.code===s.G.OK?i.Z.fastmode=5:Z(t.error)}return(0,a.useEffect)((()=>{c.Mq.jobhistorypage.set(e.instance.id,b),y(!0),async function(){const t=await r.Z.listJobs(e.instance.id,{page:b});t.code===s.G.OK?(b>t.payload.totalPages&&0!==t.payload.totalPages&&v(1),n(t.payload.content),x(t.payload.totalPages)):Z(t.error);y(!1)}()}),[b]),(0,a.useEffect)((()=>{}),[h]),E?a.createElement(m.Z,{text:"loading.instance.jobs.list"}):a.createElement("div",null,a.createElement(u.t,{obj:t}),h.map(((e,t)=>{if(e)return a.createElement(l.ZP,{key:t,error:e,onClose:()=>f((e=>{const n=Array.from(e);return n[t]=void 0,n}))})})),t.sort(((e,t)=>t.id-e.id)).filter((e=>!!e.stoppedAt)).map((e=>a.createElement(d.Z,{job:e,key:e.id,onCancel:g}))),a.createElement(p.Z,{selectPage:e=>v(e),totalPages:S??1,currentPage:b}))}},9182:function(e,t,n){n.r(t);var a=n(7814),r=n(7294),s=n(5881),i=n(3361),o=n(6841),c=n(4012),l=n(5977),d=n(8509),u=n(6352),m=n(5870),p=n(3803),h=n(7961),f=n(4615),E=n(6190),y=n(1320),b=n(7888),v=n(5855),S=n(6642),x=n(161),Z=n(2685),g=n(5921),P=n(6046);const C=d.D8.ReadActive|d.D8.ListInstalled|d.D8.InstallOfficialOrChangeActiveVersion|d.D8.InstallCustomVersion,w=d.py.SetPort|d.py.SetAutoStart|d.py.SetSecurity|d.py.ReadMetadata|d.py.SetWebClient|d.py.SoftRestart|d.py.SoftShutdown|d.py.Restart|d.py.Shutdown|d.py.Start|d.py.SetStartupTimeout|d.py.SetHeartbeatInterval|d.py.CreateDump|d.py.SetTopicTimeout|d.py.SetAdditionalParameters|d.py.SetVisibility;class I extends r.Component{constructor(e){super(e),this.reloadInstance=this.reloadInstance.bind(this),this.deleteContextError=this.deleteContextError.bind(this),y.Mq.selectedinstanceid=parseInt(this.props.match.params.id),this.state={tab:e.match.params.tab??I.tabs[0][0],errors:new Set,instance:null,instancePermissionSet:null,reloadInstance:this.reloadInstance,deleteError:this.deleteContextError,instanceid:parseInt(this.props.match.params.id)}}deleteContextError(e){this.setState((t=>{const n=new Set(t.errors);return n.delete(e),{errors:n}}))}async componentDidMount(){await this.reloadInstance()}componentDidUpdate(e){this.props.match.params.tab&&e.match.params.tab!=this.props.match.params.tab&&this.setState({tab:this.props.match.params.tab})}async reloadInstance(){this.setState({instance:null,instancePermissionSet:null});const e=await u.Z.getInstance(this.state.instanceid);if(e.code===p.G.OK){this.setState({instance:e.payload});const t=await m.Z.getCurrentInstancePermissionSet(this.state.instanceid);t.code===p.G.OK?this.setState({instancePermissionSet:t.payload}):this.setState((e=>{const n=new Set(e.errors);return n.add(t.error),{instancePermissionSet:null,errors:n}}))}else this.setState((t=>{const n=new Set(t.errors);return n.add(e.error),{instance:null,errors:n}}))}render(){if(!this.state.instance||!this.state.instancePermissionSet)return r.createElement(v.Z,{text:"loading.instance"});return r.createElement(E.g.Provider,{value:Object.assign({user:this.context.user,serverInfo:this.context.serverInfo},this.state)},r.createElement(s.Z,null,r.createElement(s.Z.Header,{className:"text-center mb-2 sticky-top"},r.createElement("h3",null,r.createElement(c.Z,{id:"view.instanceedit.title",values:{instanceid:this.props.match.params.id,instancename:this.state.instance.name}})),r.createElement("h5",{className:"text-white-50"},r.createElement(c.Z,{id:`view.instanceedit.tabs.${this.state.tab}`}))),r.createElement(o.Z.Container,{mountOnEnter:!0,unmountOnExit:!0,id:"instanceedit",activeKey:this.state.tab},r.createElement("div",{className:"d-flex flex-row"},r.createElement(s.Z.Body,{className:"flex-grow-0"},(()=>r.createElement(i.Z,{defaultActiveKey:this.state.tab,onSelect:e=>{e=e??I.tabs[0][0],y.Mq.selectedinstanceedittab=e,this.props.history.push(y.$w.instanceedit.link??y.$w.instanceedit.route),this.setState({tab:e??I.tabs[0][0]})},fill:!0,variant:"pills",activeKey:this.state.tab,className:"flex-nowrap text-nowrap flex-column hover-bar sticky-top "+(h.ZP.instanceeditsidebar.value===h.mf.COLLAPSE?"pin-close":h.ZP.instanceeditsidebar.value===h.mf.EXPAND?"pin-open":""),style:{top:"8em"}},I.tabs.map((([e,t,n,s])=>{if(!this.state.instancePermissionSet)throw Error("this.state.instancePermissionSet is null in instanceedit nav map");const o=!s,l=!n(this.state.instancePermissionSet,this.context);return r.createElement(i.Z.Item,{key:e},r.createElement(i.Z.Link,{eventKey:e,bsPrefix:"nav-link instanceedittab",className:(o?"no-access text-white":"")+(l?"no-access text-white font-italic":"")+" text-left"},r.createElement(r.Fragment,null,r.createElement(a.G,{icon:l?"lock":t,fixedWidth:!0}),r.createElement("div",{className:"tab-text d-inline-block "+(l?"font-weight-lighter":"")},r.createElement("span",{className:"pl-1"},r.createElement(c.Z,{id:`view.instanceedit.tabs.${e}`}))))))}))))()),r.createElement(s.Z.Body,{className:"bg-body"},r.createElement(o.Z.Content,null,I.tabs.map((([e,,t,n])=>{if(!this.state.instancePermissionSet)throw Error("this.state.instancePermissionSet is null in render card map");return r.createElement(o.Z.Pane,{eventKey:e,key:e},n?t(this.state.instancePermissionSet,this.context)?r.createElement(n,null):r.createElement(b.Z,null):r.createElement(S.Z,null))}))))))))}}I.tabs=[["info","info",()=>!0],["repository","code-branch",()=>!0],["deployment","hammer",()=>!0],["dd","server",e=>!!(e.dreamDaemonRights&w),P.default],["byond","list-ul",e=>!!(e.byondRights&C),x.default],["chatbots","comments",()=>!0],["files","folder-open",()=>!0],["users","users",()=>!0],["jobs","stream",()=>!0,g.default],["config","cogs",()=>!0,Z.default]],I.contextType=f.f,t.default=(0,l.EN)(I)},6841:function(e,t,n){var a=n(1721),r=n(7294),s=n(7184),i=n(8752),o=n(5103),c=function(e){function t(){return e.apply(this,arguments)||this}return(0,a.Z)(t,e),t.prototype.render=function(){throw new Error("ReactBootstrap: The `Tab` component is not meant to be rendered! It's an abstract component that is only valid as a direct Child of the `Tabs` Component. For custom tabs components use TabPane and TabsContainer directly")},t}(r.Component);c.Container=s.Z,c.Content=i.Z,c.Pane=o.Z,t.Z=c},7184:function(e,t,n){var a=n(7294),r=n(4289),s=n(4426),i=n(5017);t.Z=function(e){var t=(0,r.Ch)(e,{activeKey:"onSelect"}),n=t.id,o=t.generateChildId,c=t.onSelect,l=t.activeKey,d=t.transition,u=t.mountOnEnter,m=t.unmountOnExit,p=t.children,h=(0,a.useMemo)((function(){return o||function(e,t){return n?n+"-"+t+"-"+e:null}}),[n,o]),f=(0,a.useMemo)((function(){return{onSelect:c,activeKey:l,transition:d,mountOnEnter:u||!1,unmountOnExit:m||!1,getControlledId:function(e){return h(e,"tabpane")},getControllerId:function(e){return h(e,"tab")}}}),[c,l,d,u,m,h]);return a.createElement(s.Z.Provider,{value:f},a.createElement(i.Z.Provider,{value:c||null},p))}},8752:function(e,t,n){var a=n(7462),r=n(3366),s=n(4184),i=n.n(s),o=n(7294),c=n(6792),l=["bsPrefix","as","className"],d=o.forwardRef((function(e,t){var n=e.bsPrefix,s=e.as,d=void 0===s?"div":s,u=e.className,m=(0,r.Z)(e,l),p=(0,c.vE)(n,"tab-content");return o.createElement(d,(0,a.Z)({ref:t},m,{className:i()(u,p)}))}));t.Z=d},5103:function(e,t,n){var a=n(7462),r=n(3366),s=n(4184),i=n.n(s),o=n(7294),c=n(6792),l=n(4426),d=n(5017),u=n(9280),m=["activeKey","getControlledId","getControllerId"],p=["bsPrefix","className","active","onEnter","onEntering","onEntered","onExit","onExiting","onExited","mountOnEnter","unmountOnExit","transition","as","eventKey"];var h=o.forwardRef((function(e,t){var n=function(e){var t=(0,o.useContext)(l.Z);if(!t)return e;var n=t.activeKey,s=t.getControlledId,i=t.getControllerId,c=(0,r.Z)(t,m),p=!1!==e.transition&&!1!==c.transition,h=(0,d.h)(e.eventKey);return(0,a.Z)({},e,{active:null==e.active&&null!=h?(0,d.h)(n)===h:e.active,id:s(e.eventKey),"aria-labelledby":i(e.eventKey),transition:p&&(e.transition||c.transition||u.Z),mountOnEnter:null!=e.mountOnEnter?e.mountOnEnter:c.mountOnEnter,unmountOnExit:null!=e.unmountOnExit?e.unmountOnExit:c.unmountOnExit})}(e),s=n.bsPrefix,h=n.className,f=n.active,E=n.onEnter,y=n.onEntering,b=n.onEntered,v=n.onExit,S=n.onExiting,x=n.onExited,Z=n.mountOnEnter,g=n.unmountOnExit,P=n.transition,C=n.as,w=void 0===C?"div":C,I=(n.eventKey,(0,r.Z)(n,p)),O=(0,c.vE)(s,"tab-pane");if(!f&&!P&&g)return null;var N=o.createElement(w,(0,a.Z)({},I,{ref:t,role:"tabpanel","aria-hidden":!f,className:i()(h,O,{active:f})}));return P&&(N=o.createElement(P,{in:f,onEnter:E,onEntering:y,onEntered:b,onExit:v,onExiting:S,onExited:x,mountOnEnter:Z,unmountOnExit:g},N)),o.createElement(l.Z.Provider,{value:null},o.createElement(d.Z.Provider,{value:null},N))}));h.displayName="TabPane",t.Z=h}}]);
//# sourceMappingURL=182.ab65bd9d07360de663d6.bundle.js.map