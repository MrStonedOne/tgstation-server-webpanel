"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[161],{8425:function(e,t,a){a.d(t,{t:function(){return l}});var s=a(7294),n=a(5171),r=a.n(n),i=a(7961);function o(e){return s.createElement(r(),{src:e.obj,name:"JSON",theme:"tube",iconStyle:"triangle",collapsed:!0,displayDataTypes:!1})}function l(e){return i.ZP.showjson.value?s.createElement("div",{className:"text-left"},s.createElement(o,{obj:e.obj})):s.createElement(s.Fragment,null)}},9929:function(e,t,a){a.d(t,{Z:function(){return p}});var s=a(7814),n=a(7294),r=a(5005),i=a(2258),o=a(5293),l=a(8966),c=a(9611),d=a(4012);function m(){return m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},m.apply(this,arguments)}class p extends n.PureComponent{constructor(e){super(e),this.state={showGoto:!1,gotoValue:e.currentPage}}render(){const e=[],t=Math.max(this.props.totalPages-this.props.currentPage-1,0),a=Math.max(this.props.currentPage-2,0),p=Math.max(this.props.currentPage-Math.max(5-Number(this.props.currentPage!==this.props.totalPages)-t,2),2),u=Math.min(this.props.currentPage+Math.max(5-Number(1!==this.props.currentPage)-a,2),this.props.totalPages-1);for(let t=p;t<=u;t++)e.push(n.createElement(l.Z.Item,{key:t,active:t===this.props.currentPage,onClick:()=>this.props.selectPage(t)},t));const h=this.props.totalPages>7?n.createElement(l.Z.Ellipsis,{disabled:!0}):null,v=n.createElement(c.Z,{id:"popover-gotopage"},n.createElement(c.Z.Title,null,n.createElement(d.Z,{id:"generic.goto.title"})),n.createElement(c.Z.Content,null,n.createElement("form",{className:"d-flex",onSubmit:e=>{e.preventDefault(),this.props.selectPage(this.state.gotoValue),this.setState({showGoto:!1})}},n.createElement(i.Z.Control,{className:"mr-2",type:"number",min:1,max:this.props.totalPages,value:this.state.gotoValue,onChange:e=>this.setState({gotoValue:parseInt(e.target.value)}),custom:!0}),n.createElement(r.Z,{type:"submit"},n.createElement(d.Z,{id:"generic.goto"}))))),{selectPage:g,totalPages:E,currentPage:f,...P}=this.props;return n.createElement("div",m({className:"text-center",style:{position:"sticky",bottom:"1.5em"}},P),n.createElement(l.Z,{className:"justify-content-center"},n.createElement(l.Z.Prev,{disabled:this.props.currentPage<=1,onClick:()=>this.props.selectPage(Math.max(this.props.currentPage-1,1))}),n.createElement(l.Z.Item,{active:this.props.currentPage<=1,onClick:()=>this.props.selectPage(1)},"1"),h,e,h,this.props.totalPages>=2?n.createElement(l.Z.Item,{active:this.props.currentPage>=this.props.totalPages,onClick:()=>this.props.selectPage(this.props.totalPages)},this.props.totalPages):null,this.props.totalPages>7?n.createElement(o.Z,{show:this.state.showGoto,placement:"top",overlay:v},n.createElement(l.Z.Item,{onClick:()=>this.setState((e=>({showGoto:!e.showGoto})))},n.createElement(s.G,{icon:"search"}))):null,n.createElement(l.Z.Next,{disabled:this.props.currentPage>=this.props.totalPages,onClick:()=>this.props.selectPage(Math.min(this.props.currentPage+1,this.props.totalPages))})))}}},161:function(e,t,a){a.r(t);var s=a(7814),n=a(7294),r=a(5005),i=a(2258),o=a(4716),l=a(2318),c=a(5293),d=a(3489),m=a(4012),p=a(6222),u=a(8509),h=a(6846),v=a(3803),g=a(6190),E=a(6964),f=a(1320),P=a(3e3),Z=a(9635),b=a(8425),y=a(5855),x=a(9929);function w(){return w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},w.apply(this,arguments)}class N extends n.Component{constructor(e){super(e),this.state={versions:[],errors:[],activeVersion:"",latestVersion:"",selectedVersion:"",loading:!0,page:f.Mq.byondlistpage??1}}addError(e){this.setState((t=>{const a=Array.from(t.errors);return a.push(e),{errors:a}}))}async loadVersions(){if((0,E.n5)(this.context.instancePermissionSet,u.D8.ListInstalled)){const e=await p.Z.listAllVersions(this.context.instance.id,{page:this.state.page});if(e.code===v.G.OK){if(this.state.page>e.payload.totalPages&&0!==e.payload.totalPages)return void this.setState({page:1});this.setState({versions:e.payload.content,maxPage:e.payload.totalPages})}else this.addError(e.error)}if((0,E.n5)(this.context.instancePermissionSet,u.D8.ReadActive)){const e=await p.Z.getActiveVersion(this.context.instance.id);e.code===v.G.OK?this.setState({activeVersion:e.payload.version}):this.addError(e.error)}}async componentDidUpdate(e,t){t.page!==this.state.page&&(f.Mq.byondlistpage=this.state.page,await this.loadVersions())}async componentDidMount(){await this.loadVersions(),fetch("https://secure.byond.com/download/version.txt").then((e=>e.text())).then((e=>e.split("\n"))).then((e=>e[0])).then((e=>{this.setState({latestVersion:e,selectedVersion:e,loading:!1})})).catch((e=>{this.addError(new h.ZP(h.jK.APP_FAIL,{jsError:Error(e)})),this.setState({loading:!1})}))}render(){if(this.state.loading)return n.createElement(y.Z,{text:"loading.byond"});const e=(0,E.n5)(this.context.instancePermissionSet,u.D8.ListInstalled),t=(0,E.n5)(this.context.instancePermissionSet,u.D8.ReadActive),a=(0,E.n5)(this.context.instancePermissionSet,u.D8.InstallCustomVersion),h=(0,E.n5)(this.context.instancePermissionSet,u.D8.InstallOfficialOrChangeActiveVersion),g=e=>e?n.createElement(d.Z,{id:e},n.createElement(m.Z,{id:e})):n.createElement(n.Fragment,null);return n.createElement("div",{className:"text-center"},n.createElement(b.t,{obj:this.state.versions}),n.createElement("h1",null,n.createElement(m.Z,{id:"view.instance.byond"})),this.state.errors.map(((e,t)=>{if(e)return n.createElement(P.ZP,{key:t,error:e,onClose:()=>this.setState((e=>{const a=Array.from(e.errors);return a[t]=void 0,{errors:a}}))})})),e?n.createElement(n.Fragment,null,t?null:n.createElement(Z.Z,{title:"view.instance.byond.current_denied"}),n.createElement("div",{onChange:async e=>{this.setState({loading:!0});const t=await p.Z.switchActive(this.context.instance.id,e.target.value);t.code===v.G.OK?await this.loadVersions():this.addError(t.error),this.setState({loading:!1})}},this.state.versions.map((e=>n.createElement(l.Z,{className:"w-md-25 mb-1 mx-auto d-flex",key:e.version},h||t?n.createElement(l.Z.Prepend,null,n.createElement(l.Z.Radio,{name:"byond",id:e.version,value:e.version,disabled:!h,defaultChecked:e.version===this.state.activeVersion})):null,n.createElement("label",{className:"flex-grow-1 m-0",htmlFor:e.version},n.createElement(c.Z,{overlay:g("view.instance.byond.custom"),show:!e.version.endsWith(".0")&&void 0},(({ref:t,...a})=>n.createElement(l.Z.Text,w({className:"w-100"},a),e.version.endsWith(".0")?e.version.substr(0,e.version.length-2):e.version,e.version.endsWith(".0")?null:n.createElement("div",{className:"ml-auto",ref:t},n.createElement(s.G,{fixedWidth:!0,icon:"info"})))))))))),n.createElement(x.Z,{className:"mt-4",selectPage:e=>this.setState({page:e}),totalPages:this.state.maxPage??1,currentPage:this.state.page})):t?n.createElement(n.Fragment,null,n.createElement(Z.Z,{title:"view.instance.byond.list_denied"}),n.createElement(m.Z,{id:"view.instance.byond.current_version",values:{version:this.state.activeVersion}})):n.createElement(Z.Z,{title:"view.instance.byond.current_and_list_denied"}),n.createElement("hr",null),n.createElement("h4",null,n.createElement(m.Z,{id:"view.instance.byond.add"})),n.createElement(l.Z,{className:"w-md-50 w-lg-25 mb-3 mx-auto"},n.createElement(o.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[0],onChange:e=>{this.setState((t=>{const a=t.selectedVersion.split(".");return a[0]=e.target.value,{selectedVersion:a.join(".")}}))}}),n.createElement(l.Z.Text,{className:"rounded-0"},"."),n.createElement(o.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[1],onChange:e=>{this.setState((t=>{const a=t.selectedVersion.split(".");return a[1]=e.target.value,{selectedVersion:a.join(".")}}))}}),n.createElement(l.Z.Append,null,n.createElement(c.Z,{overlay:g("generic.no_perm"),show:!h&&void 0},n.createElement(r.Z,{variant:h?"success":"danger",disabled:!h,onClick:async()=>{this.setState({loading:!0});const e=await p.Z.switchActive(this.context.instance.id,this.state.selectedVersion,this.state.customFile?await this.state.customFile.arrayBuffer():void 0);e.code===v.G.ERROR?this.addError(e.error):(this.setState({customFile:null}),await this.loadVersions()),this.setState({loading:!1})}},n.createElement(s.G,{icon:"plus"}))))),n.createElement(i.Z,null,n.createElement(c.Z,{overlay:g("generic.no_perm"),show:!a&&void 0},n.createElement(i.Z.File,{custom:!0,id:"test",disabled:!a,className:"w-md-50 w-lg-25 text-left",label:this.state.customFile?this.state.customFile.name:n.createElement(m.Z,{id:"view.instance.byond.upload"}),accept:".zip",onChange:e=>{this.setState({customFile:e.target.files?e.target.files[0]:null})}}))))}}N.contextType=g.g,t.default=N},6190:function(e,t,a){a.d(t,{g:function(){return s}});const s=a(7294).createContext(void 0)},2318:function(e,t,a){var s=a(3366),n=a(7462),r=a(4184),i=a.n(r),o=a(7294),l=a(4680),c=a(6792),d=["bsPrefix","size","hasValidation","className","as"],m=(0,l.Z)("input-group-append"),p=(0,l.Z)("input-group-prepend"),u=(0,l.Z)("input-group-text",{Component:"span"}),h=o.forwardRef((function(e,t){var a=e.bsPrefix,r=e.size,l=e.hasValidation,m=e.className,p=e.as,u=void 0===p?"div":p,h=(0,s.Z)(e,d);return a=(0,c.vE)(a,"input-group"),o.createElement(u,(0,n.Z)({ref:t},h,{className:i()(m,a,r&&a+"-"+r,l&&"has-validation")}))}));h.displayName="InputGroup",h.Text=u,h.Radio=function(e){return o.createElement(u,null,o.createElement("input",(0,n.Z)({type:"radio"},e)))},h.Checkbox=function(e){return o.createElement(u,null,o.createElement("input",(0,n.Z)({type:"checkbox"},e)))},h.Append=m,h.Prepend=p,t.Z=h},8966:function(e,t,a){a.d(t,{Z:function(){return y}});var s=a(7462),n=a(3366),r=a(4184),i=a.n(r),o=a(7294),l=a(6792),c=a(8358),d=["active","disabled","className","style","activeLabel","children"],m=["children"],p=o.forwardRef((function(e,t){var a=e.active,r=e.disabled,l=e.className,m=e.style,p=e.activeLabel,u=e.children,h=(0,n.Z)(e,d),v=a||r?"span":c.Z;return o.createElement("li",{ref:t,style:m,className:i()(l,"page-item",{active:a,disabled:r})},o.createElement(v,(0,s.Z)({className:"page-link",disabled:r},h),u,a&&p&&o.createElement("span",{className:"sr-only"},p)))}));p.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},p.displayName="PageItem";var u=p;function h(e,t,a){function s(e){var s=e.children,r=(0,n.Z)(e,m);return o.createElement(p,r,o.createElement("span",{"aria-hidden":"true"},s||t),o.createElement("span",{className:"sr-only"},a))}return void 0===a&&(a=e),s.displayName=e,s}var v=h("First","\xab"),g=h("Prev","\u2039","Previous"),E=h("Ellipsis","\u2026","More"),f=h("Next","\u203a"),P=h("Last","\xbb"),Z=["bsPrefix","className","children","size"],b=o.forwardRef((function(e,t){var a=e.bsPrefix,r=e.className,c=e.children,d=e.size,m=(0,n.Z)(e,Z),p=(0,l.vE)(a,"pagination");return o.createElement("ul",(0,s.Z)({ref:t},m,{className:i()(r,p,d&&p+"-"+d)}),c)}));b.First=v,b.Prev=g,b.Ellipsis=E,b.Item=u,b.Next=f,b.Last=P;var y=b},9611:function(e,t,a){a.d(t,{Z:function(){return v}});var s=a(7462),n=a(3366),r=a(4184),i=a.n(r),o=a(7294),l=(a(5638),a(6792)),c=["as","bsPrefix","className","children"],d=o.forwardRef((function(e,t){var a=e.as,r=void 0===a?"div":a,d=e.bsPrefix,m=e.className,p=e.children,u=(0,n.Z)(e,c);return d=(0,l.vE)(d,"popover-header"),o.createElement(r,(0,s.Z)({ref:t},u,{className:i()(d,m)}),p)})),m=["as","bsPrefix","className","children"],p=o.forwardRef((function(e,t){var a=e.as,r=void 0===a?"div":a,c=e.bsPrefix,d=e.className,p=e.children,u=(0,n.Z)(e,m);return c=(0,l.vE)(c,"popover-body"),o.createElement(r,(0,s.Z)({ref:t},u,{className:i()(d,c)}),p)})),u=["bsPrefix","placement","className","style","children","content","arrowProps","popper","show"],h=o.forwardRef((function(e,t){var a=e.bsPrefix,r=e.placement,c=e.className,d=e.style,m=e.children,h=e.content,v=e.arrowProps,g=(e.popper,e.show,(0,n.Z)(e,u)),E=(0,l.vE)(a,"popover"),f=((null==r?void 0:r.split("-"))||[])[0];return o.createElement("div",(0,s.Z)({ref:t,role:"tooltip",style:d,"x-placement":f,className:i()(c,E,f&&"bs-popover-"+f)},g),o.createElement("div",(0,s.Z)({className:"arrow"},v)),h?o.createElement(p,null,m):m)}));h.defaultProps={placement:"right"},h.Title=d,h.Content=p;var v=h}}]);
//# sourceMappingURL=161.c0fc7728443ba34ea8a7.bundle.js.map