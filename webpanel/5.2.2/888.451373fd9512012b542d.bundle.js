"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[888],{86046:function(e,t,a){a.r(t);var n,s=a(67294),i=a(27977),r=a(35005),l=a(15293),c=a(43489),o=a(44012),d=a(74806),m=a(81249),u=a(7179),p=a(48509),f=a(53803),v=a(39521),g=a(96190),h=a(16964),b=a(93918),E=a(3e3),w=a(9635),S=a(79049),y=a(35619),Z=a(8425),N=a(35855);!function(e){e[e.None=0]="None",e[e.Stop=1]="Stop",e[e.Restart=2]="Restart"}(n||(n={})),t.default=(0,d.ZP)((function(e){const t=(0,s.useContext)(g.g),[a,d]=(0,s.useState)(),[P,R]=(0,s.useState)(!1),x=(0,s.useState)([]);async function C(){if(!(0,h.mg)(t.instancePermissionSet,p.py.ReadMetadata))return d({});const e=await u.Z.getWatchdogStatus(t.instance.id);e.code===f.G.ERROR?(0,E.iT)(x,e.error):d(e.payload)}async function k(e){R(!0);const a=await u.Z.updateWatchdogStatus(t.instance.id,e);a.code===f.G.ERROR&&(0,E.iT)(x,a.error),await C(),R(!1)}if((0,s.useEffect)((()=>{C()}),[t.instance.id]),!a)return s.createElement(s.Fragment,null,(0,E.hP)(x));if(P)return s.createElement(N.Z,null);const _={autoStart:{type:S.fS.Boolean,name:"fields.instance.watchdog.autostart",defaultValue:a.autoStart,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetAutoStart)},startProfiler:{type:S.fS.Boolean,name:"fields.instance.watchdog.autostartprofiler",defaultValue:a.startProfiler,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetProfiler)},logOutput:{type:S.fS.Boolean,name:"fields.instance.watchdog.logoutput",defaultValue:a.logOutput,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetLogOutput)},port:{type:S.fS.Number,name:"fields.instance.watchdog.port",defaultValue:a.port,min:0,max:65535,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetPort)},visibility:{type:S.fS.Enum,name:"fields.instance.watchdog.visibility",defaultValue:a.visibility,enum:p.Ye,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetVisibility)},securityLevel:{type:S.fS.Enum,name:"fields.instance.watchdog.securitylevel",defaultValue:a.securityLevel,enum:p.ns,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetSecurity)},startupTimeout:{type:S.fS.Number,name:"fields.instance.watchdog.timeout.startup",defaultValue:a.startupTimeout,min:0,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetStartupTimeout)},topicRequestTimeout:{type:S.fS.Number,name:"fields.instance.watchdog.timeout.topic",defaultValue:a.topicRequestTimeout,min:0,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetTopicTimeout)},healthCheckSeconds:{type:S.fS.Number,name:"fields.instance.watchdog.healthcheck",defaultValue:a.healthCheckSeconds,min:0,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetHealthCheckInterval)},dumpOnHealthCheckRestart:{type:S.fS.Boolean,name:"fields.instance.watchdog.dumpOnHealthCheckRestart",defaultValue:a.dumpOnHealthCheckRestart,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.CreateDump)},allowWebClient:{type:S.fS.Boolean,name:"fields.instance.watchdog.allowwebclient",defaultValue:a.allowWebClient,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetWebClient)},additionalParameters:{type:S.fS.String,name:"fields.instance.watchdog.additionalparams",defaultValue:a.additionalParameters,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetAdditionalParameters)},mapThreads:{type:S.fS.Number,name:"fields.instance.watchdog.mapthreads",defaultValue:a.mapThreads,disabled:!(0,h.mg)(t.instancePermissionSet,p.py.SetMapThreads)}},O=Object.values(_).some((e=>!e.disabled)),V=s.createElement(c.Z,{id:"generic.no_perm"},s.createElement(o.Z,{id:"generic.no_perm"})),T=(0,h.mg)(t.instancePermissionSet,p.py.Start),W=(0,h.mg)(t.instancePermissionSet,p.py.Shutdown),M=(0,h.mg)(t.instancePermissionSet,p.py.Restart),L=(0,h.mg)(t.instancePermissionSet,p.py.CreateDump),B=(0,h.mg)(t.instancePermissionSet,p.py.ReadMetadata),G=(0,h.mg)(t.instancePermissionSet,p.py.SoftShutdown)||(0,h.mg)(t.instancePermissionSet,p.py.SoftRestart),z=T||W||M||L,J=!(0,h.mg)(t.instancePermissionSet,p.py.BroadcastMessage)||B&&(a.status!==p.Ni.Online||null!=a.activeCompileJob?.dmApiVersion&&!(0,m.gte)(a.activeCompileJob?.dmApiVersion,"5.7.0")),A={message:{type:S.fS.String,name:"fields.instance.watchdog.broadcast",defaultValue:"",disabled:J,tooltip:"fields.instance.watchdog.broadcast.desc"}},D=(0,h.mg)(t.instancePermissionSet,p.py.ReadRevision);let I=null;return a&&(I={viewDataType:b.a.Watchdog,activeCompileJob:a.activeCompileJob,stagedCompileJob:a.stagedCompileJob}),s.createElement("div",{className:"text-center"},s.createElement(Z.t,{obj:a}),(0,E.hP)(x),s.createElement("h2",{className:"text-center"},s.createElement(o.Z,{id:"view.instance.server.status"}),s.createElement(i.Z,{pill:!0,variant:a.status===p.Ni.Online?"success":a.status===p.Ni.Offline?"danger":"warning"},s.createElement(o.Z,{id:`view.instance.server.status.${p.Ni[a.status]}`}))),s.createElement("hr",null),D?s.createElement(b.Z,{viewData:I}):s.createElement(w.Z,{title:"view.instance.no_compile_jobs"}),s.createElement("hr",null),s.createElement("h3",{className:"text-center"},s.createElement(o.Z,{id:"view.instance.server.settings"})),B?null:O?s.createElement(w.Z,{title:"view.instance.no_metadata"}):s.createElement(w.Z,{title:"view.instance.server.no_metadata_and_no_settings"}),s.createElement(y.Z,{fields:_,onSave:k,hideDisabled:!B}),s.createElement("hr",null),s.createElement("h3",{className:"text-center"},s.createElement(o.Z,{id:"view.instance.server.actions"})),z?s.createElement(s.Fragment,null,B?null:s.createElement(w.Z,{title:"view.instance.server.no_metadata_actions"}),s.createElement("div",{className:"text-center mb-3"},s.createElement(l.Z,{overlay:V,show:!T&&void 0},s.createElement(r.Z,{variant:"success",className:"mx-2",onClick:async function(){R(!0);const e=await u.Z.startWatchdog(t.instance.id);e.code===f.G.ERROR?(0,E.iT)(x,e.error):(v.Z.registerCallback(e.payload.id,(()=>{C()})),v.Z.fastmode=5,await C()),R(!1)},disabled:B&&a.status!=p.Ni.Offline||!T},s.createElement(o.Z,{id:"view.instance.server.start"}))),s.createElement(l.Z,{overlay:V,show:!W&&void 0},s.createElement(r.Z,{variant:"danger",className:"mx-2",onClick:async function(){if(!confirm(e.intl.formatMessage({id:"view.instance.server.prompt.stop"})))return;R(!0);const a=await u.Z.stopWatchdog(t.instance.id);a.code===f.G.ERROR?(0,E.iT)(x,a.error):await C(),R(!1)},disabled:B&&a.status==p.Ni.Offline||!W},s.createElement(o.Z,{id:"view.instance.server.stop"}))),s.createElement(l.Z,{overlay:V,show:!M&&void 0},s.createElement(r.Z,{variant:"warning",className:"mx-2",onClick:async function(){if(!confirm(e.intl.formatMessage({id:"view.instance.server.prompt.restart"})))return;R(!0);const a=await u.Z.restartWatchdog(t.instance.id);a.code===f.G.ERROR?(0,E.iT)(x,a.error):(v.Z.registerCallback(a.payload.id,(()=>{C()})),v.Z.fastmode=5,await C()),R(!1)},disabled:B&&a.status==p.Ni.Offline||!M},s.createElement(o.Z,{id:"view.instance.server.restart"}))),s.createElement(l.Z,{overlay:V,show:!L&&void 0},s.createElement(r.Z,{variant:"info",className:"mx-2",onClick:async function(){R(!0);const e=await u.Z.dumpWatchdog(t.instance.id);e.code===f.G.ERROR?(0,E.iT)(x,e.error):v.Z.fastmode=5,R(!1)},disabled:B&&a.status!=p.Ni.Online||!L},s.createElement(o.Z,{id:"view.instance.server.dump"}))))):s.createElement(w.Z,{title:"view.instance.server.no_actions"}),!B&&G?s.createElement(w.Z,{title:"view.instance.server.no_metadata_graceful"}):null,B||G?s.createElement("div",{className:"w-75 mx-auto"},s.createElement(S.ZP,{name:"view.instance.graceful",type:S.fS.Enum,enum:n,tooltip:"view.instance.graceful.desc",defaultValue:a.softRestart?n.Restart:a.softShutdown?n.Stop:n.None,disabled:!G,onChange:e=>{switch(e){case n.None:if(!a?.softRestart&&!a?.softShutdown)return;k({softShutdown:!a.softShutdown&&void 0,softRestart:!a.softRestart&&void 0});break;case n.Stop:if(a?.softShutdown)return;k({softShutdown:!0});break;case n.Restart:if(a?.softRestart)return;k({softRestart:!0})}}})):z?s.createElement(w.Z,{title:"view.instance.server.no_graceful"}):null,s.createElement("div",{className:"w-75 mx-auto"},s.createElement("br",null),s.createElement(y.Z,{fields:A,onSave:e=>{k({broadcastMessage:e.message})},saveMessageId:"view.instance.server.broadcast"})))}))},27977:function(e,t,a){var n=a(87462),s=a(63366),i=a(94184),r=a.n(i),l=a(67294),c=a(76792),o=["bsPrefix","variant","pill","className","as"],d=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.variant,d=e.pill,m=e.className,u=e.as,p=void 0===u?"span":u,f=(0,s.Z)(e,o),v=(0,c.vE)(a,"badge");return l.createElement(p,(0,n.Z)({ref:t},f,{className:r()(m,v,d&&v+"-pill",i&&v+"-"+i)}))}));d.displayName="Badge",d.defaultProps={pill:!1},t.Z=d},62318:function(e,t,a){var n=a(63366),s=a(87462),i=a(94184),r=a.n(i),l=a(67294),c=a(44680),o=a(76792),d=["bsPrefix","size","hasValidation","className","as"],m=(0,c.Z)("input-group-append"),u=(0,c.Z)("input-group-prepend"),p=(0,c.Z)("input-group-text",{Component:"span"}),f=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.size,c=e.hasValidation,m=e.className,u=e.as,p=void 0===u?"div":u,f=(0,n.Z)(e,d);return a=(0,o.vE)(a,"input-group"),l.createElement(p,(0,s.Z)({ref:t},f,{className:r()(m,a,i&&a+"-"+i,c&&"has-validation")}))}));f.displayName="InputGroup",f.Text=p,f.Radio=function(e){return l.createElement(p,null,l.createElement("input",(0,s.Z)({type:"radio"},e)))},f.Checkbox=function(e){return l.createElement(p,null,l.createElement("input",(0,s.Z)({type:"checkbox"},e)))},f.Append=m,f.Prepend=u,t.Z=f},38966:function(e,t,a){a.d(t,{Z:function(){return y}});var n=a(87462),s=a(63366),i=a(94184),r=a.n(i),l=a(67294),c=a(76792),o=a(48358),d=["active","disabled","className","style","activeLabel","children"],m=["children"],u=l.forwardRef((function(e,t){var a=e.active,i=e.disabled,c=e.className,m=e.style,u=e.activeLabel,p=e.children,f=(0,s.Z)(e,d),v=a||i?"span":o.Z;return l.createElement("li",{ref:t,style:m,className:r()(c,"page-item",{active:a,disabled:i})},l.createElement(v,(0,n.Z)({className:"page-link",disabled:i},f),p,a&&u&&l.createElement("span",{className:"sr-only"},u)))}));u.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},u.displayName="PageItem";var p=u;function f(e,t,a){function n(e){var n=e.children,i=(0,s.Z)(e,m);return l.createElement(u,i,l.createElement("span",{"aria-hidden":"true"},n||t),l.createElement("span",{className:"sr-only"},a))}return void 0===a&&(a=e),n.displayName=e,n}var v=f("First","\xab"),g=f("Prev","\u2039","Previous"),h=f("Ellipsis","\u2026","More"),b=f("Next","\u203a"),E=f("Last","\xbb"),w=["bsPrefix","className","children","size"],S=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.className,o=e.children,d=e.size,m=(0,s.Z)(e,w),u=(0,c.vE)(a,"pagination");return l.createElement("ul",(0,n.Z)({ref:t},m,{className:r()(i,u,d&&u+"-"+d)}),o)}));S.First=v,S.Prev=g,S.Ellipsis=h,S.Item=p,S.Next=b,S.Last=E;var y=S},19611:function(e,t,a){a.d(t,{Z:function(){return v}});var n=a(87462),s=a(63366),i=a(94184),r=a.n(i),l=a(67294),c=(a(55638),a(76792)),o=["as","bsPrefix","className","children"],d=l.forwardRef((function(e,t){var a=e.as,i=void 0===a?"div":a,d=e.bsPrefix,m=e.className,u=e.children,p=(0,s.Z)(e,o);return d=(0,c.vE)(d,"popover-header"),l.createElement(i,(0,n.Z)({ref:t},p,{className:r()(d,m)}),u)})),m=["as","bsPrefix","className","children"],u=l.forwardRef((function(e,t){var a=e.as,i=void 0===a?"div":a,o=e.bsPrefix,d=e.className,u=e.children,p=(0,s.Z)(e,m);return o=(0,c.vE)(o,"popover-body"),l.createElement(i,(0,n.Z)({ref:t},p,{className:r()(d,o)}),u)})),p=["bsPrefix","placement","className","style","children","content","arrowProps","popper","show"],f=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.placement,o=e.className,d=e.style,m=e.children,f=e.content,v=e.arrowProps,g=(e.popper,e.show,(0,s.Z)(e,p)),h=(0,c.vE)(a,"popover"),b=((null==i?void 0:i.split("-"))||[])[0];return l.createElement("div",(0,n.Z)({ref:t,role:"tooltip",style:d,"x-placement":b,className:r()(o,h,b&&"bs-popover-"+b)},g),l.createElement("div",(0,n.Z)({className:"arrow"},v)),f?l.createElement(u,null,m):m)}));f.defaultProps={placement:"right"},f.Title=d,f.Content=u;var v=f},75147:function(e,t,a){var n=a(87462),s=a(63366),i=a(94184),r=a.n(i),l=a(67294),c=a(76792),o=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],d=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.className,d=e.striped,m=e.bordered,u=e.borderless,p=e.hover,f=e.size,v=e.variant,g=e.responsive,h=(0,s.Z)(e,o),b=(0,c.vE)(a,"table"),E=r()(i,b,v&&b+"-"+v,f&&b+"-"+f,d&&b+"-striped",m&&b+"-bordered",u&&b+"-borderless",p&&b+"-hover"),w=l.createElement("table",(0,n.Z)({},h,{className:E,ref:t}));if(g){var S=b+"-responsive";return"string"==typeof g&&(S=S+"-"+g),l.createElement("div",{className:S},w)}return w}));t.Z=d}}]);
//# sourceMappingURL=888.451373fd9512012b542d.bundle.js.map