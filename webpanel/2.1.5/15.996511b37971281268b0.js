(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{345:function(t,e,r){"use strict";r.r(e);var a=r(0),n=r.n(a),s=r(37),o=r(138),i=r(74),c=r(71),u=r(17),l=r(59),d=r(7),p=r(3),h=r(9),f=r(46),m=r(72),y=r(55);function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e,r,a,n,s,o){try{var i=t[s](o),c=i.value}catch(t){return void r(t)}i.done?e(c):Promise.resolve(c).then(a,n)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(a,n){var s=t.apply(e,r);function o(t){E(s,a,n,o,i,"next",t)}function i(t){E(s,a,n,o,i,"throw",t)}o(void 0)}))}}function b(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function g(t,e){return(g=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function S(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,a=P(t);if(e){var n=P(this).constructor;r=Reflect.construct(a,arguments,n)}else r=a.apply(this,arguments);return O(this,r)}}function O(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?k(t):e}function k(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}e.default=Object(u.f)(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g(t,e)}(O,t);var e,r,a,u,w,E=S(O);function O(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,O),(e=E.call(this,t)).state={errors:[],password1:"",password2:"",loading:!0},e.submit=e.submit.bind(k(e)),e}return e=O,(r=[{key:"componentDidMount",value:(w=v((function*(){var t=yield h.a.getServerInfo();switch(t.code){case p.a.ERROR:this.addError(t.error);break;case p.a.OK:this.setState({serverInfo:t.payload})}var e=void 0,r=yield f.a.getCurrentUser();if(r.code!=p.a.OK)return this.setState({loading:!1}),this.addError(r.error);(e=this.props.match.params.id?parseInt(this.props.match.params.id):r.payload.id)===r.payload.id&&this.setState({currentUser:!0});var a=yield f.a.getUser(e);a.code==p.a.OK?this.setState({user:a.payload}):this.addError(a.error),this.setState({loading:!1})})),function(){return w.apply(this,arguments)})},{key:"addError",value:function(t){this.setState((function(e){var r=Array.from(e.errors);return r.push(t),{errors:r}}))}},{key:"submit",value:(u=v((function*(t){if(this.state.user){t.preventDefault();var e=!1;if(this.state.password1.length<this.state.serverInfo.minimumPasswordLength?(e=!0,this.setState({lengthError:!0})):this.setState({lengthError:!1}),this.state.password2!==this.state.password1?(e=!0,this.setState({matchError:!0})):this.setState({matchError:!1}),!e){this.setState({pwdload:!0});var r=yield f.a.editUser({password:this.state.password1,id:this.state.user.id});switch(r.code){case p.a.OK:this.state.currentUser&&h.a.login({type:l.a.Password,userName:this.state.user.name,password:this.state.password1}),this.props.history.goBack();break;case p.a.ERROR:this.addError(r.error),this.setState({pwdload:!1})}}}else this.addError(new d.c(d.b.APP_FAIL,{jsError:Error("changepassword submit: this.user is falsy")}))})),function(t){return u.apply(this,arguments)})},{key:"render",value:function(){var t=this;return this.state.loading?n.a.createElement(y.a,{text:"loading.info"}):this.state.pwdload?n.a.createElement(y.a,{text:"loading.passwd"}):n.a.createElement(i.a,{onSubmit:this.submit},n.a.createElement(o.a,{className:"mx-auto",lg:5,md:8},this.state.errors.map((function(e,r){if(e)return n.a.createElement(m.a,{key:r,error:e,onClose:function(){return t.setState((function(t){var e=Array.from(t.errors);return e[r]=void 0,{errors:e}}))}})})),this.state.user?n.a.createElement(n.a.Fragment,null,n.a.createElement("h3",null,n.a.createElement(c.a,{id:"view.user.passwd.title"}),this.state.user.name,"(",this.state.user.id,")"),n.a.createElement("hr",null),n.a.createElement(i.a.Group,{controlId:"password1"},n.a.createElement(i.a.Label,null,n.a.createElement(c.a,{id:"login.password"})),n.a.createElement(i.a.Control,{type:"password",onChange:function(e){return t.setState({password1:e.target.value})},value:this.state.password1,isInvalid:this.state.matchError||this.state.lengthError}),n.a.createElement(i.a.Control.Feedback,{type:"invalid"},this.state.lengthError?n.a.createElement(n.a.Fragment,null,n.a.createElement(c.a,{id:"login.password.repeat.short"}),this.state.serverInfo.minimumPasswordLength):"")),n.a.createElement(i.a.Group,{controlId:"password2"},n.a.createElement(i.a.Label,null,n.a.createElement(c.a,{id:"login.password.repeat"})),n.a.createElement(i.a.Control,{type:"password",onChange:function(e){return t.setState({password2:e.target.value})},value:this.state.password2,isInvalid:this.state.matchError||this.state.lengthError}),n.a.createElement(i.a.Control.Feedback,{type:"invalid"},this.state.matchError?n.a.createElement(c.a,{id:"login.password.repeat.match"}):"")),n.a.createElement(s.a,{type:"submit"},n.a.createElement(c.a,{id:"routes.passwd"}))):""))}}])&&b(e.prototype,r),a&&b(e,a),O}(n.a.Component))}}]);
//# sourceMappingURL=15.996511b37971281268b0.js.map