(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[12],{59012:function(e,t,n){"use strict";n.r(t);var r=n(67814),o=n(67294),i=n(35005),a=n(32258),s=n(94716),c=n(62318),l=n(86828),u=n(43489),f=n(44012),d=n(91201),p=n(48155),m=n(36800),v=n(38592),h=n(49896),y=n(3652),b=n(43307),g=n(71739);function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function w(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){w(i,r,o,a,s,"next",e)}function s(e){w(i,r,o,a,s,"throw",e)}a(void 0)}))}}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e,t){return!t||"object"!==E(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(R,e);var t,n,h,E,w,j,k=(w=R,j=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(w);if(j){var n=P(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return V(this,e)});function R(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,R),(t=k.call(this,e)).state={versions:[],errors:[],activeVersion:"",latestVersion:"",selectedVersion:"",loading:!0},t}return t=R,(n=[{key:"addError",value:function(e){this.setState((function(t){var n=Array.from(t.errors);return n.push(e),{errors:n}}))}},{key:"loadVersions",value:(E=x((function*(){var e=yield d.Z.listAllVersions(this.context.instance.id);if(e.code===v.G.OK){this.setState({versions:e.payload.content});var t=yield d.Z.getActiveVersion(this.context.instance.id);t.code===v.G.OK?this.setState({activeVersion:t.payload.version}):this.addError(t.error)}else this.addError(e.error)})),function(){return E.apply(this,arguments)})},{key:"componentDidMount",value:(h=x((function*(){var e=this;yield this.loadVersions(),fetch("https://secure.byond.com/download/version.txt").then((function(e){return e.text()})).then((function(e){return e.split("\n")})).then((function(e){return e[0]})).then((function(t){e.setState({latestVersion:t,selectedVersion:t,loading:!1})})).catch((function(t){e.addError(new m.ZP(m.jK.APP_FAIL,{jsError:Error(t)})),e.setState({loading:!1})}))})),function(){return h.apply(this,arguments)})},{key:"render",value:function(){var e=this;return this.state.loading?o.createElement(g.Z,{text:"loading.instance"}):this.context.instancePermissionSet.byondRights&p.D8.ListInstalled&&this.context.instancePermissionSet.byondRights&p.D8.ReadActive?o.createElement("div",{className:"text-center"},o.createElement("h1",null,o.createElement(f.Z,{id:"view.instance.hosting.byond"})),this.state.errors.map((function(t,n){if(t)return o.createElement(b.Z,{key:n,error:t,onClose:function(){return e.setState((function(e){var t=Array.from(e.errors);return t[n]=void 0,{errors:t}}))}})})),o.createElement("div",{onChange:function(){var t=x((function*(t){e.setState({loading:!0});var n=yield d.Z.switchActive(e.context.instance.id,t.target.value);n.code===v.G.OK?yield e.loadVersions():e.addError(n.error),e.setState({loading:!1})}));return function(e){return t.apply(this,arguments)}}()},this.state.versions.map((function(t){return o.createElement(c.Z,{className:"w-md-25 mb-1 mx-auto d-flex",key:t.version},o.createElement(c.Z.Prepend,null,o.createElement(c.Z.Radio,{disabled:!(e.context.instancePermissionSet.byondRights&p.D8.InstallOfficialOrChangeActiveVersion),name:"byond",id:t.version,value:t.version,defaultChecked:t.version===e.state.activeVersion})),o.createElement(c.Z.Append,{className:"flex-grow-1 m-0",as:"label",htmlFor:t.version},o.createElement(l.Z,{overlay:(n="view.instance.hosting.byond.custom",o.createElement(u.Z,{id:n},o.createElement(f.Z,{id:n}))),show:!t.version.endsWith(".0")&&void 0},(function(e){var n=e.ref,i=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,["ref"]);return o.createElement(c.Z.Text,Z({className:"w-100"},i),t.version.endsWith(".0")?t.version.substr(0,t.version.length-2):t.version,t.version.endsWith(".0")?null:o.createElement("div",{className:"ml-auto",ref:n},o.createElement(r.G,{fixedWidth:!0,icon:"info"})))}))));var n}))),o.createElement("hr",null),o.createElement("h4",null,o.createElement(f.Z,{id:"view.instance.hosting.byond.add"})),o.createElement(c.Z,{className:"w-md-50 w-lg-25 mb-3 mx-auto"},o.createElement(s.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[0],onChange:function(t){e.setState((function(e){var n=e.selectedVersion.split(".");return n[0]=t.target.value,{selectedVersion:n.join(".")}}))}}),o.createElement(c.Z.Text,{className:"rounded-0"},"."),o.createElement(s.Z,{type:"number",defaultValue:this.state.latestVersion.split(".")[1],onChange:function(t){e.setState((function(e){var n=e.selectedVersion.split(".");return n[1]=t.target.value,{selectedVersion:n.join(".")}}))}}),o.createElement(c.Z.Append,null,o.createElement(i.Z,{variant:"success",onClick:x((function*(){e.setState({loading:!0});var t=yield d.Z.switchActive(e.context.instance.id,e.state.selectedVersion,e.state.customFile?yield e.state.customFile.arrayBuffer():void 0);t.code===v.G.ERROR?e.addError(t.error):(e.setState({customFile:null}),yield e.loadVersions()),e.setState({loading:!1})}))},o.createElement(r.G,{icon:"plus"})))),o.createElement(a.Z,null,o.createElement(a.Z.File,{custom:!0,id:"test",className:"w-md-50 w-lg-25 text-left",label:this.state.customFile?this.state.customFile.name:o.createElement(f.Z,{id:"view.instance.hosting.byond.upload"}),accept:".zip",onChange:function(t){e.setState({customFile:t.target.files?t.target.files[0]:null})}}))):o.createElement(y.Z,null)}}])&&O(t.prototype,n),R}(o.Component);j.contextType=h.g,t.default=j},49896:function(e,t,n){"use strict";n.d(t,{g:function(){return r}});var r=n(67294).createContext(void 0)},62318:function(e,t,n){"use strict";var r=n(19756),o=n(22122),i=n(94184),a=n.n(i),s=n(67294),c=n(44680),l=n(76792),u=(0,c.Z)("input-group-append"),f=(0,c.Z)("input-group-prepend"),d=(0,c.Z)("input-group-text",{Component:"span"}),p=s.forwardRef((function(e,t){var n=e.bsPrefix,i=e.size,c=e.className,u=e.as,f=void 0===u?"div":u,d=(0,r.Z)(e,["bsPrefix","size","className","as"]);return n=(0,l.vE)(n,"input-group"),s.createElement(f,(0,o.Z)({ref:t},d,{className:a()(c,n,i&&n+"-"+i)}))}));p.displayName="InputGroup";var m=(0,o.Z)({},p,{Text:d,Radio:function(e){return s.createElement(d,null,s.createElement("input",(0,o.Z)({type:"radio"},e)))},Checkbox:function(e){return s.createElement(d,null,s.createElement("input",(0,o.Z)({type:"checkbox"},e)))},Append:u,Prepend:f});t.Z=m}}]);
//# sourceMappingURL=12.5419d7441679add45c63.js.map