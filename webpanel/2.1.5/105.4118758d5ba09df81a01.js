(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[105],{90105:function(e,t,r){"use strict";r.r(t);var n=r(67294),a=r(35005),o=r(10682),c=r(86828),l=r(75147),i=r(43489),s=r(44012),u=r(48272),d=r(41153),m=r(73727),f=r(34820),p=r(36800),h=r(38592),y=r(42540),v=r(3429),E=r(43307),g=r(71739);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t,r,n,a,o,c){try{var l=e[o](c),i=l.value}catch(e){return void r(e)}l.done?t(i):Promise.resolve(i).then(n,a)}function Z(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function c(e){w(o,n,a,c,l,"next",e)}function l(e){w(o,n,a,c,l,"throw",e)}c(void 0)}))}}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function O(e,t){return(O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}t.default=(0,d.EN)(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&O(e,t)}(S,e);var t,r,d,b,w,N,P=(w=S,N=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=_(w);if(N){var r=_(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return R(this,e)});function S(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,S),(t=P.call(this,e)).state={errors:[],loading:!0,logs:[]},t}return t=S,(r=[{key:"componentDidMount",value:(b=Z((function*(){var e=this.props.match.params.name;if(e){var t=yield f.Z.getLog(e);switch(t.code){case h.G.OK:for(var r,n=RegExp(/(\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{7}[-+]\d{2}:\d{2})\s+(.*?)(?=(?:\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{7}[-+]\d{2}:\d{2}|$))/,"gs"),a=[];null!==(r=n.exec(t.payload.content));)a.push({time:r[1],content:r[2]});this.setState({viewedLog:{logFile:t.payload,entries:a}});break;case h.G.ERROR:this.addError(t.error)}}var o=yield f.Z.getLogs();switch(o.code){case h.G.OK:this.setState({logs:o.payload});break;case h.G.ERROR:this.addError(o.error)}this.setState({loading:!1})})),function(){return b.apply(this,arguments)})},{key:"addError",value:function(e){this.setState((function(t){var r=Array.from(t.errors);return r.push(e),{errors:r}}))}},{key:"downloadLog",value:(d=Z((function*(e){var t=yield f.Z.getLog(e);switch(t.code){case h.G.OK:(0,y.LR)(e,t.payload.content);break;case h.G.ERROR:this.addError(t.error)}})),function(e){return d.apply(this,arguments)})},{key:"render",value:function(){var e=this;return n.createElement("div",{className:"text-center"},this.state.errors.map((function(t,r){if(t)return n.createElement(E.Z,{key:r,error:t,onClose:function(){return e.setState((function(e){var t=Array.from(e.errors);return t[r]=void 0,{errors:t}}))}})})),this.state.loading?n.createElement(g.Z,{text:"loading.logs"}):this.props.match.params.name&&this.state.viewedLog?n.createElement("div",{className:"mx-5 mt-5"},n.createElement("h3",null,this.props.match.params.name),n.createElement(a.Z,{className:"mr-1",as:m.rU,to:v.$w.admin_logs.link||v.$w.admin_logs.route},n.createElement(s.Z,{id:"generic.goback"})),n.createElement(a.Z,{onClick:function(){(0,y.LR)(e.props.match.params.name,e.state.viewedLog.logFile.content)}},n.createElement(s.Z,{id:"generic.download"})),n.createElement("hr",null),n.createElement("div",{style:{height:"60vh",display:"block"},className:"table-responsive"},n.createElement(l.Z,{striped:!0,hover:!0,variant:"dark",className:"text-left"},n.createElement("thead",{className:"bg-dark",style:{position:"sticky",top:0}},n.createElement("th",null,n.createElement(s.Z,{id:"generic.datetime"})),n.createElement("th",null,n.createElement(s.Z,{id:"generic.entry"}))),n.createElement("tbody",null,this.state.viewedLog.entries.map((function(e){return n.createElement("tr",{key:e.time},n.createElement("td",{className:"py-1"},e.time),n.createElement("td",{className:"py-1"},n.createElement("pre",{className:"mb-0"},e.content)))})))))):n.createElement(o.Z,{className:"mt-5 mb-5"},n.createElement(l.Z,{striped:!0,bordered:!0,hover:!0,variant:"dark",responsive:!0},n.createElement("thead",null,n.createElement("tr",null,n.createElement("th",null,"#"),n.createElement("th",null,n.createElement(s.Z,{id:"generic.name"})),n.createElement("th",null,n.createElement(s.Z,{id:"generic.datetime"})),n.createElement("th",null,n.createElement(s.Z,{id:"generic.action"})))),n.createElement("tbody",null,this.state.logs.map((function(t,r){var o=new Date(t.lastModified),l=(o.getTime()-Date.now())/1e3;return n.createElement("tr",{key:t.name},n.createElement("td",null,r),n.createElement("td",null,t.name),n.createElement(c.Z,{overlay:n.createElement(i.Z,{id:"".concat(t.name,"-tooltip")},o.toLocaleString())},(function(e){var t=e.ref,r=function(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}(e,["ref"]);return n.createElement("td",r,n.createElement("span",{ref:t},n.createElement(u.Z,{value:l,numeric:"auto",updateIntervalInSeconds:1})))})),n.createElement("td",{className:"align-middle p-0"},n.createElement(a.Z,{className:"mr-1",onClick:function(){e.props.history.push((v.$w.admin_logs.link||v.$w.admin_logs.route)+t.name+"/",{reload:!0})}},n.createElement(s.Z,{id:"generic.view"})),n.createElement(a.Z,{onClick:function(){e.downloadLog(t.name).catch((function(t){e.addError(new p.ZP(p.jK.APP_FAIL,{jsError:t}))}))}},n.createElement(s.Z,{id:"generic.download"}))))}))))))}}])&&k(t.prototype,r),S}(n.Component))},75147:function(e,t,r){"use strict";var n=r(22122),a=r(19756),o=r(94184),c=r.n(o),l=r(67294),i=r(76792),s=l.forwardRef((function(e,t){var r=e.bsPrefix,o=e.className,s=e.striped,u=e.bordered,d=e.borderless,m=e.hover,f=e.size,p=e.variant,h=e.responsive,y=(0,a.Z)(e,["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"]),v=(0,i.vE)(r,"table"),E=c()(o,v,p&&v+"-"+p,f&&v+"-"+f,s&&v+"-striped",u&&v+"-bordered",d&&v+"-borderless",m&&v+"-hover"),g=l.createElement("table",(0,n.Z)({},y,{className:E,ref:t}));if(h){var b=v+"-responsive";return"string"==typeof h&&(b=b+"-"+h),l.createElement("div",{className:b},g)}return g}));t.Z=s}}]);
//# sourceMappingURL=105.4118758d5ba09df81a01.js.map