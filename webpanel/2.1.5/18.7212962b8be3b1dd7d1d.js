(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{387:function(e,t,n){"use strict";n.r(t);var r=n(245),a=n(59),o=n(0),i=n.n(o),c=n(747),s=n(33),l=n(91),u=n(746),f=n(92),p=n(80),m=n(13),d=n(10),h=n(97),y=n(77),g=n(5),v=n(2),b=n(71),E=n(36),P=n(19),O=n(58),w=n(49),S=n(81),j=n(760),k=n(759);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var a=A(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _(this,n)}}function _(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(c,e);var t,n,r,o=N(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).state={showGoto:!1,gotoValue:e.currentPage},t}return t=c,(n=[{key:"render",value:function(){for(var e=this,t=[],n=Math.max(this.props.totalPages-this.props.currentPage-1,0),r=Math.max(this.props.currentPage-2,0),o=Math.max(this.props.currentPage-Math.max(5-Number(this.props.currentPage!==this.props.totalPages)-n,2),2),c=Math.min(this.props.currentPage+Math.max(5-Number(1!==this.props.currentPage)-r,2),this.props.totalPages-1),u=function(n){t.push(i.a.createElement(j.a.Item,{active:n===e.props.currentPage,onClick:function(){return e.props.selectPage(n)}},n))},f=o;f<=c;f++)u(f);var m=this.props.totalPages>7?i.a.createElement(j.a.Ellipsis,{disabled:!0}):null,d=i.a.createElement(k.a,{id:"popover-gotopage"},i.a.createElement(k.a.Title,null,i.a.createElement(p.a,{id:"generic.goto.title"})),i.a.createElement(k.a.Content,null,i.a.createElement("form",{className:"d-flex",onSubmit:function(t){t.preventDefault(),e.props.selectPage(e.state.gotoValue),e.setState({showGoto:!1})}},i.a.createElement(S.a.Control,{className:"mr-2",type:"number",min:1,max:this.props.totalPages,value:this.state.gotoValue,onChange:function(t){return e.setState({gotoValue:parseInt(t.target.value)})},custom:!0}),i.a.createElement(s.a,{type:"submit"},i.a.createElement(p.a,{id:"generic.goto"})))));return i.a.createElement("div",{className:"text-center"},i.a.createElement(j.a,{className:"justify-content-center"},i.a.createElement(j.a.Prev,{disabled:1===this.props.currentPage,onClick:function(){return e.props.selectPage(Math.max(e.props.currentPage-1,1))}}),i.a.createElement(j.a.Item,{active:1===this.props.currentPage,onClick:function(){return e.props.selectPage(1)}},"1"),m,t,m,this.props.totalPages>=2?i.a.createElement(j.a.Item,{active:this.props.currentPage===this.props.totalPages,onClick:function(){return e.props.selectPage(e.props.totalPages)}},this.props.totalPages):null,this.props.totalPages>7?i.a.createElement(l.a,{show:this.state.showGoto,placement:"top",overlay:d},i.a.createElement(j.a.Item,{onClick:function(){return e.setState((function(e){return{showGoto:!e.showGoto}}))}},i.a.createElement(a.a,{icon:"search"}))):null,i.a.createElement(j.a.Next,{disabled:this.props.currentPage===this.props.totalPages,onClick:function(){return e.props.selectPage(Math.min(e.props.currentPage+1,e.props.totalPages))}})))}}])&&C(t.prototype,n),r&&C(t,r),c}(i.a.PureComponent);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function D(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function G(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V(e,t,n,r,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,a)}function J(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){V(o,r,a,i,c,"next",e)}function c(e){V(o,r,a,i,c,"throw",e)}i(void 0)}))}}function K(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=z(e);if(t){var a=z(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return $(this,n)}}function $(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?q(e):t}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var F=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(x,e);var t,n,o,m,b,S,j,k=H(x);function x(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,x),(t=k.call(this,e)).setOnline=t.setOnline.bind(q(t)),t.state={loading:!0,instances:[],errors:[],page:P.c.instancelistpage||1},t}return t=x,(n=[{key:"addError",value:function(e){this.setState((function(t){var n=Array.from(t.errors);return n.push(e),{errors:n}}))}},{key:"componentDidUpdate",value:(j=J((function*(e,t){t.page!==this.state.page&&(P.c.instancelistpage=this.state.page,yield this.loadInstances())})),function(e,t){return j.apply(this,arguments)})},{key:"loadInstances",value:(S=J((function*(){var e=this;this.setState({loading:!0});var t=yield h.a.listInstances({page:this.state.page}),n=[];if(t.code==v.a.OK){if(t.payload.totalPages<this.state.page)return void this.setState({page:1});var r,a=[],o=G(t.payload.content);try{var i=function(){var t=r.value,o=t;t.online?a.push(y.a.getCurrentInstancePermissionSet(t.id).then((function(t){t.code==v.a.OK?o.canAccess=!0:(o.canAccess=!1,t.error.code!==g.b.HTTP_ACCESS_DENIED&&e.addError(t.error)),n.push(o)}))):(o.canAccess=!1,n.push(o))};for(o.s();!(r=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}yield Promise.all(a),this.setState({instances:n.sort((function(e,t){return e.id-t.id})),maxPage:t.payload.totalPages})}else this.addError(t.error);this.setState({loading:!1})})),function(){return S.apply(this,arguments)})},{key:"componentDidMount",value:(b=J((function*(){yield this.loadInstances()})),function(){return b.apply(this,arguments)})},{key:"setOnline",value:(m=J((function*(e){var t=!e.online,n=yield h.a.editInstance({id:e.id,online:t});n.code===v.a.OK?yield this.loadInstances():this.addError(n.error)})),function(e){return m.apply(this,arguments)})},{key:"render",value:function(){var e=this;if(this.state.loading)return i.a.createElement(w.a,{text:"loading.instance.list"});var t=!!(Object(E.d)(this.context.user).instanceManagerRights&d.e.SetOnline),n={verticalAlign:"middle"};return i.a.createElement("div",{className:"text-center"},this.state.errors.map((function(t,n){if(t)return i.a.createElement(O.a,{key:n,error:t,onClose:function(){return e.setState((function(e){var t=Array.from(e.errors);return t[n]=void 0,{errors:t}}))}})})),i.a.createElement("h3",null,i.a.createElement(p.a,{id:"view.instance.list.title"})),i.a.createElement(u.a,{striped:!0,bordered:!0,hover:!0,variant:"dark",responsive:!0,className:"mb-4"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"#"),i.a.createElement("th",null,i.a.createElement(p.a,{id:"generic.name"})),i.a.createElement("th",null,i.a.createElement(p.a,{id:"generic.online"})),i.a.createElement("th",null,i.a.createElement(p.a,{id:"generic.path"})),i.a.createElement("th",null,i.a.createElement(p.a,{id:"generic.configmode"})),i.a.createElement("th",null,i.a.createElement(p.a,{id:"generic.action"})))),i.a.createElement("tbody",null,this.state.instances.map((function(r){return i.a.createElement("tr",{key:r.id},i.a.createElement("td",{style:n},r.id),i.a.createElement("td",{style:n},r.name),i.a.createElement("td",{style:n},r.online?i.a.createElement(c.a,{variant:"success"},i.a.createElement(p.a,{id:"generic.online"})):i.a.createElement(c.a,{variant:"danger"},i.a.createElement(p.a,{id:"generic.offline"}))),i.a.createElement("td",{style:n},r.moveJob?i.a.createElement(p.a,{id:"view.instance.moving"}):r.path),i.a.createElement("td",{style:n},i.a.createElement(p.a,{id:"view.instance.configmode.".concat(r.configurationType.toString())})),i.a.createElement("td",{className:"align-middle p-1",style:n},i.a.createElement(s.a,{className:"mx-1",onClick:function(){P.c.selectedinstanceid=r.id,e.props.history.push(P.b.instanceedit.link||P.b.instanceedit.route)},disabled:!r.canAccess},i.a.createElement(p.a,{id:"generic.edit"})),i.a.createElement(s.a,{className:"mx-1",variant:r.online?"danger":"success",onClick:function(){return e.setOnline(r)},disabled:!t},i.a.createElement(p.a,{id:"view.instance.list.set.".concat(r.online?"offline":"online")}))))})))),i.a.createElement(R,{selectPage:function(t){return e.setState({page:t})},totalPages:this.state.maxPage||1,currentPage:this.state.page}),i.a.createElement("div",{className:"align-middle"},i.a.createElement("div",{className:"mb-4"},this.renderAddInstance()),i.a.createElement(s.a,{className:"mx-1",onClick:function(){e.props.history.push(P.b.instancejobs.link||P.b.instancejobs.route)}},i.a.createElement(p.a,{id:"routes.instancejobs"}))))}},{key:"renderAddInstance",value:function(){var e=this,t=!!(Object(E.d)(this.context.user).instanceManagerRights&d.e.Create);return i.a.createElement(l.a,{overlay:i.a.createElement(f.a,{id:"create-instance-tooltip"},i.a.createElement(p.a,{id:"perms.instance.create.warning"})),show:!t&&void 0},(function(n){var o=n.ref,c=D(n,["ref"]);return i.a.createElement(s.a,T({ref:o,className:"mx-1",variant:"success",onClick:function(){e.props.history.push(P.b.instancecreate.link||P.b.instancecreate.route)},disabled:!t},c),i.a.createElement("div",null,i.a.createElement(a.a,{className:"mr-2",icon:r.faPlus}),i.a.createElement(p.a,{id:"routes.instancecreate"})))}))}}])&&K(t.prototype,n),o&&K(t,o),x}(i.a.Component);F.contextType=b.a;t.default=Object(m.f)(F)}}]);
//# sourceMappingURL=18.7212962b8be3b1dd7d1d.js.map